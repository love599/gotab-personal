import{r as e,c as s,h as n,t as a,j as t,a2 as o,B as l,l as i,W as r,o as c,v as d,n as m,X as f,b5 as u,K as x,bo as h,S as j,V as p,u as b,d as g,m as y,eo as v,ep as k,eq as C,E as S,bP as _,Q as N,bC as w,er as E,es as I,et as D,eu as T,ev as B,ew as L,ex as M,ey as P,bX as A,ez as F,eA as z,eB as H,eC as Y,F as $}from"./requestIdleCallbackPolyfill-CVD_37F6.js";import{L as K,E as R}from"./index-DcfMndBI.js";import{F as q}from"./fullSpin-ncMMW_DO.js";import"./Overflow-D57B_Btp.js";import"./getAllowClear-CG1WH6yx.js";import"./Input-DNytczHm.js";import"./index-Ds8dCkvV.js";function G(e){200===e.code&&e.data&&!x(e.data)&&(h(e.data,!1),setTimeout(W,0))}function W(){j.hide(p)}function X(e){return e.user.token}const O=e.memo(function(){const x=s.c(19),h=n(X),{token:j}=a.useToken();let p;x[0]===Symbol.for("react.memo_cache_sentinel")?(p=[],x[0]=p):p=x[0];const[b,g]=e.useState(p);let y;x[1]===Symbol.for("react.memo_cache_sentinel")?(y=[],x[1]=y):y=x[1];const[v,k]=e.useState(y);let C;x[2]===Symbol.for("react.memo_cache_sentinel")?(C=[],x[2]=C):C=x[2];const[S,_]=e.useState(C);let N;x[3]!==h?(N=function(e){i(e?0:1,g),r({url:c.getBackupList,token:h}).then(e=>{200===e.code&&e.data&&_(e.data)}).finally(()=>{d(e?0:1,g)})},x[3]=h,x[4]=N):N=x[4];const w=N;let E;x[5]!==h?(E=function(e,s){i(e,k),m({url:c.getBackupData,token:h,data:{backupId:s}}).then(G).finally(()=>{d(e,k)})},x[5]=h,x[6]=E):E=x[6];const I=E;let D,T,B,L;return x[7]!==w?(D=()=>{w(!0)},x[7]=w,x[8]=D):D=x[8],x[9]===Symbol.for("react.memo_cache_sentinel")?(T=[],x[9]=T):T=x[9],e.useLayoutEffect(D,T),x[10]===Symbol.for("react.memo_cache_sentinel")?(B=t.jsx(f,{className:"rounded-md mb-2",message:"请您注意，云端仅保存10条数据节点！恢复云端数据后将再次上传数据至云端，以确保数据是最新状态！",banner:!0,type:"info",icon:t.jsx(u,{})}),x[10]=B):B=x[10],x[11]!==S||x[12]!==I||x[13]!==v||x[14]!==w||x[15]!==b[0]||x[16]!==b[1]||x[17]!==j?(L=t.jsxs("div",{className:"min-h-[396px] flex flex-col",children:[B,b[0]?t.jsx(q,{className:"h-[280px]"}):S?.length>0?t.jsxs(t.Fragment,{children:[b[1]?t.jsx(q,{className:"h-[280px]"}):t.jsx(K,{data:S,height:280,itemHeight:56,styles:{verticalScrollBar:{display:"none"}},itemKey:"backupId",children:(e,s)=>t.jsxs("div",{className:"h-14 border-b py-3 flex items-center",style:{borderColor:j.colorBorderSecondary},children:[t.jsxs("p",{children:["云端节点：",e.dataTime]}),t.jsx("div",{className:"flex justify-end flex-1",children:t.jsx(o,{title:"是否确认恢复？",onConfirm:()=>{I(s,e.backupId)},children:t.jsx(l,{size:"small",type:"link",loading:v[s],children:"恢复"})})})]},e.backupId)}),t.jsx("div",{className:"flex flex-wrap justify-end mt-4",children:t.jsx(l,{type:"primary",loading:b[1],onClick:()=>{w(!1)},children:"刷新一下"})})]}):t.jsx("div",{className:"h-full flex-center",children:t.jsx(R,{image:R.PRESENTED_IMAGE_SIMPLE})})]}),x[11]=S,x[12]=I,x[13]=v,x[14]=w,x[15]=b[0],x[16]=b[1],x[17]=j,x[18]=L):L=x[18],L});function Q(e){return e.user.userInfo}function U(e){return e.history.history}const V=e.memo(function(){const i=s.c(12),r=b(),{token:c}=a.useToken(),d=n(U),m=n(Q);let x,j,p,_;return i[0]!==r||i[1]!==d.length||i[2]!==m?(x=()=>{0===d.length&&r(C({data:S(),timestamp:Date.now(),userId:m.userId||""}))},i[0]=r,i[1]=d.length,i[2]=m,i[3]=x):x=i[3],i[4]!==d?(j=[d],i[4]=d,i[5]=j):j=i[5],e.useEffect(x,j),i[6]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsx(f,{className:"rounded-md mb-2",message:"请您注意，本地记录仅保存20条数据节点！",banner:!0,type:"info",icon:t.jsx(u,{})}),i[6]=p):p=i[6],i[7]!==r||i[8]!==d||i[9]!==c||i[10]!==m?(_=t.jsxs("div",{className:"h-[374px] flex flex-col",children:[p,d.length>0?t.jsxs(t.Fragment,{children:[t.jsx(K,{data:d,height:280,itemHeight:56,styles:{verticalScrollBar:{display:"none"}},itemKey:"timestamp",children:(e,s)=>t.jsxs("div",{className:"h-14 border-b py-3 flex items-center",style:{borderColor:c.colorBorderSecondary},children:[t.jsxs("p",{children:[0===s?"当前节点：":"历史节点：",g(e.timestamp).format("YYYY-MM-DD HH:mm:ss")]}),0!==s?t.jsxs("div",{className:"flex justify-end flex-1",children:[t.jsx(o,{title:"是否确认恢复？",onConfirm:()=>{if(d[s].userId)if(d[s].userId===m.userId){const e=d[s].data;h(e,!1),y.success("恢复成功")}else y.error("该条记录非您所有，禁止恢复");else{const e=d[s].data;h(e,!1),y.success("恢复成功")}},children:t.jsx(l,{size:"small",type:"link",children:"恢复"})}),t.jsx(o,{title:"是否确认删除？",onConfirm:()=>{r(v(s+1)),y.success("删除成功")},children:t.jsx(l,{danger:!0,size:"small",type:"link",children:"删除"})})]}):null]},e.timestamp)}),t.jsx("div",{className:"flex flex-wrap justify-end mt-4",children:t.jsx(o,{title:"是否确认清空？",onConfirm:()=>{r(k()),y.success("清空成功")},children:t.jsx(l,{danger:!0,children:"清空数据"})})})]}):t.jsx("div",{className:"h-full flex-center",children:t.jsx(R,{image:R.PRESENTED_IMAGE_SIMPLE})})]}),i[7]=r,i[8]=d,i[9]=c,i[10]=m,i[11]=_):_=i[11],_});function J(e,s,n,a,t){return new Promise((o,l)=>{i(e,s),r({url:c.getDefaultData}).then(e=>{200===e.code&&e.data?(x(e.data.data)?t&&(t(),y.success("重置完成")):(h(e.data.data,!1,!1,n),a?(y.success("重置完成，即将刷新页面"),setTimeout(()=>{window.location.reload()},1e3)):y.success("重置完成")),_(e.data.created_at),o(e.data.data)):(y.error("重置失败"),l(new Error("Failed to fetch default data.")))}).catch(e=>{y.error("重置失败"),l(e)}).finally(()=>{d(e,s)})})}const Z=e=>{const n=s.c(10),{type:a,onConfirm:i,label:r,icon:c,loading:d}=e,m=void 0===a?"text":a,f=void 0===r?"重置":r;let u,x,h;return n[0]!==i?(u=()=>{i&&i()},n[0]=i,n[1]=u):u=n[1],n[2]!==c||n[3]!==f||n[4]!==d||n[5]!==m?(x=t.jsx(l,{type:m,danger:!0,icon:c,loading:d,children:f}),n[2]=c,n[3]=f,n[4]=d,n[5]=m,n[6]=x):x=n[6],n[7]!==u||n[8]!==x?(h=t.jsx(o,{title:"是否确认重置？",onConfirm:u,children:x}),n[7]=u,n[8]=x,n[9]=h):h=n[9],h};function ee(){const a=s.c(90),o=b(),{getDefaultDataClear:i}=N(),r=n(te),c=n(ae),d=n(ne);let m;a[0]===Symbol.for("react.memo_cache_sentinel")?(m=[],a[0]=m):m=a[0];const[f,u]=e.useState(m);let h,g,v,C,S;a[1]!==o?(h=()=>{J(0,u,[{name:"appData"}],void 0,()=>{o(E())})},a[1]=o,a[2]=h):h=a[2],a[3]!==f[0]||a[4]!==h?(g={label:"卡片数据",content:t.jsx(Z,{loading:f[0],onConfirm:h})},a[3]=f[0],a[4]=h,a[5]=g):g=a[5],a[6]!==o?(v=()=>{J(1,u,[{name:"searchEngineData"}],void 0,()=>{o(I())})},a[6]=o,a[7]=v):v=a[7],a[8]!==f[1]||a[9]!==v?(C={label:"搜索引擎",content:t.jsx(Z,{loading:f[1],onConfirm:v})},a[8]=f[1],a[9]=v,a[10]=C):C=a[10],a[11]!==g||a[12]!==C?(S=[g,C],a[11]=g,a[12]=C,a[13]=S):S=a[13];const _=S;let K,R,q,G,W,X,Q,U,V,ee,oe,le,ie,re,ce,de,me,fe,ue;a[14]!==o?(K=()=>{J(2,u,[{name:"card"}],void 0,()=>{o(D())})},a[14]=o,a[15]=K):K=a[15],a[16]!==f[2]||a[17]!==K?(R={label:"卡片尺寸",content:t.jsx(Z,{loading:f[2],onConfirm:K})},a[16]=f[2],a[17]=K,a[18]=R):R=a[18],a[19]!==o?(q=()=>{J(3,u,[{name:"openType"}],void 0,()=>{o(T())})},a[19]=o,a[20]=q):q=a[20],a[21]!==f[3]||a[22]!==q?(G={label:"打开方式",content:t.jsx(Z,{loading:f[3],onConfirm:q})},a[21]=f[3],a[22]=q,a[23]=G):G=a[23],a[24]!==o?(W=()=>{J(4,u,[{name:"clockAndDate"}],void 0,()=>{o(B())})},a[24]=o,a[25]=W):W=a[25],a[26]!==f[4]||a[27]!==W?(X={label:"日期和时间",content:t.jsx(Z,{loading:f[4],onConfirm:W})},a[26]=f[4],a[27]=W,a[28]=X):X=a[28],a[29]!==o?(Q=()=>{J(5,u,[{name:"searchBar"}],void 0,()=>{o(L())})},a[29]=o,a[30]=Q):Q=a[30],a[31]!==f[5]||a[32]!==Q?(U={label:"搜索栏",content:t.jsx(Z,{loading:f[5],onConfirm:Q})},a[31]=f[5],a[32]=Q,a[33]=U):U=a[33],a[34]!==o?(V=()=>{J(6,u,[{name:"bottomArea"}],void 0,()=>{o(M())})},a[34]=o,a[35]=V):V=a[35],a[36]!==f[6]||a[37]!==V?(ee={label:"底部区域",content:t.jsx(Z,{loading:f[6],onConfirm:V})},a[36]=f[6],a[37]=V,a[38]=ee):ee=a[38],a[39]!==o?(oe=()=>{J(7,u,[{name:"simpleMode"}],void 0,()=>{o(P())})},a[39]=o,a[40]=oe):oe=a[40],a[41]!==f[7]||a[42]!==oe?(le={label:"简约模式",content:t.jsx(Z,{loading:f[7],onConfirm:oe})},a[41]=f[7],a[42]=oe,a[43]=le):le=a[43],a[44]!==o?(ie=()=>{J(8,u,[{name:"wallpaperTheme"}],void 0,()=>{o(A())})},a[44]=o,a[45]=ie):ie=a[45],a[46]!==f[8]||a[47]!==ie?(re={label:"壁纸主题",content:t.jsx(Z,{loading:f[8],onConfirm:ie})},a[46]=f[8],a[47]=ie,a[48]=re):re=a[48],a[49]!==o?(ce=()=>{J(10,u,[{name:"dock"}],void 0,()=>{o(F())})},a[49]=o,a[50]=ce):ce=a[50],a[51]!==f[10]||a[52]!==ce?(de={label:"Dock 卡片坞",content:t.jsx(Z,{loading:f[10],onConfirm:ce})},a[51]=f[10],a[52]=ce,a[53]=de):de=a[53],a[54]!==o||a[55]!==c||a[56]!==r?(me=()=>{J(9,u,[{name:"home",blackList:["showMode"]},{name:"swiper",blackList:["activeIndex"]}],void 0,()=>{o(z()),o(H()),o(Y())}),r&&(c?r?.slideToLoop(0):r?.slideTo(0))},a[54]=o,a[55]=c,a[56]=r,a[57]=me):me=a[57],a[58]!==f[9]||a[59]!==me?(fe={label:"其他（排版布局等）",content:t.jsx(Z,{loading:f[9],onConfirm:me})},a[58]=f[9],a[59]=me,a[60]=fe):fe=a[60],a[61]!==X||a[62]!==U||a[63]!==ee||a[64]!==le||a[65]!==re||a[66]!==de||a[67]!==fe||a[68]!==R||a[69]!==G?(ue=[R,G,X,U,ee,le,re,de,fe],a[61]=X,a[62]=U,a[63]=ee,a[64]=le,a[65]=re,a[66]=de,a[67]=fe,a[68]=R,a[69]=G,a[70]=ue):ue=a[70];const xe=ue;let he,je,pe,be,ge,ye,ve;return a[71]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(l,{type:"link",onClick:se,children:"本地"}),je=t.jsx($,{type:"vertical",className:"m-0"}),a[71]=he,a[72]=je):(he=a[71],je=a[72]),a[73]!==d?(pe=t.jsx(w,{groupTitle:"数据回退",items:[{label:"时光机",content:t.jsxs("div",{className:"flex items-center",children:[he,je,t.jsx(l,{type:"link",onClick:()=>{d&&""!==((e,s=" ")=>{if(!e)return"";const n=s.replace(/[\W]{1}/g,"\\$&"),a=new RegExp(`^[${n}]+|[${n}]+$`,"g");return e.replace(a,"")})(d)?j.show(p,{title:"从云端回退",children:t.jsx(O,{})}):y.error("请您先完成登录/注册")},children:"云端"})]})}],bottomDivider:!0,gap:20}),a[73]=d,a[74]=pe):pe=a[74],a[75]!==o||a[76]!==i||a[77]!==c||a[78]!==r?(be=()=>{i(10,u,e=>{x(e)?(o(E()),o(I()),o(D()),o(T()),o(B()),o(L()),o(M()),o(P()),o(A()),o(z()),o(H()),o(Y()),o(F()),o(k()),y.success("批量重置完成")):y.success("批量重置完成")}),r&&(c?r?.slideToLoop(0):r?.slideTo(0))},a[75]=o,a[76]=i,a[77]=c,a[78]=r,a[79]=be):be=a[79],a[80]!==f[10]||a[81]!==be?(ge={label:"全部数据",content:t.jsx(Z,{label:"批量重置",loading:f[10],onConfirm:be})},a[80]=f[10],a[81]=be,a[82]=ge):ge=a[82],a[83]!==_||a[84]!==xe||a[85]!==ge?(ye=t.jsx(w,{groupTitle:"配置恢复",items:[ge,..._,...xe],gap:20}),a[83]=_,a[84]=xe,a[85]=ge,a[86]=ye):ye=a[86],a[87]!==pe||a[88]!==ye?(ve=t.jsx(t.Fragment,{children:t.jsxs("div",{className:"mt-3",children:[pe,ye]})}),a[87]=pe,a[88]=ye,a[89]=ve):ve=a[89],ve}function se(){j.show(p,{title:"从本地回退",children:t.jsx(V,{})})}function ne(e){return e.user.token}function ae(e){return e.swiper.loop}function te(e){return e.stateUtils.mySwiper}export{ee as default,J as getDefaultData};
