import{r as e}from"./requestIdleCallbackPolyfill-CEimuL3I.js";function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t.apply(null,arguments)}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e,t){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}var o,a=new Uint8Array(16);function l(){if(!o&&!(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(a)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&s.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n}function h(e,t,n){var r=(e=e||{}).random||(e.rng||l)();return r[6]=15&r[6]|64,r[8]=63&r[8]|128,d(r)}function f(t){return e.createElement("i",{className:"rmel-iconfont rmel-icon-"+t.type})}function p(t){return e.createElement("div",{className:"rc-md-navigation "+(t.visible?"visible":"in-visible")},e.createElement("div",{className:"navigation-nav left"},e.createElement("div",{className:"button-wrap"},t.left)),e.createElement("div",{className:"navigation-nav right"},e.createElement("div",{className:"button-wrap"},t.right)))}function m(t){return e.createElement("div",{className:"tool-bar",style:t.style},t.children)}var g,v={exports:{}};var y=(g||(g=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var l=new i(r,o||e,a),s=n?n+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],l]:e._events[s].push(l):(e._events[s]=l,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function l(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),l.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},l.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},l.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},l.prototype.emit=function(e,t,r,i,o,a){var l=n?n+e:e;if(!this._events[l])return!1;var s,c,u=this._events[l],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,o),!0;case 6:return u.fn.call(u.context,t,r,i,o,a),!0}for(c=1,s=new Array(d-1);c<d;c++)s[c-1]=arguments[c];u.fn.apply(u.context,s)}else{var h,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,r);break;case 4:u[c].fn.call(u[c].context,t,r,i);break;default:if(!s)for(h=1,s=new Array(d-1);h<d;h++)s[h-1]=arguments[h];u[c].fn.apply(u[c].context,s)}}return!0},l.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},l.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},l.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var l=this._events[o];if(l.fn)l.fn!==t||i&&!l.once||r&&l.context!==r||a(this,o);else{for(var s=0,c=[],u=l.length;s<u;s++)(l[s].fn!==t||i&&!l[s].once||r&&l[s].context!==r)&&c.push(l[s]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},l.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,e.exports=l}(v)),v.exports),b=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).EVENT_CHANGE="a1",t.EVENT_FULL_SCREEN="a2",t.EVENT_VIEW_CHANGE="a3",t.EVENT_KEY_DOWN="a4",t.EVENT_EDITOR_KEY_DOWN="a5",t.EVENT_FOCUS="a5",t.EVENT_BLUR="a6",t.EVENT_SCROLL="a7",t.EVENT_LANG_CHANGE="b1",t}return i(t,e),t}(y.EventEmitter),w=new b;const C={clearTip:"Are you sure you want to clear all contents?",btnHeader:"Header",btnClear:"Clear",btnBold:"Bold",btnItalic:"Italic",btnUnderline:"Underline",btnStrikethrough:"Strikethrough",btnUnordered:"Unordered list",btnOrdered:"Ordered list",btnQuote:"Quote",btnLineBreak:"Line break",btnInlineCode:"Inline code",btnCode:"Code",btnTable:"Table",btnImage:"Image",btnLink:"Link",btnUndo:"Undo",btnRedo:"Redo",btnFullScreen:"Full screen",btnExitFullScreen:"Exit full screen",btnModeEditor:"Only display editor",btnModePreview:"Only display preview",btnModeAll:"Display both editor and preview",selectTabMap:"Actual input when typing a Tab key",tab:"Tab",spaces:"Spaces"},E={clearTip:"您确定要清空所有内容吗？",btnHeader:"标题",btnClear:"清空",btnBold:"加粗",btnItalic:"斜体",btnUnderline:"下划线",btnStrikethrough:"删除线",btnUnordered:"无序列表",btnOrdered:"有序列表",btnQuote:"引用",btnLineBreak:"换行",btnInlineCode:"行内代码",btnCode:"代码块",btnTable:"表格",btnImage:"图片",btnLink:"链接",btnUndo:"撤销",btnRedo:"重做",btnFullScreen:"全屏",btnExitFullScreen:"退出全屏",btnModeEditor:"仅显示编辑器",btnModePreview:"仅显示预览",btnModeAll:"显示编辑器与预览",selectTabMap:"按下 Tab 键时实际的输入",tab:"制表符",spaces:"空格"};var k=new(function(){function e(){this.langs={enUS:C,zhCN:E},this.current="enUS",this.setUp()}var t=e.prototype;return t.setUp=function(){if("undefined"!=typeof window){var e="enUS";if(navigator.language){var t=navigator.language.split("-");e=t[0],1!==t.length&&(e+=t[t.length-1].toUpperCase())}if(navigator.browserLanguage){var n=navigator.browserLanguage.split("-");e=n[0],n[1]&&(e+=n[1].toUpperCase())}this.current!==e&&this.isAvailable(e)&&(this.current=e,w.emit(w.EVENT_LANG_CHANGE,this,e,this.langs[e]))}},t.isAvailable=function(e){return void 0!==this.langs[e]},t.add=function(e,t){this.langs[e]=t},t.setCurrent=function(e){if(!this.isAvailable(e))throw new Error("Language "+e+" is not exists");this.current!==e&&(this.current=e,w.emit(w.EVENT_LANG_CHANGE,this,e,this.langs[e]))},t.get=function(e,t){var n=this.langs[this.current][e]||"";return t&&Object.keys(t).forEach(function(e){n=n.replace(new RegExp("\\{"+e+"\\}","g"),t[e])}),n},t.getCurrent=function(){return this.current},e}());function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e){var t=function(e,t){if("object"!=S(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==S(t)?t:t+""}function N(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var x=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t.prototype.getConfig=function(e,t){return void 0!==this.props.config[e]&&null!==this.props.config[e]?this.props.config[e]:t},N(t,[{key:"editor",get:function(){return this.props.editor}},{key:"editorConfig",get:function(){return this.props.editorConfig}}]),t}(e.Component);x.pluginName="",x.align="left",x.defaultConfig={};var M=function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.render=function(){return e.createElement("span",{className:"rc-md-divider"})},n}(x);M.pluginName="divider";var _={start:0,end:0,text:""};function L(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e))||t){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function U(e){return e&&(e instanceof Promise||("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then)}function H(e,t){for(var n="",r=t;r--;)n+=e;return n}function I(e,t){var n=t.withKey,r=t.keyCode,i=t.key,o=t.aliasCommand,a={ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,shiftKey:e.shiftKey,keyCode:e.keyCode,key:e.key};if(o&&(a.ctrlKey=a.ctrlKey||a.metaKey),n&&n.length>0)for(var l,s=L(n);!(l=s()).done;){var c=l.value;if(void 0!==a[c]&&!a[c])return!1}else if(a.metaKey||a.ctrlKey||a.shiftKey||a.altKey)return!1;return a.key?a.key===i:a.keyCode===r}function A(e,t){var n=e.split("\n"),r=e.substr(0,t).split("\n"),i=r.length,o=r[r.length-1].length,a=n[r.length-1],l=r.length>1?r[r.length-2]:null,s=n.length>r.length?n[r.length]:null;return{line:i,col:o,beforeText:e.substr(0,t),afterText:e.substr(t),curLine:a,prevLine:l,nextLine:s}}for(var V={bold:["**","**"],italic:["*","*"],underline:["++","++"],strikethrough:["~~","~~"],quote:["\n> ","\n"],inlinecode:["`","`"],code:["\n```\n","\n```\n"]},O=1;O<=6;O++)V["h"+O]=["\n"+H("#",O)+" ","\n"];function P(e){for(var t=e.row,n=void 0===t?2:t,r=e.col,i=void 0===r?2:r,o=["|"],a=["|"],l=["|"],s="",c=1;c<=i;c++)o.push(" Head |"),l.push(" --- |"),a.push(" Data |");for(var u=1;u<=n;u++)s+="\n"+a.join("");return o.join("")+"\n"+l.join("")+s}function D(e,t){var n=t;if("\n"!==n.substr(0,1)&&(n="\n"+n),"unordered"===e)return n.length>1?n.replace(/\n/g,"\n* ").trim():"* ";var r=1;return n.length>1?n.replace(/\n/g,function(){return"\n"+r+++". "}).trim():"1. "}function R(e,t){return{text:e,newBlock:t,selection:{start:e.length,end:e.length}}}function W(e,t,n){if(void 0!==V[t])return{text:""+V[t][0]+e+V[t][1],selection:{start:V[t][0].length,end:V[t][0].length+e.length}};switch(t){case"tab":var r=1===n.tabMapValue?"\t":" ".repeat(n.tabMapValue),i=r+e.replace(/\n/g,"\n"+r),o=e.includes("\n")?e.match(/\n/g).length:0;return{text:i,selection:{start:n.tabMapValue,end:n.tabMapValue*(o+1)+e.length}};case"unordered":return R(D("unordered",e),!0);case"order":return R(D("order",e),!0);case"hr":return R("---",!0);case"table":return{text:P(n),newBlock:!0};case"image":return{text:"!["+(e||n.target)+"]("+(n.imageUrl||"")+")",selection:{start:2,end:e.length+2}};case"link":return{text:"["+e+"]("+(n.linkUrl||"")+")",selection:{start:1,end:e.length+1}}}return{text:e,selection:{start:0,end:e.length}}}function F(e,t){var n={};return Object.keys(e).forEach(function(r){void 0!==t[r]?"object"!=typeof t[r]?n[r]=t[r]:Array.isArray(t[r])?n[r]=[].concat(t[r]):n[r]=F(e[r],t[r]):n[r]=e[r]}),n}function j(e){for(var n=t({},e),r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i.forEach(function(e){"object"==typeof e&&(n=F(n,e))}),n}function B(e,t){return{placeholder:W("","image",{target:"Uploading_"+h(),imageUrl:""}).text,uploaded:new Promise(function(n){var r=function(t){n(W("","image",{target:e.name,imageUrl:t}).text)},i=t(e,r);U(i)&&i.then(r)})}}var G={theme:"default",view:{menu:!0,md:!0,html:!0},canView:{menu:!0,md:!0,html:!0,both:!0,fullScreen:!0,hideMenu:!0},htmlClass:"",markdownClass:"",syncScrollMode:["rightFollowLeft","leftFollowRight"],imageUrl:"",imageAccept:"",linkUrl:"",loggerMaxSize:100,loggerInterval:600,table:{maxRow:4,maxCol:6},allowPasteImage:!0,onImageUpload:void 0,onCustomImageUpload:void 0,shortcuts:!0,onChangeTrigger:"both"},z=function(t){function n(){return t.apply(this,arguments)||this}i(n,t);var r=n.prototype;return r.getHtml=function(){return"string"==typeof this.props.html?this.props.html:this.el.current?this.el.current.innerHTML:""},r.render=function(){return"string"==typeof this.props.html?e.createElement("div",{ref:this.el,dangerouslySetInnerHTML:{__html:this.props.html},className:this.props.className||"custom-html-style"}):e.createElement("div",{ref:this.el,className:this.props.className||"custom-html-style"},this.props.html)},n}(function(t){function n(n){var r;return(r=t.call(this,n)||this).el=e.createRef(),r}i(n,t);var r=n.prototype;return r.getElement=function(){return this.el.current},r.getHeight=function(){return this.el.current?this.el.current.offsetHeight:0},n}(e.Component));function q(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,t)}(e))||t){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $=function(r){function o(t){var i;return(i=r.call(this,t)||this).nodeMdText=e.createRef(),i.nodeMdPreview=e.createRef(),i.nodeMdPreviewWrapper=e.createRef(),i.hasContentChanged=!0,i.composing=!1,i.pluginApis=new Map,i.scrollScale=1,i.isSyncingScroll=!1,i.shouldSyncScroll="md",i.keyboardListeners=[],i.emitter=new b,i.config=j(G,i.props.config,i.props),i.state={text:(i.props.value||i.props.defaultValue||"").replace(/↵/g,"\n"),html:"",view:i.config.view||G.view,fullScreen:!1,plugins:i.getPlugins()},i.config.canView&&!i.config.canView.menu&&(i.state.view.menu=!1),i.nodeMdText=e.createRef(),i.nodeMdPreviewWrapper=e.createRef(),i.handleChange=i.handleChange.bind(n(i)),i.handlePaste=i.handlePaste.bind(n(i)),i.handleDrop=i.handleDrop.bind(n(i)),i.handleToggleMenu=i.handleToggleMenu.bind(n(i)),i.handleKeyDown=i.handleKeyDown.bind(n(i)),i.handleEditorKeyDown=i.handleEditorKeyDown.bind(n(i)),i.handleLocaleUpdate=i.handleLocaleUpdate.bind(n(i)),i.handleFocus=i.handleFocus.bind(n(i)),i.handleBlur=i.handleBlur.bind(n(i)),i.handleInputScroll=i.handleSyncScroll.bind(n(i),"md"),i.handlePreviewScroll=i.handleSyncScroll.bind(n(i),"html"),i}i(o,r),o.use=function(e,t){void 0===t&&(t={});for(var n=0;n<o.plugins.length;n++)if(o.plugins[n].comp===e)return void o.plugins.splice(n,1,{comp:e,config:t});o.plugins.push({comp:e,config:t})},o.unuse=function(e){for(var t=0;t<o.plugins.length;t++)if(o.plugins[t].comp===e)return void o.plugins.splice(t,1)},o.unuseAll=function(){o.plugins=[]};var a=o.prototype;return a.componentDidMount=function(){var e=this.state.text;this.renderHTML(e),w.on(w.EVENT_LANG_CHANGE,this.handleLocaleUpdate),k.setUp()},a.componentWillUnmount=function(){w.off(w.EVENT_LANG_CHANGE,this.handleLocaleUpdate)},a.componentDidUpdate=function(e){if(void 0!==this.props.value&&this.props.value!==this.state.text){var t=this.props.value;"string"!=typeof t&&(t=String(t).toString()),t=t.replace(/↵/g,"\n"),this.state.text!==t&&(this.setState({text:t}),this.renderHTML(t))}e.plugins!==this.props.plugins&&this.setState({plugins:this.getPlugins()})},a.isComposing=function(){return this.composing},a.getPlugins=function(){var n=this,r=[];if(this.props.plugins)for(var i,a=function(e){if(e!==M.pluginName)for(var t,n=q(o.plugins);!(t=n()).done;){var i=t.value;if(i.comp.pluginName===e)return void r.push(i)}else r.push({comp:M,config:{}})},l=q(this.props.plugins);!(i=l()).done;){var s=i.value;"fonts"===s?(a("font-bold"),a("font-italic"),a("font-underline"),a("font-strikethrough"),a("list-unordered"),a("list-ordered"),a("block-quote"),a("block-wrap"),a("block-code-inline"),a("block-code-block")):a(s)}else r=[].concat(o.plugins);var c={};return r.forEach(function(r){void 0===c[r.comp.align]&&(c[r.comp.align]=[]);var i="divider"===r.comp.pluginName?h():r.comp.pluginName;c[r.comp.align].push(e.createElement(r.comp,{editor:n,editorConfig:n.config,config:t({},r.comp.defaultConfig||{},r.config||{}),key:i}))}),c},a.handleSyncScroll=function(e,t){var n=this;if(e===this.shouldSyncScroll){this.props.onScroll&&this.props.onScroll(t,e),this.emitter.emit(this.emitter.EVENT_SCROLL,t,e);var r=this.config.syncScrollMode;(void 0===r?[]:r).includes("md"===e?"rightFollowLeft":"leftFollowRight")&&(this.hasContentChanged&&this.nodeMdText.current&&this.nodeMdPreviewWrapper.current&&(this.scrollScale=this.nodeMdText.current.scrollHeight/this.nodeMdPreviewWrapper.current.scrollHeight,this.hasContentChanged=!1),this.isSyncingScroll||(this.isSyncingScroll=!0,requestAnimationFrame(function(){n.nodeMdText.current&&n.nodeMdPreviewWrapper.current&&("md"===e?n.nodeMdPreviewWrapper.current.scrollTop=n.nodeMdText.current.scrollTop/n.scrollScale:n.nodeMdText.current.scrollTop=n.nodeMdPreviewWrapper.current.scrollTop*n.scrollScale),n.isSyncingScroll=!1})))}},a.renderHTML=function(e){var t=this;if(!this.props.renderHTML)return Promise.resolve();var n=this.props.renderHTML(e);return U(n)?n.then(function(e){return t.setHtml(e)}):"function"==typeof n?this.setHtml(n()):this.setHtml(n)},a.setHtml=function(e){var t=this;return new Promise(function(n){t.setState({html:e},n)})},a.handleToggleMenu=function(){this.setView({menu:!this.state.view.menu})},a.handleFocus=function(e){var t=this.props.onFocus;t&&t(e),this.emitter.emit(this.emitter.EVENT_FOCUS,e)},a.handleBlur=function(e){var t=this.props.onBlur;t&&t(e),this.emitter.emit(this.emitter.EVENT_BLUR,e)},a.handleChange=function(e){e.persist();var t=e.target.value;this.setText(t,e)},a.handlePaste=function(e){if(this.config.allowPasteImage&&this.config.onImageUpload){var t=(e.nativeEvent.clipboardData||window.clipboardData).items;t&&(e.preventDefault(),this.uploadWithDataTransfer(t))}},a.handleDrop=function(e){if(this.config.onImageUpload){var t=e.nativeEvent;if(t.dataTransfer){var n=t.dataTransfer.items;n&&(e.preventDefault(),this.uploadWithDataTransfer(n))}}},a.handleEditorKeyDown=function(e){var t=this,n=e.keyCode,r=e.key,i=e.currentTarget;if((13===n||"Enter"===r)&&!1===this.composing){var o=i.value,a=i.selectionStart,l=A(o,a),s=function(){var n=i.value.substr(0,a-l.curLine.length)+i.value.substr(a);t.setText(n,void 0,{start:a-l.curLine.length,end:a-l.curLine.length}),e.preventDefault()},c=function(n){t.insertText("\n"+n,!1,{start:n.length+1,end:n.length+1}),e.preventDefault()},u=l.curLine.match(/^(\s*?)\* /);if(u)return/^(\s*?)\* $/.test(l.curLine)?void s():void c(u[0]);var d=l.curLine.match(/^(\s*?)(\d+)\. /);if(d)return/^(\s*?)(\d+)\. $/.test(l.curLine)?void s():void c(""+d[1]+(parseInt(d[2],10)+1)+". ")}this.emitter.emit(this.emitter.EVENT_EDITOR_KEY_DOWN,e)},a.handleLocaleUpdate=function(){this.forceUpdate()},a.getMdElement=function(){return this.nodeMdText.current},a.getHtmlElement=function(){return this.nodeMdPreviewWrapper.current},a.clearSelection=function(){this.nodeMdText.current&&this.nodeMdText.current.setSelectionRange(0,0,"none")},a.getSelection=function(){var e=this.nodeMdText.current;if(!e)return t({},_);var n=e.selectionStart,r=e.selectionEnd;return{start:n,end:r,text:(e.value||"").slice(n,r)}},a.setSelection=function(e){this.nodeMdText.current&&(this.nodeMdText.current.setSelectionRange(e.start,e.end,"forward"),this.nodeMdText.current.focus())},a.insertMarkdown=function(e,n){void 0===n&&(n={});var r=this.getSelection(),i=n?t({},n):{};if("image"===e&&(i=t({},i,{target:n.target||r.text||"",imageUrl:n.imageUrl||this.config.imageUrl})),"link"===e&&(i=t({},i,{linkUrl:this.config.linkUrl})),"tab"===e&&r.start!==r.end){var o=this.getMdValue().slice(0,r.start).lastIndexOf("\n")+1;this.setSelection({start:o,end:r.end})}var a=W(r.text,e,i),l=a.text,s=a.selection;if(a.newBlock){var c=A(this.getMdValue(),r.start),u=c.col,d=c.curLine;u>0&&d.length>0&&(l="\n"+l,s&&(s.start++,s.end++));var h=c.afterText;r.start!==r.end&&(h=A(this.getMdValue(),r.end).afterText),""!==h.trim()&&"\n\n"!==h.substr(0,2)&&("\n"!==h.substr(0,1)&&(l+="\n"),l+="\n")}this.insertText(l,!0,s)},a.insertPlaceholder=function(e,t){var n=this;this.insertText(e,!0),t.then(function(t){var r=n.getMdValue().replace(e,t);n.setText(r)})},a.insertText=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=!1);var r=this.state.text,i=this.getSelection(),o=r.slice(0,i.start),a=r.slice(t?i.end:i.start,r.length);this.setText(o+e+a,void 0,n?{start:n.start+o.length,end:n.end+o.length}:{start:i.start,end:i.start})},a.setText=function(e,t,n){var r=this;void 0===e&&(e="");var i=this.config.onChangeTrigger,o=void 0===i?"both":i,a=e.replace(/↵/g,"\n");if(this.state.text!==e){this.setState({text:a}),!this.props.onChange||"both"!==o&&"beforeRender"!==o||this.props.onChange({text:a,html:this.getHtmlValue()},t),this.emitter.emit(this.emitter.EVENT_CHANGE,e,t,void 0===t),n&&setTimeout(function(){return r.setSelection(n)}),this.hasContentChanged||(this.hasContentChanged=!0);var l=this.renderHTML(a);"both"!==o&&"afterRender"!==o||l.then(function(){r.props.onChange&&r.props.onChange({text:r.state.text,html:r.getHtmlValue()},t)})}},a.getMdValue=function(){return this.state.text},a.getHtmlValue=function(){return"string"==typeof this.state.html?this.state.html:this.nodeMdPreview.current?this.nodeMdPreview.current.getHtml():""},a.onKeyboard=function(e){var t=this;Array.isArray(e)?e.forEach(function(e){return t.onKeyboard(e)}):this.keyboardListeners.includes(e)||this.keyboardListeners.push(e)},a.offKeyboard=function(e){var t=this;if(Array.isArray(e))e.forEach(function(e){return t.offKeyboard(e)});else{var n=this.keyboardListeners.indexOf(e);n>=0&&this.keyboardListeners.splice(n,1)}},a.handleKeyDown=function(e){for(var t,n=q(this.keyboardListeners);!(t=n()).done;){var r=t.value;if(I(e,r))return e.preventDefault(),void r.callback(e)}this.emitter.emit(this.emitter.EVENT_KEY_DOWN,e)},a.getEventType=function(e){switch(e){case"change":return this.emitter.EVENT_CHANGE;case"fullscreen":return this.emitter.EVENT_FULL_SCREEN;case"viewchange":return this.emitter.EVENT_VIEW_CHANGE;case"keydown":return this.emitter.EVENT_KEY_DOWN;case"editor_keydown":return this.emitter.EVENT_EDITOR_KEY_DOWN;case"blur":return this.emitter.EVENT_BLUR;case"focus":return this.emitter.EVENT_FOCUS;case"scroll":return this.emitter.EVENT_SCROLL}},a.on=function(e,t){var n=this.getEventType(e);n&&this.emitter.on(n,t)},a.off=function(e,t){var n=this.getEventType(e);n&&this.emitter.off(n,t)},a.setView=function(e){var n=this,r=t({},this.state.view,e);this.setState({view:r},function(){n.emitter.emit(n.emitter.EVENT_VIEW_CHANGE,r)})},a.getView=function(){return t({},this.state.view)},a.fullScreen=function(e){var t=this;this.state.fullScreen!==e&&this.setState({fullScreen:e},function(){t.emitter.emit(t.emitter.EVENT_FULL_SCREEN,e)})},a.registerPluginApi=function(e,t){this.pluginApis.set(e,t)},a.unregisterPluginApi=function(e){this.pluginApis.delete(e)},a.callPluginApi=function(e){var t=this.pluginApis.get(e);if(!t)throw new Error("API "+e+" not found");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.apply(void 0,r)},a.isFullScreen=function(){return this.state.fullScreen},a.uploadWithDataTransfer=function(e){var t=this,n=this.config.onImageUpload;if(n){var r=[];Array.prototype.forEach.call(e,function(e){if("file"===e.kind&&e.type.includes("image")){var i=e.getAsFile();if(i){var o=B(i,n);r.push(Promise.resolve(o.placeholder)),o.uploaded.then(function(e){var n=t.getMdValue().replace(o.placeholder,e),r=e.length-o.placeholder.length,i=t.getSelection();t.setText(n,void 0,{start:i.start+r,end:i.start+r})})}}else"string"===e.kind&&"text/plain"===e.type&&r.push(new Promise(function(t){return e.getAsString(t)}))}),Promise.all(r).then(function(e){var n=e.join(""),r=t.getSelection();t.insertText(n,!0,{start:r.start===r.end?n.length:0,end:n.length})})}},a.render=function(){var t=this,n=this.state,r=n.view,i=n.fullScreen,o=n.text,a=n.html,l=this.props,s=l.id,c=l.className,u=void 0===c?"":c,d=l.style,h=l.name,g=void 0===h?"textarea":h,v=l.autoFocus,y=l.placeholder,b=l.readOnly,w=this.config.canView&&this.config.canView.hideMenu&&!this.config.canView.menu,C=function(e){return t.state.plugins[e]||[]},E=!!r.menu,k=s?s+"_md":void 0,S=s?s+"_html":void 0;return e.createElement("div",{id:s,className:"rc-md-editor "+(i?"full":"")+" "+u,style:d,onKeyDown:this.handleKeyDown,onDrop:this.handleDrop},e.createElement(p,{visible:E,left:C("left"),right:C("right")}),e.createElement("div",{className:"editor-container"},w&&e.createElement(m,null,e.createElement("span",{className:"button button-type-menu",title:E?"hidden menu":"show menu",onClick:this.handleToggleMenu},e.createElement(f,{type:"expand-"+(E?"less":"more")}))),e.createElement("section",{className:"section sec-md "+(r.md?"visible":"in-visible")},e.createElement("textarea",{id:k,ref:this.nodeMdText,name:g,autoFocus:v,placeholder:y,readOnly:b,value:o,className:"section-container input "+(this.config.markdownClass||""),wrap:"hard",onChange:this.handleChange,onScroll:this.handleInputScroll,onMouseOver:function(){return t.shouldSyncScroll="md"},onKeyDown:this.handleEditorKeyDown,onCompositionStart:function(){return t.composing=!0},onCompositionEnd:function(){return t.composing=!1},onPaste:this.handlePaste,onFocus:this.handleFocus,onBlur:this.handleBlur})),e.createElement("section",{className:"section sec-html "+(r.html?"visible":"in-visible")},e.createElement("div",{id:S,className:"section-container html-wrap",ref:this.nodeMdPreviewWrapper,onMouseOver:function(){return t.shouldSyncScroll="html"},onScroll:this.handlePreviewScroll},e.createElement(z,{html:a,className:this.config.htmlClass,ref:this.nodeMdPreview})))))},o}(e.Component);$.plugins=[],$.addLocale=k.add.bind(k),$.useLocale=k.setCurrent.bind(k),$.getLocale=k.getCurrent.bind(k);var Q=function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.render=function(){var t=this;return e.createElement("span",{className:"button button-type-code-block",title:k.get("btnCode"),onClick:function(){return t.editor.insertMarkdown("code")}},e.createElement(f,{type:"code-block"}))},n}(x);Q.pluginName="block-code-block";var J=function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.render=function(){var t=this;return e.createElement("span",{className:"button button-type-code-inline",title:k.get("btnInlineCode"),onClick:function(){return t.editor.insertMarkdown("inlinecode")}},e.createElement(f,{type:"code"}))},n}(x);J.pluginName="block-code-inline";var X=function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.render=function(){var t=this;return e.createElement("span",{className:"button button-type-quote",title:k.get("btnQuote"),onClick:function(){return t.editor.insertMarkdown("quote")}},e.createElement(f,{type:"quote"}))},n}(x);X.pluginName="block-quote";var Z=function(t){function n(){return t.apply(this,arguments)||this}return i(n,t),n.prototype.render=function(){var t=this;return e.createElement("span",{className:"button button-type-wrap",title:k.get("btnLineBreak"),onClick:function(){return t.editor.insertMarkdown("hr")}},e.createElement(f,{type:"wrap"}))},n}(x);Z.pluginName="block-wrap";var ee=function(t){function r(e){var r;return(r=t.call(this,e)||this).handleClick=r.handleClick.bind(n(r)),r}i(r,t);var o=r.prototype;return o.handleClick=function(){""!==this.editor.getMdValue()&&(window.confirm&&"function"==typeof window.confirm&&window.confirm(k.get("clearTip"))&&this.editor.setText(""))},o.render=function(){return e.createElement("span",{className:"button button-type-clear",title:k.get("btnClear"),onClick:this.handleClick},e.createElement(f,{type:"delete"}))},r}(x);ee.pluginName="clear";var te=function(t){function n(e){var n;return(n=t.call(this,e)||this).handleKeyboard={key:"b",keyCode:66,aliasCommand:!0,withKey:["ctrlKey"],callback:function(){return n.editor.insertMarkdown("bold")}},n}i(n,t);var r=n.prototype;return r.componentDidMount=function(){this.editorConfig.shortcuts&&this.editor.onKeyboard(this.handleKeyboard)},r.componentWillUnmount=function(){this.editor.offKeyboard(this.handleKeyboard)},r.render=function(){var t=this;return e.createElement("span",{className:"button button-type-bold",title:k.get("btnBold"),onClick:function(){return t.editor.insertMarkdown("bold")}},e.createElement(f,{type:"bold"}))},n}(x);te.pluginName="font-bold";var ne=function(t){function n(e){var n;return(n=t.call(this,e)||this).handleKeyboard={key:"i",keyCode:73,aliasCommand:!0,withKey:["ctrlKey"],callback:function(){return n.editor.insertMarkdown("italic")}},n}i(n,t);var r=n.prototype;return r.componentDidMount=function(){this.editorConfig.shortcuts&&this.editor.onKeyboard(this.handleKeyboard)},r.componentWillUnmount=function(){this.editor.offKeyboard(this.handleKeyboard)},r.render=function(){var t=this;return e.createElement("span",{className:"button button-type-italic",title:k.get("btnItalic"),onClick:function(){return t.editor.insertMarkdown("italic")}},e.createElement(f,{type:"italic"}))},n}(x);ne.pluginName="font-italic";var re=function(t){function n(e){var n;return(n=t.call(this,e)||this).handleKeyboard={key:"d",keyCode:68,aliasCommand:!0,withKey:["ctrlKey"],callback:function(){return n.editor.insertMarkdown("strikethrough")}},n}i(n,t);var r=n.prototype;return r.componentDidMount=function(){this.editorConfig.shortcuts&&this.editor.onKeyboard(this.handleKeyboard)},r.componentWillUnmount=function(){this.editor.offKeyboard(this.handleKeyboard)},r.render=function(){var t=this;return e.createElement("span",{className:"button button-type-strikethrough",title:k.get("btnStrikethrough"),onClick:function(){return t.editor.insertMarkdown("strikethrough")}},e.createElement(f,{type:"strikethrough"}))},n}(x);re.pluginName="font-strikethrough";var ie=function(t){function n(e){var n;return(n=t.call(this,e)||this).handleKeyboard={key:"u",keyCode:85,withKey:["ctrlKey"],callback:function(){return n.editor.insertMarkdown("underline")}},n}i(n,t);var r=n.prototype;return r.componentDidMount=function(){this.editorConfig.shortcuts&&this.editor.onKeyboard(this.handleKeyboard)},r.componentWillUnmount=function(){this.editor.offKeyboard(this.handleKeyboard)},r.render=function(){var t=this;return e.createElement("span",{className:"button button-type-underline",title:k.get("btnUnderline"),onClick:function(){return t.editor.insertMarkdown("underline")}},e.createElement(f,{type:"underline"}))},n}(x);ie.pluginName="font-underline";var oe=function(t){function r(e){var r;return(r=t.call(this,e)||this).handleClick=r.handleClick.bind(n(r)),r.handleChange=r.handleChange.bind(n(r)),r.state={enable:r.editor.isFullScreen()},r}i(r,t);var o=r.prototype;return o.handleClick=function(){this.editor.fullScreen(!this.state.enable)},o.handleChange=function(e){this.setState({enable:e})},o.componentDidMount=function(){this.editor.on("fullscreen",this.handleChange)},o.componentWillUnmount=function(){this.editor.off("fullscreen",this.handleChange)},o.render=function(){if(this.editorConfig.canView&&this.editorConfig.canView.fullScreen){var t=this.state.enable;return e.createElement("span",{className:"button button-type-fullscreen",title:k.get(t?"btnExitFullScreen":"btnFullScreen"),onClick:this.handleClick},e.createElement(f,{type:t?"fullscreen-exit":"fullscreen"}))}return null},r}(x);oe.pluginName="full-screen",oe.align="right";var ae=function(t){function r(e){var r;return(r=t.call(this,e)||this).handleClose=r.handleClose.bind(n(r)),r}i(r,t);var o=r.prototype;return o.handleClose=function(e){e.stopPropagation();var t=this.props.onClose;"function"==typeof t&&t()},o.render=function(){return e.createElement("div",{className:"drop-wrap "+(this.props.show?"show":"hidden"),onClick:this.handleClose},this.props.children)},r}(e.Component),le=function(t){function n(){return t.apply(this,arguments)||this}i(n,t);var r=n.prototype;return r.handleHeader=function(e){var t=this.props.onSelectHeader;"function"==typeof t&&t(e)},r.render=function(){return e.createElement("ul",{className:"header-list"},e.createElement("li",{className:"list-item"},e.createElement("h1",{onClick:this.handleHeader.bind(this,"h1")},"H1")),e.createElement("li",{className:"list-item"},e.createElement("h2",{onClick:this.handleHeader.bind(this,"h2")},"H2")),e.createElement("li",{className:"list-item"},e.createElement("h3",{onClick:this.handleHeader.bind(this,"h3")},"H3")),e.createElement("li",{className:"list-item"},e.createElement("h4",{onClick:this.handleHeader.bind(this,"h4")},"H4")),e.createElement("li",{className:"list-item"},e.createElement("h5",{onClick:this.handleHeader.bind(this,"h5")},"H5")),e.createElement("li",{className:"list-item"},e.createElement("h6",{onClick:this.handleHeader.bind(this,"h6")},"H6")))},n}(e.Component),se=function(t){function r(e){var r;return(r=t.call(this,e)||this).show=r.show.bind(n(r)),r.hide=r.hide.bind(n(r)),r.state={show:!1},r}i(r,t);var o=r.prototype;return o.show=function(){this.setState({show:!0})},o.hide=function(){this.setState({show:!1})},o.render=function(){var t=this;return e.createElement("span",{className:"button button-type-header",title:k.get("btnHeader"),onMouseEnter:this.show,onMouseLeave:this.hide},e.createElement(f,{type:"font-size"}),e.createElement(ae,{show:this.state.show,onClose:this.hide},e.createElement(le,{onSelectHeader:function(e){return t.editor.insertMarkdown(e)}})))},r}(x);se.pluginName="header";var ce=function(t){function n(n){var r;return(r=t.call(this,n)||this).timerId=void 0,r.locked=!1,r.input=e.createRef(),r}i(n,t);var r=n.prototype;return r.click=function(){var e=this;!this.locked&&this.input.current&&(this.locked=!0,this.input.current.value="",this.input.current.click(),this.timerId&&window.clearTimeout(this.timerId),this.timerId=window.setTimeout(function(){e.locked=!1,window.clearTimeout(e.timerId),e.timerId=void 0},200))},r.componentWillUnmount=function(){this.timerId&&window.clearTimeout(this.timerId)},r.render=function(){return e.createElement("input",{type:"file",ref:this.input,accept:this.props.accept,style:{position:"absolute",zIndex:-1,left:0,top:0,width:0,height:0,opacity:0},onChange:this.props.onChange})},n}(e.Component),ue=function(t){function r(r){var i;return(i=t.call(this,r)||this).inputFile=e.createRef(),i.onImageChanged=i.onImageChanged.bind(n(i)),i.handleCustomImageUpload=i.handleCustomImageUpload.bind(n(i)),i.handleImageUpload=i.handleImageUpload.bind(n(i)),i.state={show:!1},i}i(r,t);var o=r.prototype;return o.handleImageUpload=function(){"function"==typeof this.editorConfig.onImageUpload?this.inputFile.current&&this.inputFile.current.click():this.editor.insertMarkdown("image")},o.onImageChanged=function(e){var t=this.editorConfig.onImageUpload;if(t){var n=B(e,t);this.editor.insertPlaceholder(n.placeholder,n.uploaded)}},o.handleCustomImageUpload=function(e){var t=this,n=this.editorConfig.onCustomImageUpload;if(n){var r=n.call(this,e);U(r)&&r.then(function(e){e&&e.url&&t.editor.insertMarkdown("image",{target:e.text,imageUrl:e.url})})}},o.render=function(){var t=this;return!!this.editorConfig.onCustomImageUpload?e.createElement("span",{className:"button button-type-image",title:k.get("btnImage"),onClick:this.handleCustomImageUpload},e.createElement(f,{type:"image"})):e.createElement("span",{className:"button button-type-image",title:k.get("btnImage"),onClick:this.handleImageUpload,style:{position:"relative"}},e.createElement(f,{type:"image"}),e.createElement(ce,{accept:this.editorConfig.imageAccept||"",ref:this.inputFile,onChange:function(e){e.persist(),e.target.files&&e.target.files.length>0&&t.onImageChanged(e.target.files[0])}}))},r}(x);ue.pluginName="image";var de=function(t){function n(e){var n;return(n=t.call(this,e)||this).handleKeyboard={key:"k",keyCode:75,aliasCommand:!0,withKey:["ctrlKey"],callback:function(){return n.editor.insertMarkdown("link")}},n}i(n,t);var r=n.prototype;return r.componentDidMount=function(){this.editorConfig.shortcuts&&this.editor.onKeyboard(this.handleKeyboard)},r.componentWillUnmount=function(){this.editor.offKeyboard(this.handleKeyboard)},r.render=function(){var t=this;return e.createElement("span",{className:"button button-type-link",title:k.get("btnLink"),onClick:function(){return t.editor.insertMarkdown("link")}},e.createElement(f,{type:"link"}))},n}(x);de.pluginName="link";var he=function(t){function n(e){var n;return(n=t.call(this,e)||this).handleKeyboard={key:"7",keyCode:55,withKey:["ctrlKey","shiftKey"],aliasCommand:!0,callback:function(){return n.editor.insertMarkdown("order")}},n}i(n,t);var r=n.prototype;return r.componentDidMount=function(){this.editorConfig.shortcuts&&this.editor.onKeyboard(this.handleKeyboard)},r.componentWillUnmount=function(){this.editor.offKeyboard(this.handleKeyboard)},r.render=function(){var t=this;return e.createElement("span",{className:"button button-type-ordered",title:k.get("btnOrdered"),onClick:function(){return t.editor.insertMarkdown("order")}},e.createElement(f,{type:"list-ordered"}))},n}(x);he.pluginName="list-ordered";var fe=function(t){function n(e){var n;return(n=t.call(this,e)||this).handleKeyboard={key:"8",keyCode:56,withKey:["ctrlKey","shiftKey"],aliasCommand:!0,callback:function(){return n.editor.insertMarkdown("unordered")}},n}i(n,t);var r=n.prototype;return r.componentDidMount=function(){this.editorConfig.shortcuts&&this.editor.onKeyboard(this.handleKeyboard)},r.componentWillUnmount=function(){this.editor.offKeyboard(this.handleKeyboard)},r.render=function(){var t=this;return e.createElement("span",{className:"button button-type-unordered",title:k.get("btnUnordered"),onClick:function(){return t.editor.insertMarkdown("unordered")}},e.createElement(f,{type:"list-unordered"}))},n}(x);fe.pluginName="list-unordered";var pe,me,ge=function(){function e(e){void 0===e&&(e={}),this.record=[],this.recycle=[],this.initValue="";var t=e.maxSize,n=void 0===t?100:t;this.maxSize=n}var t=e.prototype;return t.push=function(e){for(var t=this.record.push(e);this.record.length>this.maxSize;)this.record.shift();return t},t.get=function(){return this.record},t.getLast=function(){var e=this.record.length;return this.record[e-1]},t.undo=function(e){var t=this.record.pop();if(void 0===t)return this.initValue;if(t!==e)return this.recycle.push(t),t;var n=this.record.pop();return void 0===n?(this.recycle.push(t),this.initValue):(this.recycle.push(t),n)},t.redo=function(){var e=this.recycle.pop();if(void 0!==e)return this.push(e),e},t.cleanRedo=function(){this.recycle=[]},t.getUndoCount=function(){return this.undo.length},t.getRedoCount=function(){return this.recycle.length},e}(),ve=function(t){function r(e){var r;return(r=t.call(this,e)||this).handleKeyboards=[],r.lastPop=null,r.handleChange=r.handleChange.bind(n(r)),r.handleRedo=r.handleRedo.bind(n(r)),r.handleUndo=r.handleUndo.bind(n(r)),r.handleKeyboards=[{key:"y",keyCode:89,withKey:["ctrlKey"],callback:r.handleRedo},{key:"z",keyCode:90,withKey:["metaKey","shiftKey"],callback:r.handleRedo},{key:"z",keyCode:90,aliasCommand:!0,withKey:["ctrlKey"],callback:r.handleUndo}],r.logger=new ge({maxSize:r.editorConfig.loggerMaxSize}),r.editor.registerPluginApi("undo",r.handleUndo),r.editor.registerPluginApi("redo",r.handleRedo),r}i(r,t);var o=r.prototype;return o.handleUndo=function(){var e=this.logger.undo(this.editor.getMdValue());void 0!==e&&(this.pause(),this.lastPop=e,this.editor.setText(e),this.forceUpdate())},o.handleRedo=function(){var e=this.logger.redo();void 0!==e&&(this.lastPop=e,this.editor.setText(e),this.forceUpdate())},o.handleChange=function(e,t,n){var r=this;if(this.logger.getLast()!==e&&(null===this.lastPop||this.lastPop!==e)){if(this.logger.cleanRedo(),n)return this.logger.push(e),this.lastPop=null,void this.forceUpdate();this.timerId&&(window.clearTimeout(this.timerId),this.timerId=0),this.timerId=window.setTimeout(function(){r.logger.getLast()!==e&&(r.logger.push(e),r.lastPop=null,r.forceUpdate()),window.clearTimeout(r.timerId),r.timerId=0},this.editorConfig.loggerInterval)}},o.componentDidMount=function(){var e=this;this.editor.on("change",this.handleChange),this.handleKeyboards.forEach(function(t){return e.editor.onKeyboard(t)}),this.logger.initValue=this.editor.getMdValue(),this.forceUpdate()},o.componentWillUnmount=function(){var e=this;this.timerId&&window.clearTimeout(this.timerId),this.editor.off("change",this.handleChange),this.editor.unregisterPluginApi("undo"),this.editor.unregisterPluginApi("redo"),this.handleKeyboards.forEach(function(t){return e.editor.offKeyboard(t)})},o.pause=function(){this.timerId&&(window.clearTimeout(this.timerId),this.timerId=void 0)},o.render=function(){var t=this.logger.getUndoCount()>1||this.logger.initValue!==this.editor.getMdValue(),n=this.logger.getRedoCount()>0;return e.createElement(e.Fragment,null,e.createElement("span",{className:"button button-type-undo "+(t?"":"disabled"),title:k.get("btnUndo"),onClick:this.handleUndo},e.createElement(f,{type:"undo"})),e.createElement("span",{className:"button button-type-redo "+(n?"":"disabled"),title:k.get("btnRedo"),onClick:this.handleRedo},e.createElement(f,{type:"redo"})))},r}(x);ve.pluginName="logger",(me=pe||(pe={}))[me.SHOW_ALL=0]="SHOW_ALL",me[me.SHOW_MD=1]="SHOW_MD",me[me.SHOW_HTML=2]="SHOW_HTML";var ye=function(t){function r(e){var r;return(r=t.call(this,e)||this).handleClick=r.handleClick.bind(n(r)),r.handleChange=r.handleChange.bind(n(r)),r.state={view:r.editor.getView()},r}i(r,t);var o=r.prototype;return o.handleClick=function(){switch(this.next){case pe.SHOW_ALL:this.editor.setView({html:!0,md:!0});break;case pe.SHOW_HTML:this.editor.setView({html:!0,md:!1});break;case pe.SHOW_MD:this.editor.setView({html:!1,md:!0})}},o.handleChange=function(e){this.setState({view:e})},o.componentDidMount=function(){this.editor.on("viewchange",this.handleChange)},o.componentWillUnmount=function(){this.editor.off("viewchange",this.handleChange)},o.getDisplayInfo=function(){switch(this.next){case pe.SHOW_ALL:return{icon:"view-split",title:"All"};case pe.SHOW_HTML:return{icon:"visibility",title:"Preview"};default:return{icon:"keyboard",title:"Editor"}}},o.render=function(){if(this.isDisplay){var t=this.getDisplayInfo();return e.createElement("span",{className:"button button-type-mode",title:k.get("btnMode"+t.title),onClick:this.handleClick},e.createElement(f,{type:t.icon}))}return null},N(r,[{key:"isDisplay",get:function(){var e=this.editorConfig.canView;return!!e&&[e.html,e.md,e.both].filter(function(e){return e}).length>=2}},{key:"next",get:function(){var e=this.editorConfig.canView,t=this.state.view,n=[pe.SHOW_ALL,pe.SHOW_MD,pe.SHOW_HTML];e&&(e.both||n.splice(n.indexOf(pe.SHOW_ALL),1),e.md||n.splice(n.indexOf(pe.SHOW_MD),1),e.html||n.splice(n.indexOf(pe.SHOW_HTML),1));var r=pe.SHOW_MD;if(t.html&&(r=pe.SHOW_HTML),t.html&&t.md&&(r=pe.SHOW_ALL),0===n.length)return r;if(1===n.length)return n[0];var i=n.indexOf(r);return i<n.length-1?n[i+1]:n[0]}}]),r}(x);ye.pluginName="mode-toggle",ye.align="right";var be=function(t){function n(e){var n;(n=t.call(this,e)||this).config={padding:3,width:20,height:20};var r=e.maxRow,i=void 0===r?5:r,o=e.maxCol,a=void 0===o?6:o;return n.state={maxRow:i,maxCol:a,list:n.formatTableModel(i,a)},n}i(n,t);var r=n.prototype;return r.formatTableModel=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),new Array(e).fill(void 0).map(function(e){return new Array(t).fill(0)})},r.calcWrapStyle=function(){var e=this.state,t=e.maxRow,n=e.maxCol,r=this.config,i=r.width,o=r.height,a=r.padding;return{width:(i+a)*n-a+"px",height:(o+a)*t-a+"px"}},r.calcItemStyle=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var n=this.config,r=n.width,i=n.height,o=n.padding;return{top:(i+o)*e+"px",left:(r+o)*t+"px"}},r.getList=function(e,t){return this.state.list.map(function(n,r){return n.map(function(n,i){return r<=e&&i<=t?1:0})})},r.handleHover=function(e,t){this.setState({list:this.getList(e,t)})},r.handleSetTable=function(e,t){var n=this.props.onSetTable;"function"==typeof n&&n({row:e+1,col:t+1})},r.componentDidUpdate=function(e){!1===this.props.visibility&&e.visibility!==this.props.visibility&&this.setState({list:this.getList(-1,-1)})},r.render=function(){var t=this;return e.createElement("ul",{className:"table-list wrap",style:this.calcWrapStyle()},this.state.list.map(function(n,r){return n.map(function(n,i){return e.createElement("li",{className:"list-item "+(1===n?"active":""),key:r+"-"+i,style:t.calcItemStyle(r,i),onMouseOver:t.handleHover.bind(t,r,i),onClick:t.handleSetTable.bind(t,r,i)})})}))},n}(e.Component),we=function(t){function r(e){var r;return(r=t.call(this,e)||this).show=r.show.bind(n(r)),r.hide=r.hide.bind(n(r)),r.state={show:!1},r}i(r,t);var o=r.prototype;return o.show=function(){this.setState({show:!0})},o.hide=function(){this.setState({show:!1})},o.render=function(){var t=this,n=this.editorConfig.table||this.props.config;return e.createElement("span",{className:"button button-type-table",title:k.get("btnTable"),onMouseEnter:this.show,onMouseLeave:this.hide},e.createElement(f,{type:"grid"}),e.createElement(ae,{show:this.state.show,onClose:this.hide},e.createElement(be,{visibility:this.state.show,maxRow:n.maxRow,maxCol:n.maxCol,onSetTable:function(e){return t.editor.insertMarkdown("table",e)}})))},r}(x);we.pluginName="table",we.defaultConfig={maxRow:6,maxCol:6},$.use(se),$.use(te),$.use(ne),$.use(ie),$.use(re),$.use(fe),$.use(he),$.use(X),$.use(Z),$.use(J),$.use(Q),$.use(we),$.use(ue),$.use(de),$.use(ee),$.use(ve),$.use(ye),$.use(oe);export{$ as E};
