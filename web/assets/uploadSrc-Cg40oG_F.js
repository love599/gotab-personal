import{c as e,an as t,F as a,r as l,j as r,w as s,L as n,av as o,B as i,aw as c,a0 as m,E as d,N as h,ao as f,az as u,aD as x,q as p,aG as y,C as j,e as b,D as _,H as w,aH as k,am as S}from"./main-BEv8KsEt.js";import{r as g}from"./transformData-De2ehBJX.js";import{M as v,R as C}from"./myTable-WU5ZHxuI.js";import{C as F}from"./contentLayout-CIrKGV-A.js";import"./MoneyCollectOutlined-CqHTO0eZ.js";import"./MoneyCollectOutlined-4QlEwa2l.js";import"./index-CfG0xZO3.js";import"./AlipayOutlined-B_VSiSn2.js";import"./AlipayOutlined-tZM3mGx9.js";function N(){const h=e.c(43),{key:f,refresh:u}=t(),[x]=a.useForm();let p;h[0]===Symbol.for("react.memo_cache_sentinel")?(p={},h[0]=p):p=h[0];const[y,j]=l.useState(p);let b,_,w,k,S,C,N,I;h[1]===Symbol.for("react.memo_cache_sentinel")?(b={title:"用户",key:"username",width:160,fixed:"left",render:M},_={title:"预览",key:"filePath",width:200,className:"flex-center",render:B},w={title:"资源类型",key:"srcType",width:120,render:z},k={title:"文件类型",key:"fileType",width:120},S={title:"文件大小",key:"fileSize",width:120,render:T},C={title:"文件地址",key:"filePath",width:420,render:P},N={type:"time",title:"上传时间",key:"createdTime",width:200},h[1]=b,h[2]=_,h[3]=w,h[4]=k,h[5]=S,h[6]=C,h[7]=N):(b=h[1],_=h[2],w=h[3],k=h[4],S=h[5],C=h[6],N=h[7]),h[8]!==u?(I=[b,_,w,k,S,C,N,{title:"操作",fixed:"right",width:120,render:(e,t)=>r.jsx(A,{record:t,refresh:u})}],h[8]=u,h[9]=I):I=h[9];const L=I;let O,$,D,H,K,U,G,R,q,E,V,X,Z,J,Q,W,Y;return h[10]!==x?(O=()=>{const e=x.getFieldsValue();e[Math.random()]=!0,j(g(e))},h[10]=x,h[11]=O):O=h[11],h[12]===Symbol.for("react.memo_cache_sentinel")?($={gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gridAutoRows:"32px"},h[12]=$):$=h[12],h[13]===Symbol.for("react.memo_cache_sentinel")?(D=r.jsx(a.Item,{name:"username",children:r.jsx(s,{placeholder:"用户名"})}),h[13]=D):D=h[13],h[14]===Symbol.for("react.memo_cache_sentinel")?(H=r.jsx(a.Item,{name:"filePath",children:r.jsx(s,{placeholder:"文件地址"})}),h[14]=H):H=h[14],h[15]===Symbol.for("react.memo_cache_sentinel")?(K=r.jsxs("div",{className:"gap-3 flex-wrap grid w-full mb-3",style:$,children:[D,H,r.jsx(a.Item,{name:"srcType",children:r.jsx(n,{placeholder:"资源类型",options:[{label:"头像",value:1},{label:"静态壁纸",value:2},{label:"动态壁纸",value:3},{label:"上传的图标",value:4},{label:"自动获取的图标",value:5},{label:"资源库的图标",value:6},{label:"其他图片",value:0}],allowClear:!0})})]}),h[15]=K):K=h[15],h[16]!==x?(U=()=>{x.submit()},h[16]=x,h[17]=U):U=h[17],h[18]===Symbol.for("react.memo_cache_sentinel")?(G=r.jsx(o,{}),h[18]=G):G=h[18],h[19]!==U?(R=r.jsx(i,{type:"primary",onClick:U,icon:G,children:"查询"}),h[19]=U,h[20]=R):R=h[20],h[21]!==x?(q=()=>{x.resetFields();const e={};e[Math.random()]=!0,j(e)},h[21]=x,h[22]=q):q=h[22],h[23]===Symbol.for("react.memo_cache_sentinel")?(E=r.jsx(c,{}),h[23]=E):E=h[23],h[24]!==q?(V=r.jsx(i,{onClick:q,icon:E,children:"重置"}),h[24]=q,h[25]=V):V=h[25],h[26]!==R||h[27]!==V?(X=r.jsxs("div",{className:"flex flex-wrap gap-3",children:[R,V]}),h[26]=R,h[27]=V,h[28]=X):X=h[28],h[29]!==x||h[30]!==X||h[31]!==O?(Z=r.jsxs(a,{className:"w-full",form:x,onFinish:O,children:[K,X]}),h[29]=x,h[30]=X,h[31]=O,h[32]=Z):Z=h[32],h[33]===Symbol.for("react.memo_cache_sentinel")?(J=r.jsx(m,{className:"my-3"}),h[33]=J):J=h[33],h[34]!==y?(Q={searchParams:y},h[34]=y,h[35]=Q):Q=h[35],h[36]!==L||h[37]!==f||h[38]!==Q?(W=r.jsx(v,{columns:L,getListUrl:d.getUploadSrcList,dataKey:"data.list",tableKey:f,params:Q}),h[36]=L,h[37]=f,h[38]=Q,h[39]=W):W=h[39],h[40]!==Z||h[41]!==W?(Y=r.jsxs(F,{children:[Z,J,W]}),h[40]=Z,h[41]=W,h[42]=Y):Y=h[42],Y}function P(e){return r.jsx(h,{color:"blue",onClick:()=>{e&&window.open(p(e),"_blank")},className:"cursor-pointer",icon:r.jsx(y,{}),children:e||"-"})}function T(e){return r.jsx("span",{children:e<1024?`${e}B`:e<1048576?`${(e/1024).toFixed(2)}KB`:e<1073741824?`${(e/1024/1024).toFixed(2)}MB`:`${(e/1024/1024/1024).toFixed(2)}GB`})}function z(e){return r.jsx(h,{color:0===e?"blue":1===e?"green":2===e?"purple":3===e?"cyan":4===e?"red":5===e?"orange":6===e?"magenta":"volcano",children:0===e?"其他图片":1===e?"头像":2===e?"静态壁纸":3===e?"动态壁纸":4===e?"上传的图标":5===e?"自动获取的图标":6===e?"资源库的图标":e})}function B(e){return r.jsx(u,{src:p(e),height:48,fallback:x,loading:"lazy"})}function M(e,t){return r.jsx(h,{color:e||"0"===t.userId?"geekblue":"red",bordered:!1,icon:r.jsx(f,{}),children:e||("0"===t.userId?"游客":"已注销")})}const A=l.memo(t=>{const a=e.c(20),{record:s,refresh:n}=t;let o;a[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],a[0]=o):o=a[0];const[c,m]=l.useState(o);let h;a[1]!==s.id||a[2]!==n?(h=function(){j(1,m);const e=b.getState().user.token;setTimeout(()=>{_({url:d.deleteUploadSrc,token:e,data:{ids:[s.id]}}).then(e=>{200===e.code&&n()}).finally(()=>{w(1,m)})},500)},a[1]=s.id,a[2]=n,a[3]=h):h=a[3];const f=h;let u;a[4]===Symbol.for("react.memo_cache_sentinel")?(u=function(e){fetch(p(e),{headers:new Headers({Authorization:"Bearer "+b.getState().user.token})}).then(I).then(t=>{k.saveAs(t,e.split("/").pop()||"file")}).catch(L)},a[4]=u):u=a[4];const x=u;let y,g,v,F,N,P,T;return a[5]===Symbol.for("react.memo_cache_sentinel")?(y={width:"44px"},a[5]=y):y=a[5],a[6]!==s.filePath?(g=r.jsx(i,{type:"link",size:"small",style:y,onClick:()=>{x(s.filePath)},children:"下载"}),a[6]=s.filePath,a[7]=g):g=a[7],a[8]===Symbol.for("react.memo_cache_sentinel")?(v={width:"44px"},a[8]=v):v=a[8],a[9]!==c[1]?(F=c[1]?r.jsx(C,{}):"删除",a[9]=c[1],a[10]=F):F=a[10],a[11]!==c[1]||a[12]!==F?(N=r.jsx(i,{danger:!0,type:"link",size:"small",disabled:c[1],style:v,children:F}),a[11]=c[1],a[12]=F,a[13]=N):N=a[13],a[14]!==f||a[15]!==N?(P=r.jsx(S,{title:"是否删除附件？",onConfirm:f,children:N}),a[14]=f,a[15]=N,a[16]=P):P=a[16],a[17]!==g||a[18]!==P?(T=r.jsxs("div",{className:"flex flex-wrap",children:[g,P]}),a[17]=g,a[18]=P,a[19]=T):T=a[19],T});function I(e){return e.blob()}function L(){return alert("文件下载失败")}export{N as default};
