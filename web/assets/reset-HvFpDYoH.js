import{r as e,c as s,g as n,t as a,j as t,a2 as l,B as o,k as i,W as r,n as c,q as d,l as m,X as f,b4 as u,J as x,bm as h,S as j,V as p,u as g,d as b,m as y,eo as v,ep as k,eq as C,D as S,bO as _,O as N,bA as w,er as E,es as I,et as D,eu as T,ev as B,ew as L,ex as M,ey as A,bW as P,ez as F,eA as z,eB as H,eC as Y,E as $}from"./requestIdleCallbackPolyfill-CRtcYtqz.js";import{L as q,E as O}from"./index-CF37AyZG.js";import{F as R}from"./fullSpin-DoLB4rVp.js";import"./Overflow-Dw8Kex4x.js";import"./getAllowClear-rD1UM-lP.js";import"./Input-DELR_BSE.js";import"./index-bQRXjpSB.js";function W(e){200===e.code&&e.data&&!x(e.data)&&(h(e.data,!1),setTimeout(G,0))}function G(){j.hide(p)}function K(e){return e.user.token}const J=e.memo(function(){const x=s.c(19),h=n(K),{token:j}=a.useToken();let p;x[0]===Symbol.for("react.memo_cache_sentinel")?(p=[],x[0]=p):p=x[0];const[g,b]=e.useState(p);let y;x[1]===Symbol.for("react.memo_cache_sentinel")?(y=[],x[1]=y):y=x[1];const[v,k]=e.useState(y);let C;x[2]===Symbol.for("react.memo_cache_sentinel")?(C=[],x[2]=C):C=x[2];const[S,_]=e.useState(C);let N;x[3]!==h?(N=function(e){i(e?0:1,b),r({url:c.getBackupList,token:h}).then(e=>{200===e.code&&e.data&&_(e.data)}).finally(()=>{d(e?0:1,b)})},x[3]=h,x[4]=N):N=x[4];const w=N;let E;x[5]!==h?(E=function(e,s){i(e,k),m({url:c.getBackupData,token:h,data:{backupId:s}}).then(W).finally(()=>{d(e,k)})},x[5]=h,x[6]=E):E=x[6];const I=E;let D,T,B,L;return x[7]!==w?(D=()=>{w(!0)},x[7]=w,x[8]=D):D=x[8],x[9]===Symbol.for("react.memo_cache_sentinel")?(T=[],x[9]=T):T=x[9],e.useLayoutEffect(D,T),x[10]===Symbol.for("react.memo_cache_sentinel")?(B=t.jsx(f,{className:"rounded-md mb-2",message:"请您注意，云端仅保存10条数据节点！恢复云端数据后将再次上传数据至云端，以确保数据是最新状态！",banner:!0,type:"info",icon:t.jsx(u,{})}),x[10]=B):B=x[10],x[11]!==S||x[12]!==I||x[13]!==v||x[14]!==w||x[15]!==g[0]||x[16]!==g[1]||x[17]!==j?(L=t.jsxs("div",{className:"min-h-[396px] flex flex-col",children:[B,g[0]?t.jsx(R,{className:"h-[280px]"}):S?.length>0?t.jsxs(t.Fragment,{children:[g[1]?t.jsx(R,{className:"h-[280px]"}):t.jsx(q,{data:S,height:280,itemHeight:56,styles:{verticalScrollBar:{display:"none"}},itemKey:"backupId",children:(e,s)=>t.jsxs("div",{className:"h-14 border-b py-3 flex items-center",style:{borderColor:j.colorBorderSecondary},children:[t.jsxs("p",{children:["云端节点：",e.dataTime]}),t.jsx("div",{className:"flex justify-end flex-1",children:t.jsx(l,{title:"是否确认恢复？",onConfirm:()=>{I(s,e.backupId)},children:t.jsx(o,{size:"small",type:"link",loading:v[s],children:"恢复"})})})]},e.backupId)}),t.jsx("div",{className:"flex flex-wrap justify-end mt-4",children:t.jsx(o,{type:"primary",loading:g[1],onClick:()=>{w(!1)},children:"刷新一下"})})]}):t.jsx("div",{className:"h-full flex-center",children:t.jsx(O,{image:O.PRESENTED_IMAGE_SIMPLE})})]}),x[11]=S,x[12]=I,x[13]=v,x[14]=w,x[15]=g[0],x[16]=g[1],x[17]=j,x[18]=L):L=x[18],L});function U(e){return e.user.userInfo}function V(e){return e.history.history}const X=e.memo(function(){const i=s.c(12),r=g(),{token:c}=a.useToken(),d=n(V),m=n(U);let x,j,p,_;return i[0]!==r||i[1]!==d.length||i[2]!==m?(x=()=>{0===d.length&&r(C({data:S(),timestamp:Date.now(),userId:m.userId||""}))},i[0]=r,i[1]=d.length,i[2]=m,i[3]=x):x=i[3],i[4]!==d?(j=[d],i[4]=d,i[5]=j):j=i[5],e.useEffect(x,j),i[6]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsx(f,{className:"rounded-md mb-2",message:"请您注意，本地记录仅保存20条数据节点！",banner:!0,type:"info",icon:t.jsx(u,{})}),i[6]=p):p=i[6],i[7]!==r||i[8]!==d||i[9]!==c||i[10]!==m?(_=t.jsxs("div",{className:"h-[374px] flex flex-col",children:[p,d.length>0?t.jsxs(t.Fragment,{children:[t.jsx(q,{data:d,height:280,itemHeight:56,styles:{verticalScrollBar:{display:"none"}},itemKey:"timestamp",children:(e,s)=>t.jsxs("div",{className:"h-14 border-b py-3 flex items-center",style:{borderColor:c.colorBorderSecondary},children:[t.jsxs("p",{children:[0===s?"当前节点：":"历史节点：",b(e.timestamp).format("YYYY-MM-DD HH:mm:ss")]}),0!==s?t.jsxs("div",{className:"flex justify-end flex-1",children:[t.jsx(l,{title:"是否确认恢复？",onConfirm:()=>{if(d[s].userId)if(d[s].userId===m.userId){const e=d[s].data;h(e,!1),y.success("恢复成功")}else y.error("该条记录非您所有，禁止恢复");else{const e=d[s].data;h(e,!1),y.success("恢复成功")}},children:t.jsx(o,{size:"small",type:"link",children:"恢复"})}),t.jsx(l,{title:"是否确认删除？",onConfirm:()=>{r(v(s+1)),y.success("删除成功")},children:t.jsx(o,{danger:!0,size:"small",type:"link",children:"删除"})})]}):null]},e.timestamp)}),t.jsx("div",{className:"flex flex-wrap justify-end mt-4",children:t.jsx(l,{title:"是否确认清空？",onConfirm:()=>{r(k()),y.success("清空成功")},children:t.jsx(o,{danger:!0,children:"清空数据"})})})]}):t.jsx("div",{className:"h-full flex-center",children:t.jsx(O,{image:O.PRESENTED_IMAGE_SIMPLE})})]}),i[7]=r,i[8]=d,i[9]=c,i[10]=m,i[11]=_):_=i[11],_});function Q(e,s,n,a,t){return new Promise((l,o)=>{i(e,s),r({url:c.getDefaultData}).then(e=>{200===e.code&&e.data?(x(e.data.data)?t&&(t(),y.success("重置完成")):(h(e.data.data,!1,!1,n),a?(y.success("重置完成，即将刷新页面"),setTimeout(()=>{window.location.reload()},1e3)):y.success("重置完成")),_(e.data.created_at),l(e.data.data)):(y.error("重置失败"),o(new Error("Failed to fetch default data.")))}).catch(e=>{y.error("重置失败"),o(e)}).finally(()=>{d(e,s)})})}const Z=e=>{const n=s.c(10),{type:a,onConfirm:i,label:r,icon:c,loading:d}=e,m=void 0===a?"text":a,f=void 0===r?"重置":r;let u,x,h;return n[0]!==i?(u=()=>{i&&i()},n[0]=i,n[1]=u):u=n[1],n[2]!==c||n[3]!==f||n[4]!==d||n[5]!==m?(x=t.jsx(o,{type:m,danger:!0,icon:c,loading:d,children:f}),n[2]=c,n[3]=f,n[4]=d,n[5]=m,n[6]=x):x=n[6],n[7]!==u||n[8]!==x?(h=t.jsx(l,{title:"是否确认重置？",onConfirm:u,children:x}),n[7]=u,n[8]=x,n[9]=h):h=n[9],h};function ee(){const a=s.c(90),l=g(),{getDefaultDataClear:i}=N(),r=n(te),c=n(ae),d=n(ne);let m;a[0]===Symbol.for("react.memo_cache_sentinel")?(m=[],a[0]=m):m=a[0];const[f,u]=e.useState(m);let h,b,v,C,S;a[1]!==l?(h=()=>{Q(0,u,[{name:"appData"}],void 0,()=>{l(E())})},a[1]=l,a[2]=h):h=a[2],a[3]!==f[0]||a[4]!==h?(b={label:"卡片数据",content:t.jsx(Z,{loading:f[0],onConfirm:h})},a[3]=f[0],a[4]=h,a[5]=b):b=a[5],a[6]!==l?(v=()=>{Q(1,u,[{name:"searchEngineData"}],void 0,()=>{l(I())})},a[6]=l,a[7]=v):v=a[7],a[8]!==f[1]||a[9]!==v?(C={label:"搜索引擎",content:t.jsx(Z,{loading:f[1],onConfirm:v})},a[8]=f[1],a[9]=v,a[10]=C):C=a[10],a[11]!==b||a[12]!==C?(S=[b,C],a[11]=b,a[12]=C,a[13]=S):S=a[13];const _=S;let q,O,R,W,G,K,U,V,X,ee,le,oe,ie,re,ce,de,me,fe,ue;a[14]!==l?(q=()=>{Q(2,u,[{name:"card"}],void 0,()=>{l(D())})},a[14]=l,a[15]=q):q=a[15],a[16]!==f[2]||a[17]!==q?(O={label:"卡片尺寸",content:t.jsx(Z,{loading:f[2],onConfirm:q})},a[16]=f[2],a[17]=q,a[18]=O):O=a[18],a[19]!==l?(R=()=>{Q(3,u,[{name:"openType"}],void 0,()=>{l(T())})},a[19]=l,a[20]=R):R=a[20],a[21]!==f[3]||a[22]!==R?(W={label:"打开方式",content:t.jsx(Z,{loading:f[3],onConfirm:R})},a[21]=f[3],a[22]=R,a[23]=W):W=a[23],a[24]!==l?(G=()=>{Q(4,u,[{name:"clockAndDate"}],void 0,()=>{l(B())})},a[24]=l,a[25]=G):G=a[25],a[26]!==f[4]||a[27]!==G?(K={label:"日期和时间",content:t.jsx(Z,{loading:f[4],onConfirm:G})},a[26]=f[4],a[27]=G,a[28]=K):K=a[28],a[29]!==l?(U=()=>{Q(5,u,[{name:"searchBar"}],void 0,()=>{l(L())})},a[29]=l,a[30]=U):U=a[30],a[31]!==f[5]||a[32]!==U?(V={label:"搜索栏",content:t.jsx(Z,{loading:f[5],onConfirm:U})},a[31]=f[5],a[32]=U,a[33]=V):V=a[33],a[34]!==l?(X=()=>{Q(6,u,[{name:"bottomArea"}],void 0,()=>{l(M())})},a[34]=l,a[35]=X):X=a[35],a[36]!==f[6]||a[37]!==X?(ee={label:"底部区域",content:t.jsx(Z,{loading:f[6],onConfirm:X})},a[36]=f[6],a[37]=X,a[38]=ee):ee=a[38],a[39]!==l?(le=()=>{Q(7,u,[{name:"simpleMode"}],void 0,()=>{l(A())})},a[39]=l,a[40]=le):le=a[40],a[41]!==f[7]||a[42]!==le?(oe={label:"简约模式",content:t.jsx(Z,{loading:f[7],onConfirm:le})},a[41]=f[7],a[42]=le,a[43]=oe):oe=a[43],a[44]!==l?(ie=()=>{Q(8,u,[{name:"wallpaperTheme"}],void 0,()=>{l(P())})},a[44]=l,a[45]=ie):ie=a[45],a[46]!==f[8]||a[47]!==ie?(re={label:"壁纸主题",content:t.jsx(Z,{loading:f[8],onConfirm:ie})},a[46]=f[8],a[47]=ie,a[48]=re):re=a[48],a[49]!==l?(ce=()=>{Q(10,u,[{name:"dock"}],void 0,()=>{l(F())})},a[49]=l,a[50]=ce):ce=a[50],a[51]!==f[10]||a[52]!==ce?(de={label:"Dock 卡片坞",content:t.jsx(Z,{loading:f[10],onConfirm:ce})},a[51]=f[10],a[52]=ce,a[53]=de):de=a[53],a[54]!==l||a[55]!==c||a[56]!==r?(me=()=>{Q(9,u,[{name:"home",blackList:["showMode"]},{name:"swiper",blackList:["activeIndex"]}],void 0,()=>{l(z()),l(H()),l(Y())}),r&&(c?r?.slideToLoop(0):r?.slideTo(0))},a[54]=l,a[55]=c,a[56]=r,a[57]=me):me=a[57],a[58]!==f[9]||a[59]!==me?(fe={label:"其他（排版布局等）",content:t.jsx(Z,{loading:f[9],onConfirm:me})},a[58]=f[9],a[59]=me,a[60]=fe):fe=a[60],a[61]!==K||a[62]!==V||a[63]!==ee||a[64]!==oe||a[65]!==re||a[66]!==de||a[67]!==fe||a[68]!==O||a[69]!==W?(ue=[O,W,K,V,ee,oe,re,de,fe],a[61]=K,a[62]=V,a[63]=ee,a[64]=oe,a[65]=re,a[66]=de,a[67]=fe,a[68]=O,a[69]=W,a[70]=ue):ue=a[70];const xe=ue;let he,je,pe,ge,be,ye,ve;return a[71]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(o,{type:"link",onClick:se,children:"本地"}),je=t.jsx($,{type:"vertical",className:"m-0"}),a[71]=he,a[72]=je):(he=a[71],je=a[72]),a[73]!==d?(pe=t.jsx(w,{groupTitle:"数据回退",items:[{label:"时光机",content:t.jsxs("div",{className:"flex items-center",children:[he,je,t.jsx(o,{type:"link",onClick:()=>{d&&""!==((e,s=" ")=>{if(!e)return"";const n=s.replace(/[\W]{1}/g,"\\$&"),a=new RegExp(`^[${n}]+|[${n}]+$`,"g");return e.replace(a,"")})(d)?j.show(p,{title:"从云端回退",children:t.jsx(J,{})}):y.error("请您先完成登录/注册")},children:"云端"})]})}],bottomDivider:!0,gap:20}),a[73]=d,a[74]=pe):pe=a[74],a[75]!==l||a[76]!==i||a[77]!==c||a[78]!==r?(ge=()=>{i(10,u,e=>{x(e)?(l(E()),l(I()),l(D()),l(T()),l(B()),l(L()),l(M()),l(A()),l(P()),l(z()),l(H()),l(Y()),l(F()),l(k()),y.success("批量重置完成")):y.success("批量重置完成")}),r&&(c?r?.slideToLoop(0):r?.slideTo(0))},a[75]=l,a[76]=i,a[77]=c,a[78]=r,a[79]=ge):ge=a[79],a[80]!==f[10]||a[81]!==ge?(be={label:"全部数据",content:t.jsx(Z,{label:"批量重置",loading:f[10],onConfirm:ge})},a[80]=f[10],a[81]=ge,a[82]=be):be=a[82],a[83]!==_||a[84]!==xe||a[85]!==be?(ye=t.jsx(w,{groupTitle:"配置恢复",items:[be,..._,...xe],gap:20}),a[83]=_,a[84]=xe,a[85]=be,a[86]=ye):ye=a[86],a[87]!==pe||a[88]!==ye?(ve=t.jsx(t.Fragment,{children:t.jsxs("div",{className:"mt-3",children:[pe,ye]})}),a[87]=pe,a[88]=ye,a[89]=ve):ve=a[89],ve}function se(){j.show(p,{title:"从本地回退",children:t.jsx(X,{})})}function ne(e){return e.user.token}function ae(e){return e.swiper.loop}function te(e){return e.stateUtils.mySwiper}export{ee as default,Q as getDefaultData};
