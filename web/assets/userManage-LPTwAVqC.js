import{c as e,r,j as t,B as s,E as l,S as o,V as i,n,i as a,a7 as m,a as c,l as d,k as p,q as u,a2 as h}from"./requestIdleCallbackPolyfill-CRtcYtqz.js";import{T as j}from"./index-BUgDYRIe.js";import{I as f}from"./assets-B8Bi78Vh.js";import{u as x}from"./useFresh-y1lmOc8g.js";import{r as y}from"./transformData-CHYShsQS.js";import{M as w,R as _}from"./myTable-Dl2QuU-Q.js";import{C as b}from"./contentLayout-BpLnk-YD.js";import{F as k}from"./index-BGbaREI1.js";import{I as g}from"./index-B0U6GSVy.js";import{R as S}from"./SearchOutlined-B80XGBAY.js";import{R as C}from"./RedoOutlined-B72iKt02.js";import{T}from"./index-BgMRx6qH.js";import{I}from"./index-BIBYr-gg.js";import"./iconBase-DTCtk8KC.js";import"./index-DzNwoECr.js";import"./useForm-Au5dOVxA.js";import"./FolderOpenOutlined-ComJ5RAY.js";import"./LinkOutlined-DopLHcZx.js";import"./MailOutlined-jCQFQ878.js";import"./Overflow-Dw8Kex4x.js";import"./mediaQueryUtil-DPPPwwPM.js";import"./index-CF37AyZG.js";import"./getAllowClear-rD1UM-lP.js";import"./Input-DELR_BSE.js";import"./MoneyCollectOutlined-CT8yhX_S.js";import"./MoneyCollectOutlined-4QlEwa2l.js";import"./index-DQcu5FOC.js";import"./CaretDownOutlined-DcidQ0ah.js";import"./styleChecker-BRhAwd4B.js";import"./AlipayOutlined-DLlsLZ5r.js";import"./AlipayOutlined-tZM3mGx9.js";import"./useEffectOnce-B3Wa1Mlq.js";import"./useBreakpoint-E2sLeglb.js";import"./index-bQRXjpSB.js";import"./row-pVBpgFkh.js";import"./QuestionCircleOutlined-DSm95oJP.js";import"./TextArea-B5lq4i0U.js";import"./LeftOutlined-D9Sp279J.js";function v(){const a=e.c(50),{key:m,refresh:c}=x(),[d]=k.useForm();let p;a[0]===Symbol.for("react.memo_cache_sentinel")?(p={},a[0]=p):p=a[0];const[u,h]=r.useState(p);let j,f,_,T,I,v,L,M,U,q,R,$;a[1]===Symbol.for("react.memo_cache_sentinel")?(j={title:"用户名",key:"username",width:160,fixed:"left"},T={title:"用户类型",key:"userType",width:120,render:E},I={title:"头像",key:"avatar",width:120,render:F},v={title:"昵称",key:"nickname",width:160},L={type:"sex",title:"性别",key:"sex",width:60},M={title:"邮箱",key:"email",width:200,render:z},U={title:"手机号",key:"phone",width:160,render:P},q={title:"称号",key:"appellation",width:200,render:O},R={title:"称号状态",key:"appellation_status",width:120,render:A},f={type:"time",title:"注册时间",key:"createdTime",width:200},_={type:"time",title:"更新时间",key:"updatedTime",width:200},a[1]=j,a[2]=f,a[3]=_,a[4]=T,a[5]=I,a[6]=v,a[7]=L,a[8]=M,a[9]=U,a[10]=q,a[11]=R):(j=a[1],f=a[2],_=a[3],T=a[4],I=a[5],v=a[6],L=a[7],M=a[8],U=a[9],q=a[10],R=a[11]),a[12]!==c?($=[j,T,I,v,L,M,U,q,R,f,_,{title:"操作",fixed:"right",width:180,render:(e,r)=>t.jsx(Z,{record:r,refresh:c})}],a[12]=c,a[13]=$):$=a[13];const B=$;let K,D,Q,V,W,G,H,J,X,Y,ee,re,te,se,le,oe,ie,ne;return a[14]!==d?(K=()=>{const e=d.getFieldsValue();e[Math.random()]=!0,h(y(e))},a[14]=d,a[15]=K):K=a[15],a[16]===Symbol.for("react.memo_cache_sentinel")?(D={gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gridAutoRows:"32px"},a[16]=D):D=a[16],a[17]===Symbol.for("react.memo_cache_sentinel")?(Q=t.jsx(k.Item,{name:"username",children:t.jsx(g,{placeholder:"用户名"})}),a[17]=Q):Q=a[17],a[18]===Symbol.for("react.memo_cache_sentinel")?(V=t.jsx(k.Item,{name:"email",children:t.jsx(g,{placeholder:"邮箱"})}),a[18]=V):V=a[18],a[19]===Symbol.for("react.memo_cache_sentinel")?(W=t.jsxs("div",{className:"gap-3 flex-wrap grid w-full mb-3",style:D,children:[Q,V,t.jsx(k.Item,{name:"phone",children:t.jsx(g,{placeholder:"手机号"})})]}),a[19]=W):W=a[19],a[20]!==d?(G=()=>{d.submit()},a[20]=d,a[21]=G):G=a[21],a[22]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx(S,{}),a[22]=H):H=a[22],a[23]!==G?(J=t.jsx(s,{type:"primary",onClick:G,icon:H,children:"查询"}),a[23]=G,a[24]=J):J=a[24],a[25]!==d?(X=()=>{d.resetFields();const e={};e[Math.random()]=!0,h(e)},a[25]=d,a[26]=X):X=a[26],a[27]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx(C,{}),a[27]=Y):Y=a[27],a[28]!==X?(ee=t.jsx(s,{onClick:X,icon:Y,children:"重置"}),a[28]=X,a[29]=ee):ee=a[29],a[30]!==J||a[31]!==ee?(re=t.jsxs("div",{className:"flex flex-wrap gap-3",children:[J,ee]}),a[30]=J,a[31]=ee,a[32]=re):re=a[32],a[33]!==d||a[34]!==K||a[35]!==re?(te=t.jsxs(k,{className:"w-full",form:d,onFinish:K,children:[W,re]}),a[33]=d,a[34]=K,a[35]=re,a[36]=te):te=a[36],a[37]===Symbol.for("react.memo_cache_sentinel")?(se=t.jsx(l,{className:"my-3"}),a[37]=se):se=a[37],a[38]!==c?(le=t.jsx("div",{className:"mb-3",children:t.jsx(s,{type:"primary",onClick:()=>{o.show(i,{title:"新增用户",children:t.jsx(N,{refresh:c})})},children:"新增用户"})}),a[38]=c,a[39]=le):le=a[39],a[40]!==u?(oe={searchParams:u},a[40]=u,a[41]=oe):oe=a[41],a[42]!==B||a[43]!==m||a[44]!==oe?(ie=t.jsx(w,{columns:B,getListUrl:n.getAwaitingApprovalUserAppellationList,dataKey:"data.list",rowKey:"userId",tableKey:m,params:oe}),a[42]=B,a[43]=m,a[44]=oe,a[45]=ie):ie=a[45],a[46]!==te||a[47]!==le||a[48]!==ie?(ne=t.jsxs(b,{children:[te,se,le,ie]}),a[46]=te,a[47]=le,a[48]=ie,a[49]=ne):ne=a[49],ne}function A(e,r){return t.jsx(T,{color:0===e?r.appellation?"blue":"default":1===e?"green":"red",children:0===e?r.appellation?"待审核":"未申请":1===e?"已荣获":"被拒绝"})}function O(e){return e?t.jsx(T,{className:"flex items-center gap-1 w-fit",icon:t.jsx(j,{}),children:e||"-"}):"-"}function P(e){return t.jsx(s,{type:"text",size:"small",onClick:()=>{m(e,!0)},children:e||"-"})}function z(e){return t.jsx(s,{type:"text",size:"small",onClick:()=>{m(e,!0)},children:e||"-"})}function F(e){return e?t.jsx(I,{src:a(e),height:48,fallback:f,loading:"lazy"}):"-"}function E(e){return t.jsx(T,{bordered:!1,color:0===e?"blue":"volcano",children:1===e?"管理员":"普通用户"})}const N=l=>{const a=e.c(13),{refresh:m}=l,[p]=k.useForm(),[u,h]=r.useState(!1);let j;a[0]!==m?(j=function(e){h(!0);const r=c.getState().user.token;d({url:n.addUser,token:r,data:e}).then(e=>{200===e.code&&(o.hide(i),m&&m())}).finally(()=>{h(!1)})},a[0]=m,a[1]=j):j=a[1];const f=j;let x,y,w,_,b,S,C;return a[2]===Symbol.for("react.memo_cache_sentinel")?(x={flex:"82px"},a[2]=x):x=a[2],a[3]===Symbol.for("react.memo_cache_sentinel")?(y=t.jsx(k.Item,{name:"username",label:"用户名",required:!0,rules:[{validator:(e,r)=>""!==r&&r?/^[a-zA-Z]/.test(r)?/^[a-zA-Z][a-zA-Z0-9_-]*$/.test(r)?r.length<3||r.length>20?Promise.reject(new Error("用户名长度必须在3到20位之间")):Promise.resolve():Promise.reject(new Error("用户名只能包含字母、数字、下划线或短横线")):Promise.reject(new Error("用户名必须以字母开头")):Promise.reject(new Error("请输入用户名"))}],children:t.jsx(g,{placeholder:"用户名",allowClear:!0,maxLength:20})}),a[3]=y):y=a[3],a[4]===Symbol.for("react.memo_cache_sentinel")?(w=t.jsx(k.Item,{label:"密码",name:"password",required:!0,rules:[{validator:(e,r)=>""!==r&&r?/^[a-zA-Z0-9_\-!@#$%^&*()+={}[\]:;"'<>.,?/~`|]+$/.test(r)?r.length<6||r.length>32?Promise.reject(new Error("密码长度必须在6到32位之间")):Promise.resolve():Promise.reject(new Error("密码只能包含字母、数字、下划线、短横线以及其他常用特殊字符")):Promise.reject(new Error("请输入密码"))}],children:t.jsx(g.Password,{autoComplete:"new-password",placeholder:"密码",allowClear:!0,maxLength:32})}),a[4]=w):w=a[4],a[5]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx(k.Item,{label:"邮箱",name:"email",rules:[{validator(e,r){if(!r)return Promise.resolve();return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(r)?Promise.resolve():Promise.reject(new Error("请输入有效的邮箱地址"))}}],children:t.jsx(g,{placeholder:"邮箱",allowClear:!0})}),a[5]=_):_=a[5],a[6]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx(s,{onClick:L,children:"取消"}),a[6]=b):b=a[6],a[7]!==u?(S=t.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[b,t.jsx(s,{type:"primary",htmlType:"submit",loading:u,children:"新增用户"})]}),a[7]=u,a[8]=S):S=a[8],a[9]!==p||a[10]!==f||a[11]!==S?(C=t.jsx(t.Fragment,{children:t.jsxs(k,{form:p,autoComplete:"off",variant:"filled",labelCol:x,onFinish:f,children:[y,w,_,S]})}),a[9]=p,a[10]=f,a[11]=S,a[12]=C):C=a[12],C},Z=r.memo(l=>{const o=e.c(35),{record:i,refresh:a}=l;let m;o[0]===Symbol.for("react.memo_cache_sentinel")?(m=[],o[0]=m):m=o[0];const[j,f]=r.useState(m);let x;o[1]!==i.userId||o[2]!==i.userType||o[3]!==a?(x=function(e){p(e,f);const r=c.getState().user.token;setTimeout(()=>{d({url:n.setUserType,token:r,data:{userId:i.userId,type:1===i.userType?0:1}}).then(e=>{200===e.code&&a()}).finally(()=>{u(e,f)})},500)},o[1]=i.userId,o[2]=i.userType,o[3]=a,o[4]=x):x=o[4];const y=x;let w;o[5]!==i.userId||o[6]!==a?(w=function(){p(2,f);const e=c.getState().user.token;setTimeout(()=>{d({url:n.deleteUser,token:e,data:{userId:i.userId}}).then(e=>{200===e.code&&a()}).finally(()=>{u(2,f)})},500)},o[5]=i.userId,o[6]=a,o[7]=w):w=o[7];const b=w,k=0===i.userType?"是否设为管理员？":"是否取消管理员？";let g;o[8]!==y||o[9]!==i.userType?(g=()=>{y(0===i.userType?0:1)},o[8]=y,o[9]=i.userType,o[10]=g):g=o[10];const S=1===i.userType;let C,T,I,v,A,O,P,z,F;return o[11]===Symbol.for("react.memo_cache_sentinel")?(C={width:"86px"},o[11]=C):C=o[11],o[12]!==j[0]||o[13]!==i.userType?(T=j[0]?t.jsx(_,{}):0===i.userType?"设为管理员":"取消管理员",o[12]=j[0],o[13]=i.userType,o[14]=T):T=o[14],o[15]!==j[0]||o[16]!==S||o[17]!==T?(I=t.jsx(s,{danger:S,type:"link",size:"small",disabled:j[0],style:C,children:T}),o[15]=j[0],o[16]=S,o[17]=T,o[18]=I):I=o[18],o[19]!==k||o[20]!==g||o[21]!==I?(v=t.jsx(h,{title:k,onConfirm:g,children:I}),o[19]=k,o[20]=g,o[21]=I,o[22]=v):v=o[22],o[23]===Symbol.for("react.memo_cache_sentinel")?(A={root:{maxWidth:"200px"}},o[23]=A):A=o[23],o[24]!==j[2]?(O=j[2]?t.jsx(_,{}):"注销",o[24]=j[2],o[25]=O):O=o[25],o[26]!==j[2]||o[27]!==O?(P=t.jsx(s,{danger:!0,type:"link",size:"small",disabled:j[2],children:O}),o[26]=j[2],o[27]=O,o[28]=P):P=o[28],o[29]!==b||o[30]!==P?(z=t.jsx(h,{title:"是否确认注销用户？将清空用户所有数据！",onConfirm:b,styles:A,children:P}),o[29]=b,o[30]=P,o[31]=z):z=o[31],o[32]!==z||o[33]!==v?(F=t.jsxs("div",{className:"flex flex-wrap",children:[v,z]}),o[32]=z,o[33]=v,o[34]=F):F=o[34],F});function L(){o.hide(i)}export{v as default};
