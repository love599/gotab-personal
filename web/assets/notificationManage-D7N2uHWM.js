import{c as e,an as t,j as s,r as n,B as i,aa as a,O as l,a0 as o,ap as r,aq as c,E as d,N as m,ao as u,F as h,w as f,C as x,e as j,D as y,H as p,ar as k,aj as _,as as b,at as g,am as S,G as w,z as N}from"./main-B_h69F6u.js";import{E as C}from"./index-Bnhp12NW.js";import{M as v,R as I}from"./myTable-BvVRYsPR.js";import{C as T}from"./contentLayout-CsifLihB.js";import{R as O}from"./ReloadOutlined-BzTjOLJF.js";import"./transformData-DIunLHGi.js";import"./MoneyCollectOutlined-c4wPWSqm.js";import"./MoneyCollectOutlined-4QlEwa2l.js";import"./index-X6TwNYn8.js";import"./AlipayOutlined-DVgcxLOA.js";import"./AlipayOutlined-tZM3mGx9.js";function z(){const n=e.c(21),{key:m,refresh:u}=t();let h,f,x,j,y,p;n[0]===Symbol.for("react.memo_cache_sentinel")?(h={title:"创建人",key:"username",width:160,fixed:"left",render:q},f={title:"状态",key:"status",width:80,render:F},x={title:"标题",key:"title",width:200},j={title:"内容",key:"content",width:400},y={type:"time",title:"创建时间",key:"notice_time",width:200},n[0]=h,n[1]=f,n[2]=x,n[3]=j,n[4]=y):(h=n[0],f=n[1],x=n[2],j=n[3],y=n[4]),n[5]!==u?(p=[h,f,x,j,y,{title:"操作",fixed:"right",width:220,render:(e,t)=>s.jsx(L,{record:t,refresh:u})}],n[5]=u,n[6]=p):p=n[6];const k=p;let _,b,g,S,w,N,C;return n[7]===Symbol.for("react.memo_cache_sentinel")?(_=s.jsx(O,{}),n[7]=_):_=n[7],n[8]!==u?(b=s.jsx(i,{type:"primary",icon:_,onClick:()=>{u()},children:"刷新列表"}),n[8]=u,n[9]=b):b=n[9],n[10]===Symbol.for("react.memo_cache_sentinel")?(g=s.jsx(a,{type:"warning",description:s.jsxs(s.Fragment,{children:[s.jsx(l,{className:"mr-1"}),"只会通知最新一条启用的公告！公告新增后需要二次确认是否发布，并且一天只可发布一次公告，以便保证用户体验！"]}),className:"mt-3 p-1 px-3 text-xs font-normal w-full"}),S=s.jsx(o,{className:"my-3"}),n[10]=g,n[11]=S):(g=n[10],S=n[11]),n[12]!==u?(w=s.jsx("div",{className:"mb-3",children:s.jsx(i,{type:"primary",onClick:()=>{r.show(c,{title:"新增公告",children:s.jsx(M,{refresh:u,type:"add"}),width:720})},children:"新增公告"})}),n[12]=u,n[13]=w):w=n[13],n[14]!==k||n[15]!==m?(N=s.jsx(v,{columns:k,getListUrl:d.getNoticeList,dataKey:"data.list",tableKey:m}),n[14]=k,n[15]=m,n[16]=N):N=n[16],n[17]!==w||n[18]!==N||n[19]!==b?(C=s.jsxs(T,{children:[b,g,S,w,N]}),n[17]=w,n[18]=N,n[19]=b,n[20]=C):C=n[20],C}function F(e){return s.jsx(m,{color:0===e?"blue":1===e?"green":"red",children:0===e?"待审核":1===e?"正常":"停用"})}function q(e){return s.jsx(m,{color:e?"geekblue":"red",bordered:!1,icon:s.jsx(u,{}),children:e||"已注销"})}const L=n.memo(t=>{const a=e.c(43),{record:l,refresh:o}=t;let m;a[0]===Symbol.for("react.memo_cache_sentinel")?(m=[],a[0]=m):m=a[0];const[u,h]=n.useState(m);let f;a[1]!==l.id||a[2]!==o?(f=function(){x(0,h);const e=j.getState().user.token;setTimeout(()=>{y({url:d.rejectNotice,token:e,data:{id:l.id}}).then(e=>{200===e.code&&o()}).finally(()=>{p(0,h)})},500)},a[1]=l.id,a[2]=o,a[3]=f):f=a[3];const w=f;let N;a[4]!==l.id||a[5]!==o?(N=function(){x(0,h);const e=j.getState().user.token;setTimeout(()=>{y({url:d.confirmNotice,token:e,data:{id:l.id}}).then(e=>{200===e.code&&o()}).finally(()=>{p(0,h)})},500)},a[4]=l.id,a[5]=o,a[6]=N):N=a[6];const C=N;let v;a[7]!==l.id||a[8]!==o?(v=function(){x(1,h);const e=j.getState().user.token;setTimeout(()=>{y({url:d.deleteNotice,token:e,data:{id:l.id}}).then(e=>{200===e.code&&o()}).finally(()=>{p(1,h)})},500)},a[7]=l.id,a[8]=o,a[9]=v):v=a[9];const T=v;let O;a[10]!==l.content||a[11]!==l.title?(O=function(){k.open({closeIcon:s.jsx("div",{className:"my-handle-icon",children:s.jsx(b,{icon:s.jsx(g,{})})}),message:l.title,description:s.jsx(_,{content:l.content}),duration:null})},a[10]=l.content,a[11]=l.title,a[12]=O):O=a[12];const z=O;let F,q;a[13]!==z?(F=s.jsx(i,{type:"link",size:"small",onClick:z,children:"预览"}),a[13]=z,a[14]=F):F=a[14],a[15]!==l||a[16]!==o?(q=s.jsx(i,{type:"link",size:"small",onClick:()=>{r.show(c,{title:"编辑公告",children:s.jsx(M,{editItem:l,type:"edit",refresh:o}),width:720})},children:"编辑"}),a[15]=l,a[16]=o,a[17]=q):q=a[17];const L=0===l.status||2===l.status?"是否确认发布？":"是否确认停用？",R=0===l.status||2===l.status?C:w;let A,D,E,H,K,U,B,G,P;return a[18]===Symbol.for("react.memo_cache_sentinel")?(A={width:"44px"},a[18]=A):A=a[18],a[19]!==u[0]||a[20]!==l.status?(D=u[0]?s.jsx(I,{}):0===l.status||2===l.status?"发布":"停用",a[19]=u[0],a[20]=l.status,a[21]=D):D=a[21],a[22]!==u[0]||a[23]!==D?(E=s.jsx(i,{type:"link",size:"small",disabled:u[0],style:A,children:D}),a[22]=u[0],a[23]=D,a[24]=E):E=a[24],a[25]!==E||a[26]!==L||a[27]!==R?(H=s.jsx(S,{title:L,onConfirm:R,children:E}),a[25]=E,a[26]=L,a[27]=R,a[28]=H):H=a[28],a[29]===Symbol.for("react.memo_cache_sentinel")?(K={width:"44px"},a[29]=K):K=a[29],a[30]!==u[1]?(U=u[1]?s.jsx(I,{}):"删除",a[30]=u[1],a[31]=U):U=a[31],a[32]!==u[1]||a[33]!==U?(B=s.jsx(i,{danger:!0,type:"link",size:"small",disabled:u[1],style:K,children:U}),a[32]=u[1],a[33]=U,a[34]=B):B=a[34],a[35]!==T||a[36]!==B?(G=s.jsx(S,{title:"是否确认删除？",onConfirm:T,children:B}),a[35]=T,a[36]=B,a[37]=G):G=a[37],a[38]!==H||a[39]!==G||a[40]!==F||a[41]!==q?(P=s.jsxs("div",{className:"flex flex-wrap",children:[F,q,H,G]}),a[38]=H,a[39]=G,a[40]=F,a[41]=q,a[42]=P):P=a[42],P}),M=t=>{const a=e.c(23),{editItem:l,refresh:o,type:m}=t,u=void 0===m?"add":m,[x]=h.useForm(),[p,k]=n.useState(!1),[_,b]=n.useState(l?.content);let g;a[0]===Symbol.for("react.memo_cache_sentinel")?(g=function(e){const t=j.getState().user.token;return new Promise(s=>{y({url:d.uploadImage,token:t,data:w({file:e})}).then(e=>{200===e.code&&e.data&&s(e.data.image_url)})})},a[0]=g):g=a[0];const S=g;let v;a[1]!==l?.id||a[2]!==_||a[3]!==o||a[4]!==u?(v=function(e){const t=j.getState().user.token;if(!_.trim())return void N.error("请输入公告内容");const s={title:e.title,content:_};k(!0),setTimeout(()=>{y({url:"add"===u?d.addNotice:d.editNotice,token:t,data:"add"===u?s:{id:l?.id,...s}}).then(e=>{200===e.code&&(o(),r.hide(c))}).finally(()=>{k(!1)})},500)},a[1]=l?.id,a[2]=_,a[3]=o,a[4]=u,a[5]=v):v=a[5];const I=v;let T,O,z,F,q,L,M;a[6]===Symbol.for("react.memo_cache_sentinel")?(T={flex:"82px"},a[6]=T):T=a[6],a[7]===Symbol.for("react.memo_cache_sentinel")?(O=s.jsx(h.Item,{name:"title",label:"公告标题",required:!0,rules:[{required:!0}],children:s.jsx(f,{placeholder:"公告标题"})}),z=s.jsx(h.Item,{label:"公告内容",required:!0}),a[7]=O,a[8]=z):(O=a[7],z=a[8]),a[9]===Symbol.for("react.memo_cache_sentinel")?(F={height:"calc(300px)"},q=e=>{b(e.text)},a[9]=F,a[10]=q):(F=a[9],q=a[10]),a[11]!==_?(L=s.jsx(C,{className:"flex-1 -mt-4 mb-6",style:F,onChange:q,value:_,renderHTML:R,onImageUpload:S}),a[11]=_,a[12]=L):L=a[12],a[13]===Symbol.for("react.memo_cache_sentinel")?(M=s.jsx(i,{onClick:A,children:"取消"}),a[13]=M):M=a[13];const D="add"===u?"新增公告":"保存编辑";let E,H;return a[14]!==p||a[15]!==D?(E=s.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[M,s.jsx(i,{type:"primary",htmlType:"submit",loading:p,children:D})]}),a[14]=p,a[15]=D,a[16]=E):E=a[16],a[17]!==l||a[18]!==x||a[19]!==I||a[20]!==E||a[21]!==L?(H=s.jsx(s.Fragment,{children:s.jsxs(h,{form:x,autoComplete:"off",variant:"filled",initialValues:l,labelCol:T,onFinish:I,children:[O,z,L,E]})}),a[17]=l,a[18]=x,a[19]=I,a[20]=E,a[21]=L,a[22]=H):H=a[22],H};function R(e){return s.jsx(_,{content:e,replace:!1})}function A(){r.hide(c)}export{z as default};
