import{r as e,I as s,c as l,t as a,u as n,h as r,y as t,aH as o,j as i,U as c,w as d,k as m,m as u,a2 as h,B as p,bh as f,b3 as x,b4 as j,a5 as b,eI as g,cH as y,x as v,bL as C,n as S,q as _,F as O,eJ as k,bC as w,o as N}from"./requestIdleCallbackPolyfill-CVD_37F6.js";import{u as F}from"./useForm-LHSdzXb2.js";import{v as I,J as R,i as P,h as E}from"./myFolderModal-nYdHvIPa.js";import{s as T}from"./assets-B8Bi78Vh.js";import{e as B,d as H}from"./sortableJsUtils-BIRJp6FM.js";import{H as U}from"./handleButton-B67gTNrZ.js";import{F as z}from"./index-G59xOF6l.js";import{I as L}from"./index-BANcGcmd.js";import{A as q,M as A,a as M}from"./MergeOutlined-4ett1hjm.js";import{R as D}from"./CheckCircleOutlined-DNATA2dC.js";import{I as G}from"./index-CHK4hTbV.js";import{R as J}from"./StopOutlined-7H0bARp2.js";import{R as V}from"./PlusOutlined-CR8Y6HKc.js";import{b as K}from"./useIsSmallScreen-BzHKZBJS.js";import{R as Q}from"./CloudUploadOutlined-DT2q3q8c.js";import{R as W}from"./QuestionCircleOutlined-BSFc9XKj.js";function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},Y.apply(this,arguments)}const $=(l,a)=>e.createElement(s,Y({},l,{ref:a,icon:q})),X=e.forwardRef($);function Z(){return Z=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},Z.apply(this,arguments)}const ee=(l,a)=>e.createElement(s,Z({},l,{ref:a,icon:A})),se=e.forwardRef(ee);function le(){return le=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},le.apply(this,arguments)}const ae=(l,a)=>e.createElement(s,le({},l,{ref:a,icon:M})),ne=e.forwardRef(ae),{useToken:re}=a;function te(){const s=l.c(101),{token:a}=re(),q=n(),A=r(pe),M=r(he),Y=r(ue),$=r(me),Z=r(de);let ee;s[0]!==Y?(ee=t(Y),s[0]=Y,s[1]=ee):ee=s[1];const[le,ae]=e.useState(ee),[te,fe]=e.useState(),[xe]=F(),[je,be]=e.useState(null),ge=r(ce);let ye;s[2]===Symbol.for("react.memo_cache_sentinel")?(ye={gridTemplateColumns:"repeat(auto-fill, minmax(110px,1fr)",gridAutoRows:"100px",rowGap:12,columnGap:12,display:"grid",justifyContent:"center",gridAutoFlow:"dense",width:"100%"},s[2]=ye):ye=s[2];const ve=ye;let Ce,Se,_e,Oe,ke,we,Ne;s[3]!==le||s[4]!==Y?(Ce=()=>{b(Y,le)||ae(t(Y))},s[3]=le,s[4]=Y,s[5]=Ce):Ce=s[5],s[6]!==Y?(Se=[Y],s[6]=Y,s[7]=Se):Se=s[7],o(Ce,Se),s[8]!==q||s[9]!==le?(_e=()=>{q(g(t(le)))},s[8]=q,s[9]=le,s[10]=_e):_e=s[10],s[11]!==le?(Oe=[le],s[11]=le,s[12]=Oe):Oe=s[12],o(_e,Oe),s[13]!==te?.icon||s[14]!==te?.label||s[15]!==te?.urlFormat||s[16]!==xe?(ke=()=>{xe.setFieldsValue({label:te?.label,icon:te?.icon,urlFormat:te?.urlFormat})},s[13]=te?.icon,s[14]=te?.label,s[15]=te?.urlFormat,s[16]=xe,s[17]=ke):ke=s[17],s[18]!==te?(we=[te],s[18]=te,s[19]=we):we=s[19],o(ke,we),s[20]!==te||s[21]!==xe||s[22]!==le?(Ne=function(e){if(e.icon&&(e.icon=y(e.icon,"https://")),te){const s=B(te.id,le,{...te,...e});ae(s),fe(void 0),u.success("编辑成功")}else ae([...le,{...e,id:v(),enable:!0}]),fe(void 0),u.success("新增成功");xe.resetFields()},s[20]=te,s[21]=xe,s[22]=le,s[23]=Ne):Ne=s[23];const Fe=Ne,[Ie,Re]=e.useState(!1),Pe=te?.icon||T;let Ee,Te,Be,He,Ue,ze,Le,qe;s[24]!==Pe?(Ee=i.jsx("div",{className:"flex justify-center items-center gap-3 pb-3",children:i.jsx("div",{className:"rounded-xl w-[52px] h-[52px] flex-center ",children:i.jsx(G,{src:Pe,loading:"lazy",alt:"search-engine-icon",className:"w-[52px] h-[52px]",fallback:T,preview:!1})})}),s[24]=Pe,s[25]=Ee):Ee=s[25],s[26]===Symbol.for("react.memo_cache_sentinel")?(Te={flex:"58px"},s[26]=Te):Te=s[26],s[27]!==te?(Be=e=>{te&&fe({...te,...e})},s[27]=te,s[28]=Be):Be=s[28],s[29]===Symbol.for("react.memo_cache_sentinel")?(He=[{required:!0,message:"请输入搜索引擎名称"}],s[29]=He):He=s[29],s[30]===Symbol.for("react.memo_cache_sentinel")?(Ue=i.jsx(z.Item,{required:!0,rules:He,label:"名称",name:"label",children:i.jsx(L,{placeholder:"搜索引擎名称",allowClear:!0,maxLength:20})}),s[30]=Ue):Ue=s[30],s[31]===Symbol.for("react.memo_cache_sentinel")?(ze=[{validator:(e,s)=>new Promise((e,l)=>{s?C(s)?s.includes("%s")?e(""):l("请输入包含%s的地址（用“%s”代替搜索词）"):l("请输入正确的url地址"):l("请输入搜索引擎地址")})}],s[31]=ze):ze=s[31],s[32]===Symbol.for("react.memo_cache_sentinel")?(Le=i.jsx(z.Item,{required:!0,rules:ze,label:"地址",name:"urlFormat",children:i.jsx(L,{placeholder:"搜索引擎地址，用“%s”代替搜索词",allowClear:!0,maxLength:255})}),s[32]=Le):Le=s[32],s[33]===Symbol.for("react.memo_cache_sentinel")?(qe=[{validator:(e,s)=>s&&s.length>200?Promise.reject("网站图标不能超过200个字符"):Promise.resolve()}],s[33]=qe):qe=s[33];const Ae=!ge;let Me,De,Ge,Je,Ve,Ke;s[34]!==xe||s[35]!==ge?(Me=e=>e.size>204800?(u.error("图标大小不能超过200KB！"),!1):(Re(!0),S({url:N.uploadIcon,token:ge,data:_({file:e})}).then(e=>{200===e.code&&e.data&&xe.setFieldValue("icon",e.data.icon_url)}).finally(()=>{Re(!1)}),!1),s[34]=xe,s[35]=ge,s[36]=Me):Me=s[36],s[37]!==ge?(De=()=>{ge||u.error("请您先完成登录/注册")},s[37]=ge,s[38]=De):De=s[38],s[39]===Symbol.for("react.memo_cache_sentinel")?(Ge=i.jsx(Q,{}),s[39]=Ge):Ge=s[39],s[40]!==Ie||s[41]!==De?(Je=i.jsx(p,{onClick:De,loading:Ie,type:"text",className:"rounded-none",children:"上传",icon:Ge}),s[40]=Ie,s[41]=De,s[42]=Je):Je=s[42],s[43]!==Ae||s[44]!==Me||s[45]!==Je?(Ve=i.jsx(z.Item,{label:"图标",name:"icon",rules:qe,children:i.jsx(L,{placeholder:"图标地址",allowClear:!0,addonAfter:i.jsx(c,{disabled:Ae,accept:".png, .jpg, .jpeg, .svg, .webp, .ico",showUploadList:!1,beforeUpload:Me,children:Je})})}),s[43]=Ae,s[44]=Me,s[45]=Je,s[46]=Ve):Ve=s[46],s[47]!==te?(Ke=te?i.jsx(p,{danger:!0,onClick:()=>{fe(void 0)},children:"取消"}):null,s[47]=te,s[48]=Ke):Ke=s[48];const Qe=te?void 0:"120px";let We;s[49]!==Qe?(We={minWidth:Qe},s[49]=Qe,s[50]=We):We=s[50];const Ye=te?"保存":"新增";let $e,Xe,Ze,es,ss,ls,as,ns,rs,ts,os;s[51]!==We||s[52]!==Ye?($e=i.jsx(p,{htmlType:"submit",type:"primary",style:We,children:Ye}),s[51]=We,s[52]=Ye,s[53]=$e):$e=s[53],s[54]!==Ke||s[55]!==$e?(Xe=i.jsxs("div",{className:"flex w-full justify-center gap-3",children:[Ke,$e]}),s[54]=Ke,s[55]=$e,s[56]=Xe):Xe=s[56],s[57]!==xe||s[58]!==Fe||s[59]!==Be||s[60]!==Ve||s[61]!==Xe?(Ze=i.jsx("div",{className:"flex-1",children:i.jsxs(z,{autoComplete:"off",form:xe,variant:"filled",labelCol:Te,onFinish:Fe,onValuesChange:Be,children:[Ue,Le,Ve,Xe]})}),s[57]=xe,s[58]=Fe,s[59]=Be,s[60]=Ve,s[61]=Xe,s[62]=Ze):Ze=s[62],s[63]!==Ee||s[64]!==Ze?(es=i.jsxs("div",{className:"flex gap-3 pt-3 relative flex-col ",children:[Ee,Ze]}),s[63]=Ee,s[64]=Ze,s[65]=es):es=s[65],s[66]===Symbol.for("react.memo_cache_sentinel")?(ss=i.jsx(O,{}),s[66]=ss):ss=s[66],s[67]===Symbol.for("react.memo_cache_sentinel")?(ls=[{}],s[67]=ls):ls=s[67],s[68]!==q?(as=e=>{q(k(e))},s[68]=q,s[69]=as):as=s[69],s[70]!==A||s[71]!==as?(ns=i.jsx(R,{checkedChildren:"群搜模式",unCheckedChildren:"单搜模式",checked:A,onChange:as}),s[70]=A,s[71]=as,s[72]=ns):ns=s[72],s[73]===Symbol.for("react.memo_cache_sentinel")?(rs=i.jsxs(i.Fragment,{children:[i.jsx("p",{children:"群搜模式：同时打开多个搜索页；"}),i.jsx("p",{children:"单搜模式：打开一个搜索页"})]}),s[73]=rs):rs=s[73],s[74]===Symbol.for("react.memo_cache_sentinel")?(ts=i.jsx(d,{destroyOnHidden:!0,title:rs,children:i.jsx(p,{type:"text",size:"small",className:"h-[22px] w-[22px] text-base",icon:i.jsx(W,{})})}),s[74]=ts):ts=s[74],s[75]!==ns?(os=i.jsx(w,{items:ls,groupTitle:"管理",gap:20,extra:i.jsxs("div",{className:"flex flex-wrap gap-1",children:[ns,ts]})}),s[75]=ns,s[76]=os):os=s[76];const is=!!$&&le,cs=x||!j&&!Z;let ds,ms,us,hs,ps,fs,xs,js;return s[77]!==le?(ds=e=>{b(e,le)||ae(e)},s[77]=le,s[78]=ds):ds=s[78],s[79]===Symbol.for("react.memo_cache_sentinel")?(ms=e=>{be(e.item.id)},us=()=>{be(null)},hs={...ve},s[79]=ms,s[80]=us,s[81]=hs):(ms=s[79],us=s[80],hs=s[81]),s[82]!==M||s[83]!==je||s[84]!==q||s[85]!==le||s[86]!==$||s[87]!==a?(ps=le.map((e,s)=>{const l=le.filter(ie).length,n=le.length;return i.jsx(I,{flipId:`${e.id}`,children:i.jsxs("div",{id:e.id,className:"flex-center cursor-move flex-col border-2 rounded-xl gap-1 p-2 relative",style:{borderColor:e.enable?a.green5:a.colorFillSecondary,background:e.enable?a.green1:a.colorBgContainer,visibility:je!==e.id||$?"visible":"hidden"},children:[i.jsx("div",{className:"absolute left-2 top-2",children:e.batchSearch?i.jsx(d,{destroyOnHidden:!0,mouseEnterDelay:1,title:"参与群搜",className:"cursor-pointer",children:i.jsx(se,{className:"text-lg",style:{color:a.green5}})}):null}),i.jsx("div",{className:"absolute right-2 top-2",children:e.enable?i.jsx(d,{destroyOnHidden:!0,mouseEnterDelay:1,title:"已启用",className:"cursor-pointer",children:i.jsx(D,{className:"text-lg",style:{color:a.green5}})}):null}),i.jsx(G,{src:m(e.icon||T),loading:"lazy",alt:"search-engine-icon",className:"w-[32px] h-[32px]",fallback:m(T),preview:!1}),i.jsx("p",{className:"h-[20px] font-medium text-center p-ellipsis",children:e.label}),i.jsxs("div",{className:"flex",style:{pointerEvents:$?"all":"none"},children:[e.enable?i.jsx(U,{tooltip:"禁用",onClick:()=>{if(l<=1)return void u.error("至少启用一个搜索引擎");const s=B(e.id,le,{...e,enable:!1});ae(s),u.success("禁用成功")},icon:i.jsx(J,{}),danger:!0,className:"transition-none"}):i.jsx(U,{tooltip:"启用",className:"transition-none",onClick:()=>{const s=B(e.id,le,{...e,enable:!0});ae(s),u.success("启用成功")},icon:i.jsx(D,{style:{color:a.green5}})}),e.batchSearch?i.jsx(U,{tooltip:"不参与群搜",onClick:()=>{const s=B(e.id,le,{...e,batchSearch:!1});ae(s),u.success("已设置不参与群搜")},danger:!0,icon:i.jsx(X,{}),className:"transition-none"}):i.jsx(U,{tooltip:"参与群搜",onClick:()=>{const s=B(e.id,le,{...e,batchSearch:!0});ae(s),u.success("已设置参与群搜")},icon:i.jsx(ne,{style:{color:a.green5}}),className:"transition-none"}),i.jsx(h,{destroyOnHidden:!0,title:"是否确认删除？",onConfirm:()=>{if(n<=1)return void u.error("至少保留一个搜索引擎");M===e.id&&q(f(le.filter(oe)[0].id));const s=H(t(le),e.id);ae(s),u.success("删除成功")},children:i.jsx(p,{danger:!0,icon:i.jsx(V,{}),size:"small",type:"text",className:"transition-none"})}),i.jsx(U,{tooltip:"编辑",onClick:()=>{fe(e)},icon:i.jsx(K,{style:{color:a.colorPrimary}}),className:"transition-none"})]})]})},s)}),s[82]=M,s[83]=je,s[84]=q,s[85]=le,s[86]=$,s[87]=a,s[88]=ps):ps=s[88],s[89]!==le||s[90]!==cs||s[91]!==ds||s[92]!==ps?(fs=i.jsx(P.ReactSortable,{disabled:cs,id:"search-engines",group:"search-engines",delayOnTouchOnly:!0,delay:200,animation:300,dragClass:"drag-class",ghostClass:"ghost-class",chosenClass:"chosen-class",forceFallback:!0,fallbackOnBody:!0,fallbackTolerance:4,fallbackClass:"fallback-class",list:le,setList:ds,onChoose:ms,onUnchoose:us,style:hs,children:ps}),s[89]=le,s[90]=cs,s[91]=ds,s[92]=ps,s[93]=fs):fs=s[93],s[94]!==is||s[95]!==fs?(xs=i.jsx(E,{flipKey:is,spring:"veryGentle",children:fs}),s[94]=is,s[95]=fs,s[96]=xs):xs=s[96],s[97]!==es||s[98]!==os||s[99]!==xs?(js=i.jsxs(i.Fragment,{children:[es,ss,os,xs]}),s[97]=es,s[98]=os,s[99]=xs,s[100]=js):js=s[100],js}function oe(e){return e.enable}function ie(e){return e.enable}function ce(e){return e.user.token}function de(e){return e.user.token}function me(e){return e.stateUtils.openFlip}function ue(e){return e.searchEngineData.searchEngineList}function he(e){return e.searchBar.activeSearchEngineId}function pe(e){return e.searchBar.batchSearch}const fe=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{se as R,te as S,fe as s};
