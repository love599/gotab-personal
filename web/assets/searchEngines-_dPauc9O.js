import{r as e,I as s,c as l,t as n,u as a,g as r,x as t,Q as o,j as i,U as c,v as d,i as m,m as u,a2 as h,B as f,bd as p,b2 as x,b3 as j,a5 as b,eH as g,cD as y,w as v,bK as C,l as S,o as _,E as O,eI as k,bA as w,n as N}from"./requestIdleCallbackPolyfill-CRtcYtqz.js";import{u as F}from"./useForm-Au5dOVxA.js";import{v as I,x as R,j as E,h as P}from"./myFolderModal-jG-tHH9Z.js";import{s as B}from"./assets-B8Bi78Vh.js";import{u as T,d as U}from"./sortableJsUtils-CfY30Vxy.js";import{H as z}from"./handleButton-CO9fxx0P.js";import{F as H}from"./index-BGbaREI1.js";import{I as A}from"./index-B0U6GSVy.js";import{A as L,M as q,a as D}from"./MergeOutlined-4ett1hjm.js";import{R as M}from"./CheckCircleOutlined-BP6X6WYV.js";import{I as G}from"./index-BIBYr-gg.js";import{R as K}from"./StopOutlined-j0SF7eAH.js";import{R as V}from"./PlusOutlined--6NjBz5c.js";import{a as Q}from"./useIsSmallScreen-BXqZh8mn.js";import{R as J}from"./CloudUploadOutlined-CPgK-3kN.js";import{R as W}from"./QuestionCircleOutlined-BsueyuX1.js";function X(){return X=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},X.apply(this,arguments)}const $=(l,n)=>e.createElement(s,X({},l,{ref:n,icon:L})),Y=e.forwardRef($);function Z(){return Z=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},Z.apply(this,arguments)}const ee=(l,n)=>e.createElement(s,Z({},l,{ref:n,icon:q})),se=e.forwardRef(ee);function le(){return le=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},le.apply(this,arguments)}const ne=(l,n)=>e.createElement(s,le({},l,{ref:n,icon:D})),ae=e.forwardRef(ne),{useToken:re}=n;function te(){const s=l.c(101),{token:n}=re(),L=a(),q=r(fe),D=r(he),X=r(ue),$=r(me),Z=r(de);let ee;s[0]!==X?(ee=t(X),s[0]=X,s[1]=ee):ee=s[1];const[le,ne]=e.useState(ee),[te,pe]=e.useState(),[xe]=F(),[je,be]=e.useState(null),ge=r(ce);let ye;s[2]===Symbol.for("react.memo_cache_sentinel")?(ye={gridTemplateColumns:"repeat(auto-fill, minmax(110px,1fr)",gridAutoRows:"100px",rowGap:12,columnGap:12,display:"grid",justifyContent:"center",gridAutoFlow:"dense",width:"100%"},s[2]=ye):ye=s[2];const ve=ye;let Ce,Se,_e,Oe,ke,we,Ne;s[3]!==le||s[4]!==X?(Ce=()=>{b(X,le)||ne(t(X))},s[3]=le,s[4]=X,s[5]=Ce):Ce=s[5],s[6]!==X?(Se=[X],s[6]=X,s[7]=Se):Se=s[7],o(Ce,Se),s[8]!==L||s[9]!==le?(_e=()=>{L(g(t(le)))},s[8]=L,s[9]=le,s[10]=_e):_e=s[10],s[11]!==le?(Oe=[le],s[11]=le,s[12]=Oe):Oe=s[12],o(_e,Oe),s[13]!==te?.icon||s[14]!==te?.label||s[15]!==te?.urlFormat||s[16]!==xe?(ke=()=>{xe.setFieldsValue({label:te?.label,icon:te?.icon,urlFormat:te?.urlFormat})},s[13]=te?.icon,s[14]=te?.label,s[15]=te?.urlFormat,s[16]=xe,s[17]=ke):ke=s[17],s[18]!==te?(we=[te],s[18]=te,s[19]=we):we=s[19],o(ke,we),s[20]!==te||s[21]!==xe||s[22]!==le?(Ne=function(e){if(e.icon&&(e.icon=y(e.icon,"https://")),te){const s=T(te.id,le,{...te,...e});ne(s),pe(void 0),u.success("编辑成功")}else ne([...le,{...e,id:v(),enable:!0}]),pe(void 0),u.success("新增成功");xe.resetFields()},s[20]=te,s[21]=xe,s[22]=le,s[23]=Ne):Ne=s[23];const Fe=Ne,[Ie,Re]=e.useState(!1),Ee=te?.icon||B;let Pe,Be,Te,Ue,ze,He,Ae,Le;s[24]!==Ee?(Pe=i.jsx("div",{className:"flex justify-center items-center gap-3 pb-3",children:i.jsx("div",{className:"rounded-xl w-[52px] h-[52px] flex-center ",children:i.jsx(G,{src:Ee,loading:"lazy",alt:"search-engine-icon",className:"w-[52px] h-[52px]",fallback:B,preview:!1})})}),s[24]=Ee,s[25]=Pe):Pe=s[25],s[26]===Symbol.for("react.memo_cache_sentinel")?(Be={flex:"58px"},s[26]=Be):Be=s[26],s[27]!==te?(Te=e=>{te&&pe({...te,...e})},s[27]=te,s[28]=Te):Te=s[28],s[29]===Symbol.for("react.memo_cache_sentinel")?(Ue=[{required:!0,message:"请输入搜索引擎名称"}],s[29]=Ue):Ue=s[29],s[30]===Symbol.for("react.memo_cache_sentinel")?(ze=i.jsx(H.Item,{required:!0,rules:Ue,label:"名称",name:"label",children:i.jsx(A,{placeholder:"搜索引擎名称",allowClear:!0,maxLength:20})}),s[30]=ze):ze=s[30],s[31]===Symbol.for("react.memo_cache_sentinel")?(He=[{validator:(e,s)=>new Promise((e,l)=>{s?C(s)?s.includes("%s")?e(""):l("请输入包含%s的地址（用“%s”代替搜索词）"):l("请输入正确的url地址"):l("请输入搜索引擎地址")})}],s[31]=He):He=s[31],s[32]===Symbol.for("react.memo_cache_sentinel")?(Ae=i.jsx(H.Item,{required:!0,rules:He,label:"地址",name:"urlFormat",children:i.jsx(A,{placeholder:"搜索引擎地址，用“%s”代替搜索词",allowClear:!0,maxLength:255})}),s[32]=Ae):Ae=s[32],s[33]===Symbol.for("react.memo_cache_sentinel")?(Le=[{validator:(e,s)=>s&&s.length>200?Promise.reject("网站图标不能超过200个字符"):Promise.resolve()}],s[33]=Le):Le=s[33];const qe=!ge;let De,Me,Ge,Ke,Ve,Qe;s[34]!==xe||s[35]!==ge?(De=e=>e.size>204800?(u.error("图标大小不能超过200KB！"),!1):(Re(!0),S({url:N.uploadIcon,token:ge,data:_({file:e})}).then(e=>{200===e.code&&e.data&&xe.setFieldValue("icon",e.data.icon_url)}).finally(()=>{Re(!1)}),!1),s[34]=xe,s[35]=ge,s[36]=De):De=s[36],s[37]!==ge?(Me=()=>{ge||u.error("请您先完成登录/注册")},s[37]=ge,s[38]=Me):Me=s[38],s[39]===Symbol.for("react.memo_cache_sentinel")?(Ge=i.jsx(J,{}),s[39]=Ge):Ge=s[39],s[40]!==Ie||s[41]!==Me?(Ke=i.jsx(f,{onClick:Me,loading:Ie,type:"text",className:"rounded-none",children:"上传",icon:Ge}),s[40]=Ie,s[41]=Me,s[42]=Ke):Ke=s[42],s[43]!==qe||s[44]!==De||s[45]!==Ke?(Ve=i.jsx(H.Item,{label:"图标",name:"icon",rules:Le,children:i.jsx(A,{placeholder:"图标地址",allowClear:!0,addonAfter:i.jsx(c,{disabled:qe,accept:".png, .jpg, .jpeg, .svg, .webp, .ico",showUploadList:!1,beforeUpload:De,children:Ke})})}),s[43]=qe,s[44]=De,s[45]=Ke,s[46]=Ve):Ve=s[46],s[47]!==te?(Qe=te?i.jsx(f,{danger:!0,onClick:()=>{pe(void 0)},children:"取消"}):null,s[47]=te,s[48]=Qe):Qe=s[48];const Je=te?void 0:"120px";let We;s[49]!==Je?(We={minWidth:Je},s[49]=Je,s[50]=We):We=s[50];const Xe=te?"保存":"新增";let $e,Ye,Ze,es,ss,ls,ns,as,rs,ts,os;s[51]!==We||s[52]!==Xe?($e=i.jsx(f,{htmlType:"submit",type:"primary",style:We,children:Xe}),s[51]=We,s[52]=Xe,s[53]=$e):$e=s[53],s[54]!==Qe||s[55]!==$e?(Ye=i.jsxs("div",{className:"flex w-full justify-center gap-3",children:[Qe,$e]}),s[54]=Qe,s[55]=$e,s[56]=Ye):Ye=s[56],s[57]!==xe||s[58]!==Fe||s[59]!==Te||s[60]!==Ve||s[61]!==Ye?(Ze=i.jsx("div",{className:"flex-1",children:i.jsxs(H,{autoComplete:"off",form:xe,variant:"filled",labelCol:Be,onFinish:Fe,onValuesChange:Te,children:[ze,Ae,Ve,Ye]})}),s[57]=xe,s[58]=Fe,s[59]=Te,s[60]=Ve,s[61]=Ye,s[62]=Ze):Ze=s[62],s[63]!==Pe||s[64]!==Ze?(es=i.jsxs("div",{className:"flex gap-3 pt-3 relative flex-col ",children:[Pe,Ze]}),s[63]=Pe,s[64]=Ze,s[65]=es):es=s[65],s[66]===Symbol.for("react.memo_cache_sentinel")?(ss=i.jsx(O,{}),s[66]=ss):ss=s[66],s[67]===Symbol.for("react.memo_cache_sentinel")?(ls=[{}],s[67]=ls):ls=s[67],s[68]!==L?(ns=e=>{L(k(e))},s[68]=L,s[69]=ns):ns=s[69],s[70]!==q||s[71]!==ns?(as=i.jsx(R,{checkedChildren:"群搜模式",unCheckedChildren:"单搜模式",checked:q,onChange:ns}),s[70]=q,s[71]=ns,s[72]=as):as=s[72],s[73]===Symbol.for("react.memo_cache_sentinel")?(rs=i.jsxs(i.Fragment,{children:[i.jsx("p",{children:"群搜模式：同时打开多个搜索页；"}),i.jsx("p",{children:"单搜模式：打开一个搜索页"})]}),s[73]=rs):rs=s[73],s[74]===Symbol.for("react.memo_cache_sentinel")?(ts=i.jsx(d,{destroyOnHidden:!0,title:rs,children:i.jsx(f,{type:"text",size:"small",className:"h-[22px] w-[22px] text-base",icon:i.jsx(W,{})})}),s[74]=ts):ts=s[74],s[75]!==as?(os=i.jsx(w,{items:ls,groupTitle:"管理",gap:20,extra:i.jsxs("div",{className:"flex flex-wrap gap-1",children:[as,ts]})}),s[75]=as,s[76]=os):os=s[76];const is=!!$&&le,cs=x||!j&&!Z;let ds,ms,us,hs,fs,ps,xs,js;return s[77]!==le?(ds=e=>{b(e,le)||ne(e)},s[77]=le,s[78]=ds):ds=s[78],s[79]===Symbol.for("react.memo_cache_sentinel")?(ms=e=>{be(e.item.id)},us=()=>{be(null)},hs={...ve},s[79]=ms,s[80]=us,s[81]=hs):(ms=s[79],us=s[80],hs=s[81]),s[82]!==D||s[83]!==je||s[84]!==L||s[85]!==le||s[86]!==$||s[87]!==n?(fs=le.map((e,s)=>{const l=le.filter(ie).length,a=le.length;return i.jsx(I,{flipId:`${e.id}`,children:i.jsxs("div",{id:e.id,className:"flex-center cursor-move flex-col border-2 rounded-xl gap-1 p-2 relative",style:{borderColor:e.enable?n.green5:n.colorFillSecondary,background:e.enable?n.green1:n.colorBgContainer,visibility:je!==e.id||$?"visible":"hidden"},children:[i.jsx("div",{className:"absolute left-2 top-2",children:e.batchSearch?i.jsx(d,{destroyOnHidden:!0,mouseEnterDelay:1,title:"参与群搜",className:"cursor-pointer",children:i.jsx(se,{className:"text-lg",style:{color:n.green5}})}):null}),i.jsx("div",{className:"absolute right-2 top-2",children:e.enable?i.jsx(d,{destroyOnHidden:!0,mouseEnterDelay:1,title:"已启用",className:"cursor-pointer",children:i.jsx(M,{className:"text-lg",style:{color:n.green5}})}):null}),i.jsx(G,{src:m(e.icon||B),loading:"lazy",alt:"search-engine-icon",className:"w-[32px] h-[32px]",fallback:m(B),preview:!1}),i.jsx("p",{className:"h-[20px] font-medium text-center p-ellipsis",children:e.label}),i.jsxs("div",{className:"flex",style:{pointerEvents:$?"all":"none"},children:[e.enable?i.jsx(z,{tooltip:"禁用",onClick:()=>{if(l<=1)return void u.error("至少启用一个搜索引擎");const s=T(e.id,le,{...e,enable:!1});ne(s),u.success("禁用成功")},icon:i.jsx(K,{}),danger:!0,className:"transition-none"}):i.jsx(z,{tooltip:"启用",className:"transition-none",onClick:()=>{const s=T(e.id,le,{...e,enable:!0});ne(s),u.success("启用成功")},icon:i.jsx(M,{style:{color:n.green5}})}),e.batchSearch?i.jsx(z,{tooltip:"不参与群搜",onClick:()=>{const s=T(e.id,le,{...e,batchSearch:!1});ne(s),u.success("已设置不参与群搜")},danger:!0,icon:i.jsx(Y,{}),className:"transition-none"}):i.jsx(z,{tooltip:"参与群搜",onClick:()=>{const s=T(e.id,le,{...e,batchSearch:!0});ne(s),u.success("已设置参与群搜")},icon:i.jsx(ae,{style:{color:n.green5}}),className:"transition-none"}),i.jsx(h,{destroyOnHidden:!0,title:"是否确认删除？",onConfirm:()=>{if(a<=1)return void u.error("至少保留一个搜索引擎");D===e.id&&L(p(le.filter(oe)[0].id));const s=U(t(le),e.id);ne(s),u.success("删除成功")},children:i.jsx(f,{danger:!0,icon:i.jsx(V,{}),size:"small",type:"text",className:"transition-none"})}),i.jsx(z,{tooltip:"编辑",onClick:()=>{pe(e)},icon:i.jsx(Q,{style:{color:n.colorPrimary}}),className:"transition-none"})]})]})},s)}),s[82]=D,s[83]=je,s[84]=L,s[85]=le,s[86]=$,s[87]=n,s[88]=fs):fs=s[88],s[89]!==le||s[90]!==cs||s[91]!==ds||s[92]!==fs?(ps=i.jsx(E.ReactSortable,{disabled:cs,id:"search-engines",group:"search-engines",delayOnTouchOnly:!0,delay:200,animation:300,dragClass:"drag-class",ghostClass:"ghost-class",chosenClass:"chosen-class",forceFallback:!0,fallbackOnBody:!0,fallbackTolerance:4,fallbackClass:"fallback-class",list:le,setList:ds,onChoose:ms,onUnchoose:us,style:hs,children:fs}),s[89]=le,s[90]=cs,s[91]=ds,s[92]=fs,s[93]=ps):ps=s[93],s[94]!==is||s[95]!==ps?(xs=i.jsx(P,{flipKey:is,spring:"veryGentle",children:ps}),s[94]=is,s[95]=ps,s[96]=xs):xs=s[96],s[97]!==es||s[98]!==os||s[99]!==xs?(js=i.jsxs(i.Fragment,{children:[es,ss,os,xs]}),s[97]=es,s[98]=os,s[99]=xs,s[100]=js):js=s[100],js}function oe(e){return e.enable}function ie(e){return e.enable}function ce(e){return e.user.token}function de(e){return e.user.token}function me(e){return e.stateUtils.openFlip}function ue(e){return e.searchEngineData.searchEngineList}function he(e){return e.searchBar.activeSearchEngineId}function fe(e){return e.searchBar.batchSearch}const pe=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{se as R,te as S,pe as s};
