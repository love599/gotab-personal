import{r as e,a as t,c as o,u as r,g as i,t as s,Q as n,be as l,j as a,i as c,ba as m,bb as d,F as u}from"./requestIdleCallbackPolyfill-CEimuL3I.js";import{R as p,i as f,I as j}from"./sortableJsUtils-lf51YuKZ.js";import{u as x,f as g,a as h}from"./homePage-xVxKWQ-j.js";import{I as b}from"./index-B6Nw0KJ3.js";import{R as k}from"./SearchOutlined-C3PMWV9D.js";import{b as y}from"./myFolderModal-DMVjguLH.js";import"./handleButton-FqbJIAiJ.js";import"./LikeOutlined-BjYRMYG0.js";import"./MailOutlined-OCY9FzYP.js";import"./Overflow-CysMCa0X.js";import"./FolderOpenOutlined-DHBkEw2_.js";import"./myModal-DAb4Oxb9.js";import"./index-CLs8asrc.js";import"./useForm-BmxkZ3hM.js";import"./row-eYrfNDsp.js";import"./useBreakpoint-BCsgDtUx.js";import"./mediaQueryUtil-DPPPwwPM.js";import"./QuestionCircleOutlined-DSm95oJP.js";import"./CloudUploadOutlined-BcBaKmgs.js";import"./PlusOutlined-ByZyTB3m.js";import"./fullSpin-CKQAqEpZ.js";import"./index-BCD7T3lV.js";import"./index-DG56vLGF.js";import"./categories-lbGQL8f7.js";import"./useFresh-CXjlCB9G.js";import"./index-CVsAKlSW.js";import"./index-Cu_iOCo3.js";import"./LeftOutlined-D9Sp279J.js";import"./LinkOutlined-Bi0iQjOQ.js";import"./index-we7dqPR7.js";import"./getAllowClear-Cn6nd0XC.js";import"./Input-BBAEOKR8.js";import"./MergeCellsOutlined-CaMItgu1.js";import"./PlusOutlined-DoJ9MaWq.js";import"./useIsSmallScreen-DT9DQvvy.js";import"./UnlockOutlined-BUlRKHQl.js";import"./searchEngines-DxmHXSAp.js";import"./assets-B8Bi78Vh.js";import"./MergeOutlined-4ett1hjm.js";import"./CheckCircleOutlined-r6HIsORH.js";import"./CheckCircleOutlined-CY3_0FRk.js";import"./StopOutlined-BiZS3bI8.js";import"./StopOutlined-Br6dl6xU.js";import"./QuestionCircleOutlined-Iab4W4Td.js";import"./CaretDownOutlined-DcidQ0ah.js";import"./myErrorPage-CLr4Hszv.js";import"./spinLoading-BUP7Zw8h.js";import"./markdownContent-BI2abnkU.js";import"./reset-BRJHgF92.js";import"./mySlider-CtwzYDNE.js";import"./ColorPicker-gpVSsQlx.js";import"./index-kH8S-jgo.js";import"./index-BXpSMQ4p.js";import"./iconBase-rh4uCQVo.js";import"./index-vRO4BP5Y.js";import"./myDrawer2-BBz-Zjo8.js";import"./UserOutlined-Ch50gqEV.js";import"./useEffectOnce-BdmSZdB2.js";import"./LogoutOutlined-CbYHv50E.js";import"./LogoutOutlined-C0AkGQqz.js";import"./RightCircleOutlined-B4v72utl.js";import"./RightCircleOutlined-HagImp-w.js";import"./TextArea-D12ZTmOp.js";import"./sortable.esm-DnfOC_F4.js";import"./ExportOutlined-BTrutQGh.js";import"./ReloadOutlined-B00s2TmV.js";import"./LeftOutlined-DlW4zolN.js";import"./styleChecker-o73Q9rTs.js";import"./addRecommendAppForm-K-4YO6EV.js";import"./submitForInclusion-CIVbLdE7.js";import"./RedoOutlined-BRwewl8_.js";function w(e){const o=t.getState().card.gridColumnWidth,r=t.getState().card.gridRowHeight,i=e*(t.getState().card.radius/Math.min(r,o)),s=e/2;return Math.min(i,s)}function v(e,o){const r=t.getState().card.gridColumnWidth,i=t.getState().card.gridRowHeight;return e*(o/Math.min(i,r))}const C=e.memo(()=>{const c=o.c(28),p=r(),[f,j]=e.useState(!1),[y,w]=e.useState(!1),[v,C]=e.useState("");let _;c[0]===Symbol.for("react.memo_cache_sentinel")?(_=[],c[0]=_):_=c[0];const[D,R]=e.useState(_),[E,N]=e.useState(0),I=i(S),{token:F}=s.useToken(),M=e.useRef(null),P=e.useRef(null);let A,B,U;c[1]!==p||c[2]!==y?(A=()=>{y?(p(m(!1)),p(d(!1)),localStorage.setItem("globalSearchIsOpen","1")):(localStorage.removeItem("globalSearchIsOpen"),C(""),N(0))},B=[y,p],c[1]=p,c[2]=y,c[3]=A,c[4]=B):(A=c[3],B=c[4]),e.useEffect(A,B),c[5]===Symbol.for("react.memo_cache_sentinel")?(U=async o=>{if("string"!=typeof o)throw new Error("无效的关键词，请您提供有效的文本");if(!o)return void R([]);const r=t.getState().appData.listData,i=t.getState().appData.freeDragListData,s=[...g(r.concat(i)),...u()?await h():[]],n=new Set,l=s.filter(e=>"link"===e.type&&!n.has(e.link)&&(n.add(e.link),!0)).filter(e=>{if("link"===e.type&&e.label&&e.link){const t=e.label.trim().toLowerCase(),r=e.link.trim().toLowerCase();return t.includes(o.toLowerCase())||r.includes(o.toLowerCase())}return!1});e.startTransition(()=>{R(l.slice(0,9))})},c[5]=U):U=c[5];const Q=U;let z,H,K,W;c[6]!==v?(z=()=>{""!==v.trim()?Q(v.trim()):R([])},H=[v,Q],c[6]=v,c[7]=z,c[8]=H):(z=c[7],H=c[8]),n(z,H),c[9]===Symbol.for("react.memo_cache_sentinel")?(K=()=>{const e=e=>{(e.ctrlKey||e.metaKey)&&"f"===e.key&&(e.preventDefault(),w(!0),setTimeout(()=>j(!0),10))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},W=[],c[9]=K,c[10]=W):(K=c[9],W=c[10]),e.useEffect(K,W);const $=T,q=L;let J;c[11]===Symbol.for("react.memo_cache_sentinel")?(J=(e,t,o,r)=>{const{row:i,col:s}=q(e,o),n=Math.ceil(r/o);if("up"===t){const e=(0===i?n-1:i-1)*o+s;return e>=r?s:e}if("down"===t){const e=(i+1)%n*o+s;return e>=r?s:e}return e},c[11]=J):J=c[11];const V=J;let X,Y,Z;c[12]!==D||c[13]!==E||c[14]!==f?(Y=()=>{if(!f||0===D.length)return;const e=e=>{const t=P.current;if(!t)return;const o=D.length,r=$(t);let i=E;e:switch(e.key){case"ArrowUp":e.preventDefault(),i=V(E,"up",r,o);break e;case"ArrowDown":e.preventDefault(),i=V(E,"down",r,o);break e;case"ArrowLeft":e.preventDefault(),i=(E-1+o)%o;break e;case"ArrowRight":e.preventDefault(),i=(E+1)%o;break e;case"Enter":E>=0&&window.open(D[E].link,"_blank");break e;default:return}N(i);const s=t.children[i];s&&s.scrollIntoView({block:"nearest",behavior:"smooth"})};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},X=[f,D,E],c[12]=D,c[13]=E,c[14]=f,c[15]=X,c[16]=Y):(X=c[15],Y=c[16]),e.useEffect(Y,X),c[17]===Symbol.for("react.memo_cache_sentinel")?(Z=()=>{j(!1),setTimeout(()=>w(!1),300)},c[17]=Z):Z=c[17];const G=Z;let ee,te;return x(M,G),l("Escape",G),c[18]!==I||c[19]!==D||c[20]!==E||c[21]!==y||c[22]!==f||c[23]!==v||c[24]!==F?(ee=y&&a.jsx("div",{className:`fixed inset-0 z-[10000] flex py-20 px-6 justify-center bg-black bg-opacity-45 opacity-0 transition-opacity duration-200 ${f?"opacity-100":""} ${I?"backdrop-blur-sm":""}`,children:a.jsxs("div",{ref:M,className:"flex flex-col p-6 gap-4 w-full max-w-xl transform h-fit max-h-full rounded-2xl opacity-0 transition-all duration-200 "+(f?"opacity-100":""),style:{background:F.colorBgContainer,scale:f?1:.9},children:[a.jsx(b,{size:"large",autoFocus:!0,className:"border-2",placeholder:"全局搜索链接/书签卡片（ 显示前 9 个相关结果 ）",prefix:a.jsx(k,{}),value:v,onChange:e=>{C(e.target.value),N(0)}}),a.jsx("div",{className:"h-full overflow-y-auto",children:D.length>0?a.jsx("div",{ref:P,className:"grid *:cursor-pointer *:transition-all *:duration-200 *:rounded-xl",style:{gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:"12px",gridAutoRows:"68px"},children:D.map((e,t)=>a.jsx(O,{result:e,index:t,currentIndex:E},e.id))}):a.jsx("div",{className:"p-6 pb-5 text-center",style:{color:F.colorTextDescription},children:v?"无搜索结果：请更换关键词":"请先输入您要搜索的关键词"})})]})}),c[18]=I,c[19]=D,c[20]=E,c[21]=y,c[22]=f,c[23]=v,c[24]=F,c[25]=ee):ee=c[25],c[26]!==ee?(te=a.jsx(a.Fragment,{children:ee}),c[26]=ee,c[27]=te):te=c[27],te}),O=e.memo(t=>{const r=o.c(39),{result:i,index:n,currentIndex:l}=t,m=s.useToken().token,d=e.useRef(null),u=y(d),x=i.id,g=n===l?m.colorPrimary:m.colorBorder,h=n===l?m.colorPrimaryBgHover:u?m.colorBgTextHover:void 0;let b,k;r[0]!==g||r[1]!==h?(b={borderColor:g,backgroundColor:h},r[0]=g,r[1]=h,r[2]=b):b=r[2],r[3]!==i.link?(k=()=>{window.open(i.link,"_blank")},r[3]=i.link,r[4]=k):k=r[4];const C=i.backgroundColor;let O;r[5]===Symbol.for("react.memo_cache_sentinel")?(O=w(40),r[5]=O):O=r[5];const S=i.iconPadding||0;let T,L,D,R,E,N,I,F,M,P,A;return r[6]!==S?(T=v(40,S),r[6]=S,r[7]=T):T=r[7],r[8]!==i.backgroundColor||r[9]!==T?(L={backgroundColor:C,borderRadius:O,padding:T},r[8]=i.backgroundColor,r[9]=T,r[10]=L):L=r[10],r[11]!==i.fontColor||r[12]!==i.icon||r[13]!==i.innerlabel||r[14]!==i.label?(D=i.icon?i.icon?.startsWith("/default/")?a.jsx(p,{style:{fontSize:24,color:i.fontColor}}):f(i.icon)?a.jsx("img",{src:c(i.icon),alt:i.label,style:{objectFit:"cover",borderRadius:w(25)},onError:_}):a.jsx(j,{icon:i.icon,className:"w-full h-full",fallback:a.jsx("img",{src:"/icons/default_image.svg",className:"w-full h-full object-contain"})}):a.jsx("span",{style:{fontSize:"10px",color:i.fontColor},className:"text-center font-medium",children:i.innerlabel||i.label}),r[11]=i.fontColor,r[12]=i.icon,r[13]=i.innerlabel,r[14]=i.label,r[15]=D):D=r[15],r[16]!==D||r[17]!==L?(R=a.jsx("div",{style:L,className:"w-10 h-10 flex items-center justify-center overflow-hidden",children:D}),r[16]=D,r[17]=L,r[18]=R):R=r[18],r[19]===Symbol.for("react.memo_cache_sentinel")?(E={width:"calc(100% - 40px - 8px)"},r[19]=E):E=r[19],r[20]!==m.colorText?(N={color:m.colorText},r[20]=m.colorText,r[21]=N):N=r[21],r[22]!==i.label||r[23]!==N?(I=a.jsx("div",{style:N,children:i.label}),r[22]=i.label,r[23]=N,r[24]=I):I=r[24],r[25]!==m.colorTextDescription?(F={color:m.colorTextDescription},r[25]=m.colorTextDescription,r[26]=F):F=r[26],r[27]!==i.link||r[28]!==F?(M=a.jsx("div",{style:F,className:"text-xs",children:i.link}),r[27]=i.link,r[28]=F,r[29]=M):M=r[29],r[30]!==I||r[31]!==M?(P=a.jsxs("div",{style:E,className:"font-medium *:truncate flex flex-col justify-evenly",children:[I,M]}),r[30]=I,r[31]=M,r[32]=P):P=r[32],r[33]!==i.id||r[34]!==R||r[35]!==P||r[36]!==b||r[37]!==k?(A=a.jsxs("div",{ref:d,className:"p-3 border-2 flex gap-2",style:b,onClick:k,children:[R,P]},x),r[33]=i.id,r[34]=R,r[35]=P,r[36]=b,r[37]=k,r[38]=A):A=r[38],A});function S(e){return e.card.bgBackdropFilter}function T(e){const t=Array.from(e.children);if(0===t.length)return 1;let o=1;const r=t[0].offsetTop;for(let i=1;i<t.length&&t[i].offsetTop===r;i++)o++;return o}function L(e,t){return{row:Math.floor(e/t),col:e%t}}function _(e){e.currentTarget.src="/icons/bookmark.svg"}export{C as default,w as getScaleRadius,v as getTruePadding};
