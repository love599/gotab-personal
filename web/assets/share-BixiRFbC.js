const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/shareSay-BAQYIfoA.js","assets/requestIdleCallbackPolyfill-CRtcYtqz.js","assets/requestIdleCallbackPolyfill-CmEo28um.css","assets/markdownContent-DI5tpsW3.js"])))=>i.map(i=>d[i]);
import{r as e,I as t,c as s,g as a,j as i,l as r,S as n,V as l,B as o,n as c,o as d,m,k as p,q as u,a2 as h,t as j,cX as f,d as x,v as y,e8 as g,_ as S,a7 as b,h as _,$ as C,W as k}from"./requestIdleCallbackPolyfill-CRtcYtqz.js";import{e as v}from"./assets-B8Bi78Vh.js";import{N as O}from"./noPermissions-Jiq8q0Bm.js";import{F as w}from"./fullSpin-DoLB4rVp.js";import{M as I}from"./myDrawer2-C3qoQ7S2.js";import{u as D}from"./useForm-Au5dOVxA.js";import{F as N}from"./index-BGbaREI1.js";import{I as F}from"./index-B0U6GSVy.js";import{S as A}from"./index-CF37AyZG.js";import{E as P}from"./index-Dwv05YNZ.js";import E from"./markdownContent-DI5tpsW3.js";import{R as L}from"./QuestionCircleOutlined-BsueyuX1.js";import{aN as R}from"./sortableJsUtils-CfY30Vxy.js";import{T as M}from"./index-BgMRx6qH.js";import{aT as T,f as U}from"./myFolderModal-jG-tHH9Z.js";import{C as Y,S as B}from"./SyncOutlined-Bty6z6Gu.js";import{R as H}from"./MailOutlined-jCQFQ878.js";import{a as V}from"./useIsSmallScreen-BXqZh8mn.js";import{R as $}from"./StopOutlined-j0SF7eAH.js";import{R as q,a as z}from"./PlusOutlined--6NjBz5c.js";import"./LinkOutlined-DopLHcZx.js";import"./index-BIBYr-gg.js";import"./LeftOutlined-D9Sp279J.js";import"./mediaQueryUtil-DPPPwwPM.js";import"./Overflow-Dw8Kex4x.js";import"./StepBackwardOutlined-DpwJRxU8.js";import"./index-bQRXjpSB.js";import"./handleButton-CO9fxx0P.js";import"./row-pVBpgFkh.js";import"./useBreakpoint-E2sLeglb.js";import"./QuestionCircleOutlined-DSm95oJP.js";import"./getAllowClear-rD1UM-lP.js";import"./Input-DELR_BSE.js";import"./TextArea-B5lq4i0U.js";import"./LikeOutlined-CNPE2vt8.js";import"./FolderOpenOutlined-ComJ5RAY.js";import"./SearchOutlined-B80XGBAY.js";import"./myModal-k-MK06RX.js";import"./CloudUploadOutlined-CPgK-3kN.js";import"./PlusOutlined-ByZyTB3m.js";import"./sortable.esm-Bv0j-UjJ.js";import"./iconBase-DTCtk8KC.js";import"./useFresh-y1lmOc8g.js";import"./index-DzNwoECr.js";import"./index-Nrm3Ms4y.js";import"./ColorPicker-CjotOysx.js";import"./index-DmIR1Fgm.js";import"./ExportOutlined-8qrQgjtC.js";import"./ReloadOutlined-B00s2TmV.js";import"./LeftOutlined-By8KUpxJ.js";import"./styleChecker-BRhAwd4B.js";import"./addRecommendAppForm-DlHFcMaS.js";import"./submitForInclusion-CW_Qim78.js";import"./RedoOutlined-B72iKt02.js";import"./UserOutlined-B1UxF3gI.js";import"./StopOutlined-Br6dl6xU.js";function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Q.apply(this,arguments)}const X=(s,a)=>e.createElement(t,Q({},s,{ref:a,icon:Y})),Z=e.forwardRef(X);function J(){return J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},J.apply(this,arguments)}const W=(s,a)=>e.createElement(t,J({},s,{ref:a,icon:B})),G=e.forwardRef(W);function K(){n.hide(l)}function ee(e){return{label:e.label,value:e.id}}function te(e){return e.user.token}function se(e){return e.appData.listData}const ae=e.memo(function(t){const d=s.c(37),[m]=D(),{type:p,initialValues:u,setShareSettingData:h,setHasShare:j}=t,f=a(se),x=a(te),[y,g]=e.useState(!1);let S;d[0]!==h||d[1]!==x?(S=function(e){g(!0),e.privateCategoryIds&&(e.privateCategoryIds=e.privateCategoryIds.join(",")),r({url:c.editShareSetting,data:e,token:x}).then(e=>{200===e.code&&e.data&&(h&&h(e.data),n.hide(l))}).finally(()=>{g(!1)})},d[0]=h,d[1]=x,d[2]=S):S=d[2];const b=S;let _;d[3]!==j||d[4]!==h||d[5]!==x?(_=function(e){g(!0),e.privateCategoryIds&&(e.privateCategoryIds=e.privateCategoryIds.join(",")),r({url:c.addShareSetting,data:e,token:x}).then(e=>{200===e.code&&e.data&&(h&&h(e.data),j&&j(!0),n.hide(l))}).finally(()=>{g(!1)})},d[3]=j,d[4]=h,d[5]=x,d[6]=_):_=d[6];const C=_;let k;d[7]!==m||d[8]!==u||d[9]!==f?(k=function(){if(!u||!u.privateCategoryIds)return;const e=[];u.privateCategoryIds.forEach(t=>{const s=f?.find(e=>e.id===t);s&&e.push(s.id)}),m.setFieldValue("privateCategoryIds",e)},d[7]=m,d[8]=u,d[9]=f,d[10]=k):k=d[10];const v=k;let O,w,I,P,E,L,R,M,T,U,Y;d[11]!==v?(O=()=>{v()},d[11]=v,d[12]=O):O=d[12],d[13]===Symbol.for("react.memo_cache_sentinel")?(w=[],d[13]=w):w=d[13],e.useEffect(O,w),d[14]===Symbol.for("react.memo_cache_sentinel")?(I={flex:"72px"},d[14]=I):I=d[14],d[15]!==C||d[16]!==b||d[17]!==p?(P=e=>{"edit"===p?b(e):C(e)},d[15]=C,d[16]=b,d[17]=p,d[18]=P):P=d[18],d[19]===Symbol.for("react.memo_cache_sentinel")?(E=[{validator:(e,t)=>t&&""!==t?t&&!/^[a-zA-Z0-9]+$/.test(t)?Promise.reject("分享码仅限数字和英文"):Promise.resolve():Promise.reject("请输入分享码")}],d[19]=E):E=d[19],d[20]===Symbol.for("react.memo_cache_sentinel")?(L=i.jsx(N.Item,{label:"分享码",required:!0,rules:E,name:"path",children:i.jsx(F,{placeholder:"分享码",allowClear:!0,maxLength:50})}),d[20]=L):L=d[20],d[21]===Symbol.for("react.memo_cache_sentinel")?(R=i.jsx(N.Item,{name:"title",label:"标题名称",children:i.jsx(F,{placeholder:"分享页标题",allowClear:!0,maxLength:50})}),d[21]=R):R=d[21],d[22]===Symbol.for("react.memo_cache_sentinel")?(M=i.jsx(N.Item,{name:"description",label:"描述简介",children:i.jsx(F,{placeholder:"分享页描述",allowClear:!0,maxLength:200})}),d[22]=M):M=d[22],d[23]!==f?(T=f?.map(ee),d[23]=f,d[24]=T):T=d[24],d[25]!==T?(U=i.jsx(N.Item,{name:"privateCategoryIds",label:"私有分类",children:i.jsx(A,{mode:"multiple",placeholder:"私有分类，分享时隐藏",options:T,allowClear:!0})}),d[25]=T,d[26]=U):U=d[26],d[27]===Symbol.for("react.memo_cache_sentinel")?(Y=i.jsx(o,{onClick:K,children:"取消"}),d[27]=Y):Y=d[27];const B="edit"===p?"保存":"创建";let H,V;return d[28]!==y||d[29]!==B?(H=i.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[Y,i.jsx(o,{loading:y,htmlType:"submit",type:"primary",children:B})]}),d[28]=y,d[29]=B,d[30]=H):H=d[30],d[31]!==m||d[32]!==u||d[33]!==U||d[34]!==H||d[35]!==P?(V=i.jsx(i.Fragment,{children:i.jsxs(N,{form:m,initialValues:u,autoComplete:"off",labelCol:I,onFinish:P,children:[L,R,M,U,H]})}),d[31]=m,d[32]=u,d[33]=U,d[34]=H,d[35]=P,d[36]=V):V=d[36],V});function ie(){n.hide(l)}function re(e){return i.jsx(E,{content:e,replace:!1})}function ne(e){return e.user.token}const le=e.memo(function(t){const j=s.c(34),{shareSettingData:f,setShareSettingData:x}=t,[y,g]=e.useState(f.share_say),S=a(ne);let b;j[0]===Symbol.for("react.memo_cache_sentinel")?(b=[],j[0]=b):b=j[0];const[_,C]=e.useState(b);let k;j[1]!==S?(k=function(e){return new Promise(t=>{r({url:c.uploadImage,token:S,data:d({file:e})}).then(e=>{200===e.code&&e.data&&t(e.data.image_url)})})},j[1]=S,j[2]=k):k=j[2];const v=k;let O;j[3]!==y||j[4]!==x||j[5]!==f||j[6]!==S?(O=function(){y?(p(0,C),r({url:c.editShareSay,data:{shareSay:y},token:S}).then(e=>{200===e.code&&(x&&x({...f,share_say:y}),n.hide(l))}).finally(()=>{u(0,C)})):m.error("请输入分享有话的内容")},j[3]=y,j[4]=x,j[5]=f,j[6]=S,j[7]=O):O=j[7];const w=O;let I;j[8]!==x||j[9]!==f||j[10]!==S?(I=function(){p(1,C),r({url:c.resetShareSay,token:S}).then(e=>{200===e.code&&x&&(x({...f,share_say:""}),g(""))}).finally(()=>{u(1,C)})},j[8]=x,j[9]=f,j[10]=S,j[11]=I):I=j[11];const D=I;let N,F,A,E,L,R,M,T,U,Y;return j[12]===Symbol.for("react.memo_cache_sentinel")?(N={height:"calc(100% - 44px)"},F=e=>{g(e.text)},j[12]=N,j[13]=F):(N=j[12],F=j[13]),j[14]!==v||j[15]!==y?(A=i.jsx(P,{className:"flex-1",style:N,onChange:F,value:y,renderHTML:re,onImageUpload:v}),j[14]=v,j[15]=y,j[16]=A):A=j[16],j[17]!==_[1]?(E=i.jsx(o,{danger:!0,loading:_[1],children:"重置"}),j[17]=_[1],j[18]=E):E=j[18],j[19]!==D||j[20]!==E?(L=i.jsx(h,{title:"是否确认重置？",onConfirm:D,children:E}),j[19]=D,j[20]=E,j[21]=L):L=j[21],j[22]===Symbol.for("react.memo_cache_sentinel")?(R=i.jsx(o,{onClick:ie,children:"取消"}),j[22]=R):R=j[22],j[23]!==w?(M=()=>{w()},j[23]=w,j[24]=M):M=j[24],j[25]!==_[0]||j[26]!==M?(T=i.jsx(o,{loading:_[0],type:"primary",onClick:M,children:"保存"}),j[25]=_[0],j[26]=M,j[27]=T):T=j[27],j[28]!==T||j[29]!==L?(U=i.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[L,R,T]}),j[28]=T,j[29]=L,j[30]=U):U=j[30],j[31]!==U||j[32]!==A?(Y=i.jsxs("div",{className:"flex flex-col gap-3 h-full",children:[A,U]}),j[31]=U,j[32]=A,j[33]=Y):Y=j[33],Y}),oe=S.lazy(()=>C(()=>import("./shareSay-BAQYIfoA.js"),__vite__mapDeps([0,1,2,3])));function ce(){const t=s.c(28),{token:d}=j.useToken(),m=a(pe);let S;t[0]===Symbol.for("react.memo_cache_sentinel")?(S=[],t[0]=S):S=t[0];const[C,D]=e.useState(S),N=a(me),F=a(de);let A;t[1]===Symbol.for("react.memo_cache_sentinel")?(A={path:"",title:"",description:"",CreatedAt:"",status:0,share_say:"",private_category_ids:"",UpdatedAt:""},t[1]=A):A=t[1];const[P,E]=e.useState(A),[Y,B]=e.useState(!1);let Q;t[2]!==m?(Q=function(){m&&(p(0,D),k({url:c.getUserShare,token:m}).then(e=>{200===e.code&&e.data?(E(e.data),B(!0)):B(!1)}).finally(()=>{u(0,D)}))},t[2]=m,t[3]=Q):Q=t[3];const X=Q;let J,W,K;t[4]!==X?(J=()=>{X()},t[4]=X,t[5]=J):J=t[5],t[6]===Symbol.for("react.memo_cache_sentinel")?(W=[],t[6]=W):W=t[6],e.useLayoutEffect(J,W),t[7]!==P||t[8]!==m?(K=function(){p(1,D),r({url:c.enableShare,token:m}).then(e=>{200===e.code&&E({...P,status:1})}).finally(()=>{u(1,D)})},t[7]=P,t[8]=m,t[9]=K):K=t[9];const ee=K;let te;t[10]!==P||t[11]!==m?(te=function(){p(2,D),r({url:c.disableShare,token:m}).then(e=>{200===e.code&&E({...P,status:2})}).finally(()=>{u(2,D)})},t[10]=P,t[11]=m,t[12]=te):te=t[12];const se=te;let ie;t[13]!==m?(ie=function(){p(3,D),r({url:c.deleteShare,token:m}).then(e=>{200===e.code&&(E({path:"",title:"",description:"",CreatedAt:"",status:0,share_say:"",private_category_ids:"",UpdatedAt:""}),B(!1))}).finally(()=>{u(3,D)})},t[13]=m,t[14]=ie):ie=t[14];const re=ie;let ne;t[15]!==N?(ne=function(e){if(!e)return;const t=e.split(","),s=[];return t.forEach(e=>{const t=N?.find(t=>t.id===e);t&&s.push(t.label)}),s.join("，")},t[15]=N,t[16]=ne):ne=t[16];const ce=ne;let ue;return t[17]!==F||t[18]!==re||t[19]!==se||t[20]!==ee||t[21]!==ce||t[22]!==Y||t[23]!==C||t[24]!==P||t[25]!==d||t[26]!==m?(ue=m?C[0]?i.jsx(w,{}):Y?i.jsxs(i.Fragment,{children:[i.jsx(f,{message:"分享有话是以弱化提醒的方式展示在分享页的右上角抽屉中，支持自主自定义markdown显示内容！考虑性能，分享数据将缓存 5 分钟",type:"info",icon:i.jsx(L,{})}),i.jsx(R,{bordered:!0,column:1,className:"w-full",styles:{label:{padding:"8px 16px"},content:{padding:"8px 16px",textAlign:"end"}},items:[{label:"分享状态",children:i.jsx(y,{title:0===P.status?"请联系管理员或耐心等待审核通过":1===P.status?"您的分享页可正常访问":2===P.status?"您的分享页已暂停分享":3===P.status?"您的分享页因违规已被禁用":"",children:i.jsx(M,{className:"m-0 cursor-pointer",icon:i.jsx(L,{}),color:0===P.status?"default":1===P.status?"green":2===P.status?"orange":"red",children:0===P.status?"待审核":1===P.status?"正常":2===P.status?"已停用":"被禁用"})})},{label:"分享路径",children:P?.path?i.jsx("div",{className:"flex justify-end",children:i.jsx(o,{onClick:()=>{window.open(g+"/s/"+P?.path)},type:"link",size:"small",className:"min-h-[22px] h-full text-wrap p-0",children:i.jsx("span",{className:"text-end",children:g+"/s/"+P?.path||"-"})})}):"-"},{label:"私有分类",children:P.private_category_ids?ce(P.private_category_ids):"-"},{label:"分享页标题",children:P?.title||"-"},{label:"分享页描述",children:P?.description||"-"},{label:"分享有话",children:P.share_say?i.jsx("div",{className:"flex justify-end",children:i.jsx(o,{disabled:3===P.status,onClick:()=>{n.show(I,{title:"分享有话",backgroundOpacity:F?.92:void 0,children:i.jsx(e.Suspense,{children:i.jsx(oe,{content:P.share_say||""})}),placement:"right"})},type:"link",className:"p-0 h-[22px]",size:"small",icon:i.jsx(T,{}),children:"预览"})}):"-"},{label:"创建时间",children:x(P?.CreatedAt).format("YYYY-MM-DD HH:mm:ss")||"-"},{label:"更新时间",children:x(P?.UpdatedAt).format("YYYY-MM-DD HH:mm:ss")||"-"}]}),3===P.status?null:i.jsxs("div",{className:"flex flex-col mt-3 gap-3",children:[i.jsxs("div",{className:"flex gap-1 font-medium pl-2",style:{color:d.colorTextDescription},children:[i.jsx(Z,{}),i.jsx("p",{children:"控制台"})]}),i.jsx(o,{onClick:()=>{const e=""+(g+"/s/"+P?.path),t=P?.title,s=P?.description;b(`我的个性分享页：${e}${t?"（"+t+"）":""}${s?"，主要内容："+s:""}`)},icon:i.jsx(U,{}),children:"复制文案"}),i.jsx(o,{icon:i.jsx(H,{}),onClick:()=>{n.show(l,{title:"有话设置",width:"860px",height:"520px",children:i.jsx(le,{shareSettingData:P,setShareSettingData:E})})},children:"有话设置"}),i.jsx(o,{icon:i.jsx(V,{}),onClick:()=>{n.show(l,{title:"编辑分享信息",children:i.jsx(ae,{type:"edit",initialValues:{path:P.path,title:P.title,description:P.description,privateCategoryIds:P.private_category_ids.split(",")},setShareSettingData:E})})},children:"编辑信息"}),1===P.status?i.jsx(o,{onClick:se,loading:C[2],icon:i.jsx($,{}),children:"暂停分享"}):2===P.status?i.jsx(o,{onClick:ee,loading:C[1],icon:i.jsx(G,{}),children:"启用分享"}):null,i.jsx(h,{title:"是否确认删除？",onConfirm:re,children:i.jsx(o,{danger:!0,icon:i.jsx(q,{}),loading:C[3],children:"删除分享"})})]})]}):i.jsx(i.Fragment,{children:i.jsx(_,{className:"flex flex-col items-center w-full px-0",icon:i.jsx("div",{className:"h-[240px]",children:i.jsx("img",{alt:"",src:v,style:{width:"auto",height:"240px"}})}),title:i.jsx("div",{className:"flex justify-center w-full",children:i.jsx(o,{onClick:()=>{n.show(l,{title:"创建分享页",children:i.jsx(ae,{type:"add",setShareSettingData:E,setHasShare:B})})},icon:i.jsx(z,{}),type:"primary",children:"创建分享页"})})})}):i.jsx(O,{title:"权限不足",subTitle:"请您先完成登录/注册",extra:!1}),t[17]=F,t[18]=re,t[19]=se,t[20]=ee,t[21]=ce,t[22]=Y,t[23]=C,t[24]=P,t[25]=d,t[26]=m,t[27]=ue):ue=t[27],ue}function de(e){return e.card.bgBackdropFilter}function me(e){return e.appData.listData}function pe(e){return e.user.token}export{ce as default};
