import{am as e,aa as s,ab as t,_ as l,as as a,aB as n,r,I as i,c as o,u as c,t as d,g as m,x as p,Q as f,j as u,c0 as x,B as g,a2 as j,m as h,b2 as y,b3 as b,a5 as v,w as C,z as O,cX as w,Z as N,E as S,bA as k}from"./requestIdleCallbackPolyfill-CRtcYtqz.js";import{u as $}from"./useForm-Au5dOVxA.js";import{v as F,I as _,j as E,h as G}from"./myFolderModal-jG-tHH9Z.js";import{u as I}from"./useFresh-y1lmOc8g.js";import{d as P,u as z,C as T}from"./sortableJsUtils-CfY30Vxy.js";import{H as B}from"./handleButton-CO9fxx0P.js";import{M}from"./MergeCellsOutlined-CaMItgu1.js";import{F as L}from"./index-BGbaREI1.js";import{S as R}from"./index-CF37AyZG.js";import{i as q}from"./LinkOutlined-DopLHcZx.js";import{R as D}from"./PlusOutlined--6NjBz5c.js";import{a as H}from"./useIsSmallScreen-BXqZh8mn.js";const U=["wrap","nowrap","wrap-reverse"],X=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],A=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"];function K(s,t){return e(Object.assign(Object.assign(Object.assign({},((e,s)=>{const t=!0===s.wrap?"wrap":s.wrap;return{[`${e}-wrap-${t}`]:t&&U.includes(t)}})(s,t)),((e,s)=>{const t={};return A.forEach(l=>{t[`${e}-align-${l}`]=s.align===l}),t[`${e}-align-stretch`]=!s.align&&!!s.vertical,t})(s,t)),((e,s)=>{const t={};return X.forEach(l=>{t[`${e}-justify-${l}`]=s.justify===l}),t})(s,t)))}const J=e=>{const{componentCls:s}=e;return{[s]:{display:"flex",margin:0,padding:0,"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},Q=e=>{const{componentCls:s}=e;return{[s]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},V=e=>{const{componentCls:s}=e,t={};return U.forEach(e=>{t[`${s}-wrap-${e}`]={flexWrap:e}}),t},W=e=>{const{componentCls:s}=e,t={};return A.forEach(e=>{t[`${s}-align-${e}`]={alignItems:e}}),t},Z=e=>{const{componentCls:s}=e,t={};return X.forEach(e=>{t[`${s}-justify-${e}`]={justifyContent:e}}),t},Y=s("Flex",e=>{const{paddingXS:s,padding:l,paddingLG:a}=e,n=t(e,{flexGapSM:s,flexGap:l,flexGapLG:a});return[J(n),Q(n),V(n),W(n),Z(n)]},()=>({}),{resetStyle:!1});const ee=l.forwardRef((s,t)=>{const{prefixCls:r,rootClassName:i,className:o,style:c,flex:d,gap:m,vertical:p=!1,component:f="div"}=s,u=function(e,s){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&s.indexOf(l)<0&&(t[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(l=Object.getOwnPropertySymbols(e);a<l.length;a++)s.indexOf(l[a])<0&&Object.prototype.propertyIsEnumerable.call(e,l[a])&&(t[l[a]]=e[l[a]])}return t}(s,["prefixCls","rootClassName","className","style","flex","gap","vertical","component"]),{flex:x,direction:g,getPrefixCls:j}=l.useContext(a),h=j("flex",r),[y,b,v]=Y(h),C=null!=p?p:null==x?void 0:x.vertical,O=e(o,i,null==x?void 0:x.className,h,b,v,K(h,s),{[`${h}-rtl`]:"rtl"===g,[`${h}-gap-${m}`]:q(m),[`${h}-vertical`]:C}),w=Object.assign(Object.assign({},null==x?void 0:x.style),c);return d&&(w.flex=d),m&&!q(m)&&(w.gap=m),y(l.createElement(f,Object.assign({ref:t,className:O,style:w},n(u,["justify","wrap","align"]))))});function se(){return se=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},se.apply(this,arguments)}const te=(e,s)=>r.createElement(i,se({},e,{ref:s,icon:M})),le=r.forwardRef(te),{useToken:ae}=d;function ne(e){const s=o.c(69),{onSave:t}=e,l=c(),{token:a}=ae(),[n]=$(),i=m(ce),d=m(oe),M=m(ie);let q;s[0]!==i?(q=p(i),s[0]=i,s[1]=q):q=s[1];const[U,X]=r.useState(q),[A,K]=r.useState(null),[J,Q]=r.useState(),[V,W]=r.useState(!1),{key:Z,refresh:Y}=I();let se;s[2]!==U?(se=function(e,s){const t=U.find(s=>s.id===e),l=U.find(e=>e.id===s);if(!t||!l)return;const a=[...l.children,...t.children],n=P(U,t.id),r=z(l.id,n,{...l,children:a});X(r),h.success("合并成功")},s[2]=U,s[3]=se):se=s[3];const te=se;let ne,de,me,pe,fe;s[4]!==U||s[5]!==i?(ne=()=>{v(i,U)||X(p(i))},s[4]=U,s[5]=i,s[6]=ne):ne=s[6],s[7]!==i?(de=[i],s[7]=i,s[8]=de):de=s[8],f(ne,de),s[9]!==U||s[10]!==i?(me=()=>{v(U,i)?W(!1):W(!0)},s[9]=U,s[10]=i,s[11]=me):me=s[11],s[12]!==U?(pe=[U],s[12]=U,s[13]=pe):pe=s[13],f(me,pe),s[14]!==J||s[15]!==U||s[16]!==Y?(fe=function(e){if(J){const s=z(J.id,U,{...J,...e});X(s),h.success("编辑成功")}else X([...U,{...e,id:C(),children:[]}]),h.success("新增成功");Q(void 0),Y()},s[14]=J,s[15]=U,s[16]=Y,s[17]=fe):fe=s[17];const ue=fe;let xe;s[18]!==l||s[19]!==U||s[20]!==t?(xe=function(){l(O(p(U))),h.success("保存成功"),W(!1),t&&t()},s[18]=l,s[19]=U,s[20]=t,s[21]=xe):xe=s[21];const ge=xe;let je,he;s[22]===Symbol.for("react.memo_cache_sentinel")?(je=u.jsx(w,{message:"新增/编辑分组后，需滚动到下方，点击保存更改才可生效！",icon:u.jsx(N,{}),type:"warning",marginBottom:0}),s[22]=je):je=s[22],s[23]!==J?(he=J?u.jsx(g,{danger:!0,onClick:()=>{Q(void 0)},children:"取消"}):null,s[23]=J,s[24]=he):he=s[24];const ye=J?void 0:"120px";let be;s[25]!==ye?(be={width:ye},s[25]=ye,s[26]=be):be=s[26];const ve=J?"保存":"新增分组";let Ce,Oe,we,Ne,Se,ke,$e;s[27]!==be||s[28]!==ve?(Ce=u.jsx(g,{htmlType:"submit",type:"primary",style:be,children:ve}),s[27]=be,s[28]=ve,s[29]=Ce):Ce=s[29],s[30]!==Ce||s[31]!==he?(Oe=u.jsxs("div",{className:"flex justify-center w-full gap-3",children:[he,Ce]}),s[30]=Ce,s[31]=he,s[32]=Oe):Oe=s[32],s[33]!==ue||s[34]!==J||s[35]!==n||s[36]!==Z||s[37]!==Oe?(we=u.jsx(T,{form:n,initialValues:J,onFinish:ue,reFreshKey:Z,footer:Oe}),s[33]=ue,s[34]=J,s[35]=n,s[36]=Z,s[37]=Oe,s[38]=we):we=s[38],s[39]===Symbol.for("react.memo_cache_sentinel")?(Ne=u.jsx(S,{}),s[39]=Ne):Ne=s[39],s[40]===Symbol.for("react.memo_cache_sentinel")?(Se=[{}],s[40]=Se):Se=s[40],s[41]!==V||s[42]!==i||s[43]!==ge?(ke=V?u.jsxs(u.Fragment,{children:[u.jsx(g,{danger:!0,size:"small",type:"link",onClick:()=>{X(p(i))},children:"取消"}),u.jsx(g,{size:"small",type:"link",onClick:ge,children:"保存更改"})]}):null,s[41]=V,s[42]=i,s[43]=ge,s[44]=ke):ke=s[44],s[45]!==ke?($e=u.jsx(k,{items:Se,groupTitle:"管理",gap:20,extra:u.jsx("div",{className:"flex flex-wrap",children:ke})}),s[45]=ke,s[46]=$e):$e=s[46];const Fe=!!d&&U,_e=y||!b&&!M;let Ee,Ge,Ie,Pe,ze,Te,Be;return s[47]!==U?(Ee=e=>{v(e,U)||X(e)},s[47]=U,s[48]=Ee):Ee=s[48],s[49]===Symbol.for("react.memo_cache_sentinel")?(Ge=e=>{K(e.item.id)},Ie=()=>{K(null)},s[49]=Ge,s[50]=Ie):(Ge=s[49],Ie=s[50]),s[51]!==A||s[52]!==U||s[53]!==te||s[54]!==d||s[55]!==a?(Pe=U.map((e,s)=>{const t=U.length;return u.jsx(F,{flipId:`${e.id}`,children:u.jsx("div",{className:"rounded-md",style:{background:a.colorBgContainer},children:u.jsxs("div",{className:"flex items-center p-1 rounded-md cursor-move",style:{background:a.colorFillSecondary,visibility:A!==e.id||d?"visible":"hidden"},children:[u.jsx("div",{className:"w-[32px] flex-center h-full border-r-2 mr-2 pr-1",children:e.icon?u.jsx(_,{icon:e.icon,imgClassName:"w-auto h-4"}):u.jsx("p",{className:"font-semibold",children:e.label.charAt(0)})}),u.jsx("div",{className:"flex-1 p-ellipsis",children:e.label}),u.jsxs("div",{className:"flex",children:[u.jsx(x,{destroyOnHidden:!0,title:"合并至：",trigger:"click",content:u.jsx(u.Fragment,{children:u.jsxs(L,{onFinish:s=>{const t=s.targetId;t&&te(e.id,t)},children:[u.jsx(L.Item,{required:!0,name:"targetId",rules:[{required:!0,message:"请选择目标分组"}],className:"h-14",children:u.jsx(R,{allowClear:!0,style:{width:"100%"},variant:"filled",placeholder:"目标分组",options:U.filter(s=>s.id!==e.id).map(re)})}),u.jsx(ee,{gap:8,justify:"end",className:"-mt-9",children:u.jsx(g,{type:"primary",size:"small",htmlType:"submit",children:"确认"})})]})}),children:u.jsx(g,{disabled:t<=1,type:"text",size:"small",icon:u.jsx(le,{style:{color:t<=1?void 0:a.colorPrimary}}),style:{pointerEvents:t<=1?"none":"all"}})},`popover-handle-merge-${e.id}`),u.jsx(j,{destroyOnHidden:!0,title:"是否确认删除？",onConfirm:()=>{if(t<=1)return void h.error("至少保留一个分组");const s=P(p(U),e.id);X(s)},children:u.jsx(g,{style:{pointerEvents:t<=1?"none":"all"},disabled:t<=1,danger:!0,icon:u.jsx(D,{}),className:"transition-none",size:"small",type:"text"})}),u.jsx(B,{tooltip:"编辑",onClick:()=>{Q(e)},icon:u.jsx(H,{style:{color:a.colorPrimary}}),className:"transition-none"})]})]})})},s)}),s[51]=A,s[52]=U,s[53]=te,s[54]=d,s[55]=a,s[56]=Pe):Pe=s[56],s[57]!==U||s[58]!==_e||s[59]!==Ee||s[60]!==Pe?(ze=u.jsx(E.ReactSortable,{disabled:_e,id:"categories-set",group:"categories-set",delayOnTouchOnly:!0,delay:200,animation:300,dragClass:"drag-class",ghostClass:"ghost-class",chosenClass:"chosen-class",forceFallback:!0,fallbackOnBody:!0,fallbackTolerance:4,fallbackClass:"fallback-class",list:U,setList:Ee,className:"flex flex-col gap-3",onChoose:Ge,onUnchoose:Ie,children:Pe}),s[57]=U,s[58]=_e,s[59]=Ee,s[60]=Pe,s[61]=ze):ze=s[61],s[62]!==Fe||s[63]!==ze?(Te=u.jsx(G,{flipKey:Fe,spring:"veryGentle",children:ze}),s[62]=Fe,s[63]=ze,s[64]=Te):Te=s[64],s[65]!==we||s[66]!==$e||s[67]!==Te?(Be=u.jsxs(u.Fragment,{children:[je,we,Ne,$e,Te]}),s[65]=we,s[66]=$e,s[67]=Te,s[68]=Be):Be=s[68],Be}function re(e){return{label:u.jsxs("span",{className:"flex items-center gap-2",children:[e.icon&&u.jsx(_,{icon:e.icon,imgClassName:"h-[14px] w-auto"}),u.jsx("span",{className:"truncate",children:e.label})]}),value:e.id}}function ie(e){return e.user.token}function oe(e){return e.stateUtils.openFlip}function ce(e){return e.appData.listData}const de=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));export{ne as C,ee as F,de as c};
