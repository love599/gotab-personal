import{c as e,j as t,r as i,B as s,X as o,E as n,S as r,V as l,n as a,k as c,a as d,l as m,q as u,a3 as j,a4 as p,a2 as f,o as h,m as x}from"./requestIdleCallbackPolyfill-CEimuL3I.js";import{E as y}from"./index-DQASz0xG.js";import{u as k}from"./useFresh-CXjlCB9G.js";import{M as b,R as _}from"./myTable-DifYlg4v.js";import{H as g}from"./handleButton-FqbJIAiJ.js";import w from"./markdownContent-BI2abnkU.js";import{C}from"./contentLayout-FLn7UwnK.js";import{R as S}from"./ReloadOutlined-Cq4GESH1.js";import{R as O}from"./QuestionCircleOutlined-Iab4W4Td.js";import{T as N}from"./index-DG56vLGF.js";import{R as v}from"./UserOutlined-Ch50gqEV.js";import{F as I}from"./index-CLs8asrc.js";import{I as T}from"./index-B6Nw0KJ3.js";import"./index-CVsAKlSW.js";import"./useForm-BmxkZ3hM.js";import"./index-Cu_iOCo3.js";import"./LeftOutlined-D9Sp279J.js";import"./FolderOpenOutlined-DHBkEw2_.js";import"./LinkOutlined-Bi0iQjOQ.js";import"./MailOutlined-OCY9FzYP.js";import"./Overflow-CysMCa0X.js";import"./mediaQueryUtil-DPPPwwPM.js";import"./index-we7dqPR7.js";import"./getAllowClear-Cn6nd0XC.js";import"./Input-BBAEOKR8.js";import"./transformData-B04ZS_a1.js";import"./assets-B8Bi78Vh.js";import"./MoneyCollectOutlined-CF6G1lbx.js";import"./MoneyCollectOutlined-4QlEwa2l.js";import"./index-ZPw8Urkh.js";import"./CaretDownOutlined-DcidQ0ah.js";import"./styleChecker-o73Q9rTs.js";import"./AlipayOutlined-DooH4oh8.js";import"./AlipayOutlined-tZM3mGx9.js";import"./useEffectOnce-BdmSZdB2.js";import"./useBreakpoint-BCsgDtUx.js";import"./index-BCD7T3lV.js";import"./ReloadOutlined-B00s2TmV.js";import"./QuestionCircleOutlined-DSm95oJP.js";import"./row-eYrfNDsp.js";import"./TextArea-D12ZTmOp.js";function F(){const i=e.c(21),{key:c,refresh:d}=k();let m,u,j,p,f,h;i[0]===Symbol.for("react.memo_cache_sentinel")?(m={title:"创建人",key:"username",width:160,fixed:"left",render:L},u={title:"状态",key:"status",width:80,render:q},j={title:"标题",key:"title",width:200},p={title:"内容",key:"content",width:400},f={type:"time",title:"创建时间",key:"notice_time",width:200},i[0]=m,i[1]=u,i[2]=j,i[3]=p,i[4]=f):(m=i[0],u=i[1],j=i[2],p=i[3],f=i[4]),i[5]!==d?(h=[m,u,j,p,f,{title:"操作",fixed:"right",width:220,render:(e,i)=>t.jsx(R,{record:i,refresh:d})}],i[5]=d,i[6]=h):h=i[6];const x=h;let y,_,g,w,N,v,I;return i[7]===Symbol.for("react.memo_cache_sentinel")?(y=t.jsx(S,{}),i[7]=y):y=i[7],i[8]!==d?(_=t.jsx(s,{type:"primary",icon:y,onClick:()=>{d()},children:"刷新列表"}),i[8]=d,i[9]=_):_=i[9],i[10]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx(o,{type:"warning",description:t.jsxs(t.Fragment,{children:[t.jsx(O,{className:"mr-1"}),"只会通知最新一条启用的公告！公告新增后需要二次确认是否发布，并且一天只可发布一次公告，以便保证用户体验！"]}),className:"mt-3 p-1 px-3 text-xs font-normal w-full"}),w=t.jsx(n,{className:"my-3"}),i[10]=g,i[11]=w):(g=i[10],w=i[11]),i[12]!==d?(N=t.jsx("div",{className:"mb-3",children:t.jsx(s,{type:"primary",onClick:()=>{r.show(l,{title:"新增公告",children:t.jsx(M,{refresh:d,type:"add"}),width:720})},children:"新增公告"})}),i[12]=d,i[13]=N):N=i[13],i[14]!==x||i[15]!==c?(v=t.jsx(b,{columns:x,getListUrl:a.getNoticeList,dataKey:"data.list",tableKey:c}),i[14]=x,i[15]=c,i[16]=v):v=i[16],i[17]!==N||i[18]!==v||i[19]!==_?(I=t.jsxs(C,{children:[_,g,w,N,v]}),i[17]=N,i[18]=v,i[19]=_,i[20]=I):I=i[20],I}function q(e){return t.jsx(N,{color:0===e?"blue":1===e?"green":"red",children:0===e?"待审核":1===e?"正常":"停用"})}function L(e){return t.jsx(N,{color:e?"geekblue":"red",bordered:!1,icon:t.jsx(v,{}),children:e||"已注销"})}const R=i.memo(o=>{const n=e.c(43),{record:h,refresh:x}=o;let y;n[0]===Symbol.for("react.memo_cache_sentinel")?(y=[],n[0]=y):y=n[0];const[k,b]=i.useState(y);let C;n[1]!==h.id||n[2]!==x?(C=function(){c(0,b);const e=d.getState().user.token;setTimeout(()=>{m({url:a.rejectNotice,token:e,data:{id:h.id}}).then(e=>{200===e.code&&x()}).finally(()=>{u(0,b)})},500)},n[1]=h.id,n[2]=x,n[3]=C):C=n[3];const S=C;let O;n[4]!==h.id||n[5]!==x?(O=function(){c(0,b);const e=d.getState().user.token;setTimeout(()=>{m({url:a.confirmNotice,token:e,data:{id:h.id}}).then(e=>{200===e.code&&x()}).finally(()=>{u(0,b)})},500)},n[4]=h.id,n[5]=x,n[6]=O):O=n[6];const N=O;let v;n[7]!==h.id||n[8]!==x?(v=function(){c(1,b);const e=d.getState().user.token;setTimeout(()=>{m({url:a.deleteNotice,token:e,data:{id:h.id}}).then(e=>{200===e.code&&x()}).finally(()=>{u(1,b)})},500)},n[7]=h.id,n[8]=x,n[9]=v):v=n[9];const I=v;let T;n[10]!==h.content||n[11]!==h.title?(T=function(){j.open({closeIcon:t.jsx("div",{className:"my-handle-icon",children:t.jsx(g,{icon:t.jsx(p,{})})}),message:h.title,description:t.jsx(w,{content:h.content}),duration:null})},n[10]=h.content,n[11]=h.title,n[12]=T):T=n[12];const F=T;let q,L;n[13]!==F?(q=t.jsx(s,{type:"link",size:"small",onClick:F,children:"预览"}),n[13]=F,n[14]=q):q=n[14],n[15]!==h||n[16]!==x?(L=t.jsx(s,{type:"link",size:"small",onClick:()=>{r.show(l,{title:"编辑公告",children:t.jsx(M,{editItem:h,type:"edit",refresh:x}),width:720})},children:"编辑"}),n[15]=h,n[16]=x,n[17]=L):L=n[17];const R=0===h.status||2===h.status?"是否确认发布？":"是否确认停用？",z=0===h.status||2===h.status?N:S;let A,U,B,E,Q,D,H,K,P;return n[18]===Symbol.for("react.memo_cache_sentinel")?(A={width:"44px"},n[18]=A):A=n[18],n[19]!==k[0]||n[20]!==h.status?(U=k[0]?t.jsx(_,{}):0===h.status||2===h.status?"发布":"停用",n[19]=k[0],n[20]=h.status,n[21]=U):U=n[21],n[22]!==k[0]||n[23]!==U?(B=t.jsx(s,{type:"link",size:"small",disabled:k[0],style:A,children:U}),n[22]=k[0],n[23]=U,n[24]=B):B=n[24],n[25]!==B||n[26]!==R||n[27]!==z?(E=t.jsx(f,{title:R,onConfirm:z,children:B}),n[25]=B,n[26]=R,n[27]=z,n[28]=E):E=n[28],n[29]===Symbol.for("react.memo_cache_sentinel")?(Q={width:"44px"},n[29]=Q):Q=n[29],n[30]!==k[1]?(D=k[1]?t.jsx(_,{}):"删除",n[30]=k[1],n[31]=D):D=n[31],n[32]!==k[1]||n[33]!==D?(H=t.jsx(s,{danger:!0,type:"link",size:"small",disabled:k[1],style:Q,children:D}),n[32]=k[1],n[33]=D,n[34]=H):H=n[34],n[35]!==I||n[36]!==H?(K=t.jsx(f,{title:"是否确认删除？",onConfirm:I,children:H}),n[35]=I,n[36]=H,n[37]=K):K=n[37],n[38]!==E||n[39]!==K||n[40]!==q||n[41]!==L?(P=t.jsxs("div",{className:"flex flex-wrap",children:[q,L,E,K]}),n[38]=E,n[39]=K,n[40]=q,n[41]=L,n[42]=P):P=n[42],P}),M=o=>{const n=e.c(23),{editItem:c,refresh:u,type:j}=o,p=void 0===j?"add":j,[f]=I.useForm(),[k,b]=i.useState(!1),[_,g]=i.useState(c?.content);let w;n[0]===Symbol.for("react.memo_cache_sentinel")?(w=function(e){const t=d.getState().user.token;return new Promise(i=>{m({url:a.uploadImage,token:t,data:h({file:e})}).then(e=>{200===e.code&&e.data&&i(e.data.image_url)})})},n[0]=w):w=n[0];const C=w;let S;n[1]!==c?.id||n[2]!==_||n[3]!==u||n[4]!==p?(S=function(e){const t=d.getState().user.token;if(!_.trim())return void x.error("请输入公告内容");const i={title:e.title,content:_};b(!0),setTimeout(()=>{m({url:"add"===p?a.addNotice:a.editNotice,token:t,data:"add"===p?i:{id:c?.id,...i}}).then(e=>{200===e.code&&(u(),r.hide(l))}).finally(()=>{b(!1)})},500)},n[1]=c?.id,n[2]=_,n[3]=u,n[4]=p,n[5]=S):S=n[5];const O=S;let N,v,F,q,L,R,M;n[6]===Symbol.for("react.memo_cache_sentinel")?(N={flex:"82px"},n[6]=N):N=n[6],n[7]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx(I.Item,{name:"title",label:"公告标题",required:!0,rules:[{required:!0}],children:t.jsx(T,{placeholder:"公告标题"})}),F=t.jsx(I.Item,{label:"公告内容",required:!0}),n[7]=v,n[8]=F):(v=n[7],F=n[8]),n[9]===Symbol.for("react.memo_cache_sentinel")?(q={height:"calc(300px)"},L=e=>{g(e.text)},n[9]=q,n[10]=L):(q=n[9],L=n[10]),n[11]!==_?(R=t.jsx(y,{className:"flex-1 -mt-4 mb-6",style:q,onChange:L,value:_,renderHTML:z,onImageUpload:C}),n[11]=_,n[12]=R):R=n[12],n[13]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx(s,{onClick:A,children:"取消"}),n[13]=M):M=n[13];const U="add"===p?"新增公告":"保存编辑";let B,E;return n[14]!==k||n[15]!==U?(B=t.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[M,t.jsx(s,{type:"primary",htmlType:"submit",loading:k,children:U})]}),n[14]=k,n[15]=U,n[16]=B):B=n[16],n[17]!==c||n[18]!==f||n[19]!==O||n[20]!==B||n[21]!==R?(E=t.jsx(t.Fragment,{children:t.jsxs(I,{form:f,autoComplete:"off",variant:"filled",initialValues:c,labelCol:N,onFinish:O,children:[v,F,R,B]})}),n[17]=c,n[18]=f,n[19]=O,n[20]=B,n[21]=R,n[22]=E):E=n[22],E};function z(e){return t.jsx(w,{content:e,replace:!1})}function A(){r.hide(l)}export{F as default};
