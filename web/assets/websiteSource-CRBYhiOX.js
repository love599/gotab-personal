import{c as e,an as t,u as s,k as l,r as i,a9 as r,aA as n,aB as a,j as o,B as c,a0 as d,E as m,q as u,C as h,D as f,H as y,ap as p,aq as x,am as j,F as b,L as g,a7 as _}from"./main-BEv8KsEt.js";import{M as k,R as w}from"./myTable-WU5ZHxuI.js";import{C as S}from"./contentLayout-CIrKGV-A.js";import{R as C}from"./ReloadOutlined-C6BmRkYH.js";import"./transformData-De2ehBJX.js";import"./MoneyCollectOutlined-CqHTO0eZ.js";import"./MoneyCollectOutlined-4QlEwa2l.js";import"./index-CfG0xZO3.js";import"./AlipayOutlined-B_VSiSn2.js";import"./AlipayOutlined-tZM3mGx9.js";function v(){const u=e.c(27),{key:h,refresh:f}=t(),y=s(),p=l(q);let x;u[0]!==p||u[1]!==y?(x=function(){r({url:m.getCategoryListWithAll}).then(e=>{if(200===e.code&&e.data){const t=e.data.map(T);n(t,p)||y(a(t))}})},u[0]=p,u[1]=y,u[2]=x):x=u[2];const j=x;let b,g,_,w,v,N,O,W,z,E;u[3]!==p.length||u[4]!==j?(b=()=>{0===p.length&&j()},u[3]=p.length,u[4]=j,u[5]=b):b=u[5],u[6]===Symbol.for("react.memo_cache_sentinel")?(g=[],u[6]=g):g=u[6],i.useEffect(b,g),u[7]===Symbol.for("react.memo_cache_sentinel")?(_={title:"网站名称",key:"title",width:200,fixed:"left"},w={title:"网站描述",key:"description",width:450},v={title:"图标",key:"icon",width:140,render:L},N={title:"链接",key:"url",width:120,render:I},O={title:"所属分类",key:"categoryName",width:120},W={title:"提交人",key:"username",width:160},z={type:"time",title:"提交时间",key:"createdTime",width:200},u[7]=_,u[8]=w,u[9]=v,u[10]=N,u[11]=O,u[12]=W,u[13]=z):(_=u[7],w=u[8],v=u[9],N=u[10],O=u[11],W=u[12],z=u[13]),u[14]!==f?(E=[_,w,v,N,O,W,z,{title:"操作",fixed:"right",width:180,render:(e,t)=>o.jsx(A,{record:t,refresh:f})}],u[14]=f,u[15]=E):E=u[15];const M=E;let R,U,B,D,F,K;return u[16]===Symbol.for("react.memo_cache_sentinel")?(R=o.jsx(C,{}),u[16]=R):R=u[16],u[17]!==f?(U=o.jsx(c,{type:"primary",icon:R,onClick:()=>{f()},children:"刷新列表"}),u[17]=f,u[18]=U):U=u[18],u[19]===Symbol.for("react.memo_cache_sentinel")?(B=o.jsx(d,{className:"my-3"}),u[19]=B):B=u[19],u[20]===Symbol.for("react.memo_cache_sentinel")?(D={searchParams:{status:0}},u[20]=D):D=u[20],u[21]!==M||u[22]!==h?(F=o.jsx(k,{columns:M,getListUrl:m.getAwaitingApprovalWebsiteSourceList,dataKey:"data.list",tableKey:h,params:D}),u[21]=M,u[22]=h,u[23]=F):F=u[23],u[24]!==U||u[25]!==F?(K=o.jsxs(S,{children:[U,B,F]}),u[24]=U,u[25]=F,u[26]=K):K=u[26],K}function I(e){return o.jsx(c,{type:"link",size:"small",onClick:()=>{e&&window.open(e,"_blank")},children:e||"-"})}function L(e,t){return e?o.jsxs("div",{className:"p-1 rounded-sm flex items-center gap-2 w-[110px]",style:{backgroundColor:t.backgroundColor,color:t.fontColor},children:[o.jsx("img",{src:u(e),className:"rounded-sm",style:{width:"32px",height:"32px"},onError:N}),o.jsx("p",{className:"text-xs font-semibold p-ellipsis w-12",children:t.title})]}):"-"}function N(e){e.currentTarget.src="/icons/default_image.svg"}function T(e){return{label:e.label,key:e.id}}function q(e){return e.stateUtils.categoryList}const A=i.memo(t=>{const s=e.c(38),{record:r,refresh:n}=t;let a;s[0]===Symbol.for("react.memo_cache_sentinel")?(a=[],s[0]=a):a=s[0];const[d,u]=i.useState(a),b=l(W);let g;s[1]!==r||s[2]!==n||s[3]!==b?(g=function(e,t){h(t,u),setTimeout(()=>{f({url:"reject"===e?m.rejectWebsiteInfo:m.deleteWebsiteInfo,token:b,data:{id:r.id}}).then(e=>{200===e.code&&n()}).finally(()=>{y(t,u)})},500)},s[1]=r,s[2]=n,s[3]=b,s[4]=g):g=s[4];const _=g;let k,S,C,v;s[5]===Symbol.for("react.memo_cache_sentinel")?(k={width:"44px"},s[5]=k):k=s[5],s[6]!==r||s[7]!==n?(S=()=>{p.show(x,{title:"审核通过",children:o.jsx(O,{record:r,refresh:n})})},s[6]=r,s[7]=n,s[8]=S):S=s[8],s[9]!==d[0]||s[10]!==S?(C=o.jsx(c,{type:"link",size:"small",disabled:d[0],style:k,onClick:S,children:"通过"}),s[9]=d[0],s[10]=S,s[11]=C):C=s[11],s[12]!==_?(v=()=>{_("reject",1)},s[12]=_,s[13]=v):v=s[13];const I=d[1]||d[2];let L,N,T,q,A;s[14]===Symbol.for("react.memo_cache_sentinel")?(L={width:"44px"},s[14]=L):L=s[14],s[15]!==d[1]?(N=d[1]?o.jsx(w,{}):"驳回",s[15]=d[1],s[16]=N):N=s[16],s[17]!==I||s[18]!==N?(T=o.jsx(c,{danger:!0,type:"link",size:"small",disabled:I,style:L,children:N}),s[17]=I,s[18]=N,s[19]=T):T=s[19],s[20]!==v||s[21]!==T?(q=o.jsx(j,{title:"是否确认驳回申请？",onConfirm:v,children:T}),s[20]=v,s[21]=T,s[22]=q):q=s[22],s[23]!==_?(A=()=>{_("delete",2)},s[23]=_,s[24]=A):A=s[24];const z=d[1]||d[2];let E,M,R,U,B;return s[25]===Symbol.for("react.memo_cache_sentinel")?(E={width:"44px"},s[25]=E):E=s[25],s[26]!==d[2]?(M=d[2]?o.jsx(w,{}):"删除",s[26]=d[2],s[27]=M):M=s[27],s[28]!==z||s[29]!==M?(R=o.jsx(c,{danger:!0,type:"link",size:"small",disabled:z,style:E,children:M}),s[28]=z,s[29]=M,s[30]=R):R=s[30],s[31]!==A||s[32]!==R?(U=o.jsx(j,{title:"是否确认删除该申请？",onConfirm:A,children:R}),s[31]=A,s[32]=R,s[33]=U):U=s[33],s[34]!==q||s[35]!==U||s[36]!==C?(B=o.jsxs("div",{className:"flex flex-wrap",children:[C,q,U]}),s[34]=q,s[35]=U,s[36]=C,s[37]=B):B=s[37],B}),O=t=>{const s=e.c(23),{record:r,refresh:n}=t,a=l(z),d=l(E),[u,h]=i.useState(!1);let y,p;s[0]!==a?(p=a.filter(M).map(R),s[0]=a,s[1]=p):p=s[1],y=p;const x=y;let j;s[2]!==r.id||s[3]!==n||s[4]!==d?(j=function(e){h(!0),setTimeout(()=>{f({url:m.approveWebsiteInfo,token:d,data:{id:r.id,...e}}).then(e=>{200===e.code&&(n(),setTimeout(U,0))}).finally(()=>{h(!1)})},500)},s[2]=r.id,s[3]=n,s[4]=d,s[5]=j):j=s[5];const k=j,w=r.categoryId||void 0;let S,C,v,I,L,N,T,q,A;return s[6]!==w?(S={categoryId:w,hidden:!1},s[6]=w,s[7]=S):S=s[7],s[8]!==k?(C=e=>{k(e)},s[8]=k,s[9]=C):C=s[9],s[10]===Symbol.for("react.memo_cache_sentinel")?(v=[{required:!0,message:"请选择网站所属分类"}],s[10]=v):v=s[10],s[11]!==x?(I=o.jsx(b.Item,{label:"网站分类",name:"categoryId",required:!0,rules:v,children:o.jsx(g,{options:x,allowClear:!0,placeholder:"请选择网站所属分类"})}),s[11]=x,s[12]=I):I=s[12],s[13]===Symbol.for("react.memo_cache_sentinel")?(L=[{required:!0,message:"请选择是否隐藏在资源库"}],s[13]=L):L=s[13],s[14]===Symbol.for("react.memo_cache_sentinel")?(N=o.jsx(b.Item,{label:"是否隐藏",name:"hidden",required:!0,rules:L,children:o.jsx(_.Group,{options:[{label:"显示",value:!1},{label:"隐藏",value:!0}]})}),s[14]=N):N=s[14],s[15]===Symbol.for("react.memo_cache_sentinel")?(T=o.jsx(c,{onClick:B,children:"取消"}),s[15]=T):T=s[15],s[16]!==u?(q=o.jsxs("div",{className:"flex justify-end flex-wrap gap-3 -mt-3",children:[T,o.jsx(c,{htmlType:"submit",type:"primary",loading:u,children:"确认"})]}),s[16]=u,s[17]=q):q=s[17],s[18]!==q||s[19]!==S||s[20]!==C||s[21]!==I?(A=o.jsxs(b,{initialValues:S,onFinish:C,children:[I,N,q]}),s[18]=q,s[19]=S,s[20]=C,s[21]=I,s[22]=A):A=s[22],A};function W(e){return e.user.token}function z(e){return e.stateUtils.categoryList}function E(e){return e.user.token}function M(e){return e.key>0}function R(e){return{label:e.label,value:e.key}}function U(){p.hide(x)}function B(){p.hide(x)}export{v as default};
